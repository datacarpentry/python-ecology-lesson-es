<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<title>Análisis y visualización de datos usando Python: All in One View</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" href="assets/styles.css">
<script src="assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="manifest" href="site.webmanifest">
<link rel="mask-icon" href="safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">
</head>
<body>
    <header id="top" class="navbar navbar-expand-md navbar-light bg-white top-nav data"><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-6">
      <div class="large-logo">
        <img alt="Data Carpentry" src="assets/images/data-logo.svg">
</div>
    </div>
    <div class="selector-container">
      
      
      <div class="dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Learner View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
<li><button class="dropdown-item" type="button" onclick="window.location.href='instructor/aio.html';">Instructor View</button></li>
        </ul>
</div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl navbar-light bg-white bottom-nav data" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Data Carpentry" src="assets/images/data-logo-sm.svg">
</div>
    <div class="lesson-title-md">
      Análisis y visualización de datos usando Python
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
      <i role="img" aria-label="search button" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
<li class="nav-item">
          <span class="lesson-title">
            Análisis y visualización de datos usando Python
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="reference.html#glossary">Glossary</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="profiles.html">Learner Profiles</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
<li><a class="dropdown-item" href="discuss.html">Discussion</a></li>
<li><a class="dropdown-item" href="reference.html"></a></li>
          </ul>
</li>
      </ul>
</div>
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
<input class="form-control me-2 searchbox" type="search" placeholder="Search" aria-label="Search"><button class="btn btn-outline-success tablet-search-button" type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="search button"></i>
        </button>
      </fieldset>
</form>
  </div>
<!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Análisis y visualización de datos usando Python
</div>

<aside class="col-md-12 lesson-progress"><div style="width: %" class="percentage">
    %
  </div>
  <div class="progress data">
    <div class="progress-bar data" role="progressbar" style="width: %" aria-valuenow="" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Learner View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="instructor/aio.html">Instructor View</a>
                      </div>
                    </div>
                  </div>
<!--/div.accordion-item-->
                </div>
<!--/div.accordion-flush-->
              </div>
<!--div.sidenav-view-selector -->
            </div>
<!--/div.col -->
      
            <hr>
</div>
<!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Setup</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="00-before-we-start.html">1. Antes de comenzar</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="01-short-introduction-to-Python.html">2. Breve introducción a la Programación en Python</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="02-starting-with-data.html">3. Comenzando con datos</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="03-index-slice-subset.html">4. Indexación, segmentación y creación de subconjuntos a partir de DataFrames en Python</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="04-data-types-and-format.html">5. Tipos de datos y formatos</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="05-merging-data.html">6. Combinando DataFrames con Pandas</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush8">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading8">
        <a href="06-loops-and-functions.html">7. Flujos de trabajo y automatización</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush9">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading9">
        <a href="07-visualization-ggplot-python.html">8. Creando gráficos con plotnine</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush10">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading10">
        <a href="08-putting-it-all-together.html">9. Entrada de datos y visualización - Matplotlib y Pandas</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush11">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading11">
        <a href="09-working-with-sql.html">10. Acceso a base de datos SQLite usando Python y Pandas</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width">
<div class="accordion accordion-flush resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul>
<li>
                        <a href="key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="reference.html#glossary">Glossary</a>
                      </li>
                      <li>
                        <a href="profiles.html">Learner Profiles</a>
                      </li>
                      <li><a href="discuss.html">Discussion</a></li>
<li><a href="reference.html"></a></li>
                    </ul>
</div>
                </div>
              </div>
            </div>
            <hr class="half-width resources">
<a href="aio.html">See all in one page</a>
            

            <hr class="d-none d-sm-block d-md-none">
<div class="d-grid gap-1">
            
            </div>
          </div>
<!-- /div.accordion -->
        </div>
<!-- /div.sidebar-inner -->
      </nav>
</div>
<!-- /div.sidebar -->
  </div>
<!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-extra.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <main id="main-content" class="main-content"><div class="container lesson-content">
        
        
<section id="aio-00-before-we-start"><p>Content from <a href="00-before-we-start.html">Antes de comenzar</a></p>
<hr>
<p> Last updated on 2023-02-07 | 
        
        <a href="https://github.com/datacarpentry/python-ecology-lesson-es/edit/main/episodes/00-before-we-start.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<section id="qué-es-python"><h2 class="section-heading">¿Qué es Python?<a class="anchor" aria-label="anchor" href="#qu%C3%A9-es-python"></a>
</h2>
<hr class="half-width">
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>¿Qué es Python y por qué debería aprenderlo?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Describir el propósito del editor, consola, ayuda, el panel
explorador de variables y el panel explorador de archivos de
Spyder.</li>
<li>Organizar los archivos y directorios para un conjunto de análisis
como proyecto de Python, y entender el propósito del directorio de
trabajo.</li>
<li>Saber donde buscar ayuda.</li>
<li>Demostrar como proporcionar suficiente información para solucionar
problemas junto con la comunidad de usuarios de Python.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>Python es un lenguaje de programación de tipo general que soporta un
desarrollo rápido de aplicaciones de análisis de datos. La palabra
“Python” es usada para referirse tanto al lenguaje de programación, como
a la herramienta que ejecuta los <strong>scripts</strong> escritos en el
lenguaje “Python”.</p>
<p>Sus principales ventajas son:</p>
<ul>
<li>Es gratis</li>
<li>De código abierto</li>
<li>Disponible para todas las plataformas más importantes (macOS, Linux,
Windows)</li>
<li>Es mantenido por la Python Software Foundation</li>
<li>Soporta múltiples paradigmas de programación</li>
<li>Tiene una gran comunidad</li>
<li>Tiene un rico ecosistema de paquetes de terceros</li>
</ul>
<p><em>Entonces, ¿por qué necesitas Python para el análisis de
datos?</em></p>
<div class="section level3">
<h3 id="fácil-de-aprender">Fácil de aprender<a class="anchor" aria-label="anchor" href="#f%C3%A1cil-de-aprender"></a>
</h3>
<p>Python es más fácil de aprender que otros lenguajes de programación.
Esto es importante debido a que al tener barreras de aprendizaje más
bajas es más fácil para los nuevos miembros de la comunidad ponerse al
día.</p>
</div>
<div class="section level3">
<h3 id="reproducibilidad">Reproducibilidad<a class="anchor" aria-label="anchor" href="#reproducibilidad"></a>
</h3>
<p>La reproducibilidad es la habilidad de obtener los mismos resultados
usando los mismos datos y análisis.</p>
<p>Un análisis de datos escrito en un <strong>script</strong> de Python
puede ser reproducido en cualquier plataforma. Es más, si recolectas más
datos o corriges datos existentes, ¡puedes volver a ejecutar los
análisis de manera rápida y sencilla!</p>
<p>Cada vez más revistas científicas y agencias de financiación esperan
que los análisis sean reproducibles, por lo tanto, saber Python te dará
una ventaja sobre estos requisitos.</p>
</div>
<div class="section level3">
<h3 id="versatilidad">Versatilidad<a class="anchor" aria-label="anchor" href="#versatilidad"></a>
</h3>
<p>Python es un lenguaje versátil que se integra con varias aplicaciones
existentes para permitir hacer cosas sorprendentes. Por ejemplo, uno
puede usar Python para generar manuscritos, de tal forma que si
necesitas actualizar tus datos, procedimientos de análisis, o cambiar
algo más, puedes volver a generar todas las figuras rápidamente y tu
manuscrito se actualizará automáticamente.</p>
<p>Python puede leer archivos de texto, conectarse a bases de datos, y a
muchos otros formatos de datos, ya sea en tu computadora o en la
web.</p>
</div>
<div class="section level3">
<h3 id="interdisciplinario-y-extensible">Interdisciplinario y extensible<a class="anchor" aria-label="anchor" href="#interdisciplinario-y-extensible"></a>
</h3>
<p>Python provee un marco de trabajo que permite que cualquier persona
combine enfoques de diferentes disciplinas de investigación (y no solo
de investigación) para ajustarse mejor a tus necesidades de
análisis.</p>
</div>
<div class="section level3">
<h3 id="python-tiene-una-comunidad-grande-y-amable">Python tiene una comunidad grande y amable<a class="anchor" aria-label="anchor" href="#python-tiene-una-comunidad-grande-y-amable"></a>
</h3>
<p>Miles de personas usan Python diariamente. Muchos de ellos están
dispuestos a ayudarte a través de listas de correo y sitios web, tales
como <a href="https://stackoverflow.com" class="external-link">Stack Overflow</a> y el portal
de la <a href="https://www.anaconda.com/community/" class="external-link">comunidad de
Anaconda</a>.</p>
</div>
<div class="section level3">
<h3 id="gratis-y-de-código-abierto-foss-por-sus-siglas-en-inglés-y-multi-plataforma">Gratis y de código abierto (FOSS por sus siglas en inglés)… y
multi-plataforma<a class="anchor" aria-label="anchor" href="#gratis-y-de-c%C3%B3digo-abierto-foss-por-sus-siglas-en-ingl%C3%A9s-y-multi-plataforma"></a>
</h3>
<p>Sabemos que ya hemos nombrado esto, de todas formas, vale la pena
repetirlo.</p>
</div>
</section><section id="conociendo-a-anaconda"><h2 class="section-heading">Conociendo a Anaconda<a class="anchor" aria-label="anchor" href="#conociendo-a-anaconda"></a>
</h2>
<hr class="half-width">
<p>La distribución de Python <a href="https://www.anaconda.com" class="external-link">Anaconda</a> incluye montones de
paquetes populares como la consola Ipython, Jupyter Notebook, y Spyder
IDE. Échale un vistazo al Navegador Anaconda. Puedes ejecutar programas
desde el Navegador o usar la línea de comando.</p>
<p><a href="https://jupyter.org" class="external-link">Jupyter Notebook</a> es una aplicación
web de código abierto que permite crear y compartir documentos que
permiten crear de manera sencilla documentos que combinan código,
gráficos y texto narrativo.</p>
<p><a href="https://www.spyder-ide.org/" class="external-link">Spyder</a> es un
<strong>Entorno de Desarrollo Integrado</strong> (IDE por sus siglas en
inglés) que permiten escribir <strong>scripts</strong> de Python e
interactuar con el software de Python desde una interfaz única.</p>
<p>Anaconda también viene con un gestor de paquetes llamado <a href="https://conda.io/docs/" class="external-link">conda</a>, el cual hace que sea fácil
instalar y actualizar paquetes adicionales.</p>
</section><section id="proyecto-de-investigación-buenas-prácticas"><h2 class="section-heading">Proyecto de Investigación: Buenas Prácticas<a class="anchor" aria-label="anchor" href="#proyecto-de-investigaci%C3%B3n-buenas-pr%C3%A1cticas"></a>
</h2>
<hr class="half-width">
<p>Es una buena idea guardar los grupos de datos relacionados, análisis,
y texto en una única carpeta. Por lo tanto, todos los
<strong>scripts</strong> y archivos de texto dentro de esta carpeta
pueden usar <strong>paths</strong> relativos hacia los archivos de
datos. Trabajar de esta manera hace que sea mucho más fácil mover tu
proyecto y compartirlo con otras personas.</p>
<div class="section level3">
<h3 id="organizando-tu-directorio-de-trabajo">Organizando tu directorio de trabajo<a class="anchor" aria-label="anchor" href="#organizando-tu-directorio-de-trabajo"></a>
</h3>
<p>Usar una estructura de carpetas de forma consistente a través de tus
proyectos te ayudará a mantener las cosas organizadas, y hará que sea
fácil encontrar/archivar cosas en el futuro. Esto puede ser
especialmente útil cuando tienes múltiples proyectos. En general,
podrías llegar a querer crear directorios separados para tus
<strong>scripts</strong>, datos, y documentos.</p>
<ul>
<li><p><strong><code>data/</code></strong>: Usa esta carpeta para
guardar tus datos crudos. Por el bien de la transparencia y procedencia,
siempre deberías guardar una copia de tus <strong>datos crudos</strong>.
Si necesitas limpiar tus datos, hazlo de manera programática
(<em>i.e.</em>, con <strong>scripts</strong>) y asegúrate de separar los
datos limpios de los crudos. Por ejemplo, puedes guardar los datos
crudos en <code>./data/raw/</code> y los limpios en
<code>./data/clean/</code>.</p></li>
<li><p><strong><code>documents/</code></strong>: Usa esta carpeta para
guardar esquemas, borradores, y otro texto.</p></li>
<li><p><strong><code>scripts/</code></strong>: Usa esta carpeta para
guardar tus <strong>scripts</strong> (de Python) para limpieza de datos,
análisis y generación de gráficos que uses en este proyecto en
particular.</p></li>
</ul>
<p>Puede que tengas que crear directorios adicionales dependiendo de las
necesidades de tu proyecto, pero los que nombramos deberían ser el eje
del directorio. Para este workshop, vamos a necesitar una carpeta
<code>data/</code> para almacenar nuestros datos crudos, y luego vamos a
tener que crear la carpeta <code>data_output/</code> cuando aprendamos
como exportar datos como archivos CSV.</p>
</div>
</section><section id="qué-es-programación-y-codificación"><h2 class="section-heading">¿Qué es Programación y Codificación?<a class="anchor" aria-label="anchor" href="#qu%C3%A9-es-programaci%C3%B3n-y-codificaci%C3%B3n"></a>
</h2>
<hr class="half-width">
<p>Programación es el proceso de escribir <em>“programas”</em> que una
computadora pueda ejecutar produciendo algún resultado (útil). La
programación es un proceso de múltiples pasos que implican:</p>
<ol style="list-style-type: decimal">
<li>Identificar los aspectos de un problema de la vida real que pueda
ser resuelto computacionalmente.</li>
<li>Identificar la (mejor) solución computacional.</li>
<li>Implementar la solución en un lenguaje de programación
específico.</li>
<li>Testear, validar, y ajustar la solución implementada.</li>
</ol>
<p>Mientras que <em>“Programar”</em> se refiere a todos los pasos
nombrados, <em>“Codificación”</em> se refiere solo al paso 3:
<em>“Implementar la solución en un lenguaje de programación
específico”</em>.</p>
<div class="section level4">
<h4 id="si-trabajas-con-jupyter-notebook">Si trabajas con Jupyter notebook:<a class="anchor" aria-label="anchor" href="#si-trabajas-con-jupyter-notebook"></a>
</h4>
<p>Puedes tipear código de Python en una celda de código y luego
ejecutarla presionando <kbd>Shift</kbd>+<kbd>Enter</kbd>.</p>
<p>El output se imprimirá directamente bajo la celda de input. Se puede
reconocer a una celda de código mediante el <code>In[ ]:</code> al
principio de la celda y a una celda de output por el
<code>Out[ ]:</code>.</p>
<p>Presionar el botón <strong>+</strong> en la barra de menú agregará
una nueva celda.</p>
<p>Todos tus comandos tal como los outputs serán guardados con el
notebook.</p>
</div>
<div class="section level4">
<h4 id="si-trabajas-con-spyder">Si trabajas con Spyder:<a class="anchor" aria-label="anchor" href="#si-trabajas-con-spyder"></a>
</h4>
<p>Puedes usar tanto la consola o un archivo de <strong>script</strong>
(archivos de texto plano que contienen tu código). El panel de consola
(el panel abajo a la derecha, en Spyder) es el lugar donde los comandos
escritos en el lenguaje de programación Python pueden ser tipeados y
ejecutados inmediatamente por la computadora. También es donde se
mostrarán los resultados. Puedes ejecutar los comandos directamente en
la consola presionando <kbd>Enter</kbd>, pero serán “perdidos” cuando
cierres la sesión. Spyder usa la consola <a href="https://ipython.org" class="external-link">IPython</a> por defecto.</p>
<p>Debido a que queremos que nuestro código y flujo de trabajo sea
reproducible, es mejor tipear los comandos en el editor de
<strong>scripts</strong>, y guardarlos como un <strong>script</strong>.
De esta manera, hay un registro completo de lo que hicimos, y cualquiera
(¡incluyendo nuestros yo futuros!) pueden reproducir los resultados en
su computadora de forma sencilla.</p>
<p>Spyder permite ejecutar comandos directamente desde el editor de
<strong>scripts</strong> usando los botones de ejecución en la parte
superior.</p>
<p>Para ejectuar el <strong>script</strong> entero haz clic en <em>Run
file</em> o presiona <kbd>F5</kbd>. Para ejecutar la línea actual haz
clic en <em>Run selection or current line</em> o presiona <kbd>F9</kbd>,
otros botones de ejecución permiten ejecutar celdas de
<strong>scripts</strong> o activar el modo <strong>debug</strong>.
Cuando se usa <kbd>F9</kbd>, el comando en la línea actual del
<strong>script</strong> (indicada por el cursor) o todos los comandos en
el actual texto seleccionado serán enviados a la consola y
ejecutados.</p>
<p>En algún punto en tu análisis podrías llegar a desear comprobar el
contenido de una variable o la estructura de un objeto, sin
necesariamente guardar un registro en tu <strong>script</strong>. Puedes
tipear estos comandos y ejecutarlos directamente en la consola. Spyder
provee los atajos <kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>E</kbd> y
<kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>I</kbd> que te permitirán “saltar”
entre el panel de <strong>scripts</strong> y el de la consola.</p>
<p>Si Python está listo para aceptar comandos, la consola IPython
muestra un aviso <code>In [..]:</code> con el número de línea actual en
la consola entre corchetes <code>[]</code>. Si recibe un comando
(mediante tipeo, copiando y pegando o enviado desde el editor de
scripts) Python lo va a ejecutar, mostrar los resultados en la celda
<code>Out [..]:</code>, y luego volver con un nuevo aviso
<code>In [..]:</code> a la espera de nuevos comandos.</p>
<p>Si Python todavía está esperando a que ingreses mas datos debido a
que todavía no has terminado, la consola mostrará un aviso
<code>...:</code>. Significa que no has terminado de ingresar un comando
completo.</p>
<p>Esto es debido a que no has tipeado un paréntesis de cierre
(<code>)</code>, <code>]</code>, o <code>}</code>) o comillas. Cuando
sucede esto, y pensaste que habías terminado de tipear tu comando, haz
clic dentro de la ventana de la consola y presiona <kbd>Esc</kbd>; esto
cancelará el comando incompleto y te retornará al aviso
<code>In [..]:</code>.</p>
</div>
</section><section id="cómo-aprender-más-luego-del-taller"><h2 class="section-heading">¿Cómo aprender más luego del taller?<a class="anchor" aria-label="anchor" href="#c%C3%B3mo-aprender-m%C3%A1s-luego-del-taller"></a>
</h2>
<hr class="half-width">
<p>El material que cubrimos durante este taller te dará una prueba
inicial de cómo puede usarse Python para analizar datos de tu propia
investigación. Sin embargo, todavía necesitarás aprender más sobre
operaciones más avanzadas tal como la limpieza de tu
<strong>dataset</strong>, usar métodos estadísticos, o crear gráficos
bonitos. La mejor manera de hacerse competente y eficiente en Python,
así como con cualquier otra herramienta, es empleándola para abordar tus
propias preguntas de investigación. Como principiante, puede sentirse
desalentador tener que escribir un <strong>script</strong> desde el
inicio, y dado que muchas personas comparten su código en la web,
modificar código existente para adaptarlo a tus propósitos puede hacer
que comenzar sea más fácil.</p>
</section><section id="buscando-ayuda"><h2 class="section-heading">Buscando ayuda<a class="anchor" aria-label="anchor" href="#buscando-ayuda"></a>
</h2>
<hr class="half-width">
<ul>
<li>revisa el menú <em>Ayuda</em>
</li>
<li>tipea <code>help()</code>
</li>
<li>tipea <code>?object</code> o <code>help(object)</code> para obtener
información sobre un objeto</li>
<li><a href="https://www.python.org/doc/" class="external-link">Documentación de
Python</a></li>
</ul>
<p>Finalmente, una búsqueda genérica en Google o internet de “Python
tarea_a_buscar” usualmente te enviará a la documentación del módulo
apropiado o a un foro dónde alguien más ya ha hecho la misma
pregunta.</p>
<p>Estoy atorada… tengo un mensaje de error que no entiendo. Empieza por
googlear el mensaje de error. Sin embargo, esto no siempre funciona muy
bien debido a que a veces, los desarrolladores emplean los mensajes de
error provistos por Python. Por ello terminas con mensajes de error
genéricos que podrían no llegar a ser de ayuda para diagnosticar un
problema (Ej.: “subscript out of bounds”). Si el mensaje es muy
genérico, quizás deberías incluir en tu consulta el nombre de la función
o paquete que estés usando.</p>
<p>Sin embargo, deberías chequear Stack Overflow. Buscar usando la
etiqueta [python]. La mayoría de las preguntas ya han sido respondidas,
el desafío es usar la combinación de palabras apropiadas en la búsqueda
para encontrar las respuestas: <a href="https://stackoverflow.com/questions/tagged/python" class="external-link">http://stackoverflow.com/questions/tagged/python</a>.</p>
<div class="section level3">
<h3 id="pidiendo-ayuda">Pidiendo ayuda<a class="anchor" aria-label="anchor" href="#pidiendo-ayuda"></a>
</h3>
<p>La clave para recibir ayuda de alguien es que ellos entiendan
rápidamente tu problema. Deberías hacer que sea lo más fácil posible
identificar dónde podría estar el inconveniente.</p>
<p>Trata de usar las palabras correctas para describir el problema. Por
ejemplo, un paquete no es lo mismo que una biblioteca. La mayoría de las
personas entenderán lo que quieres decir, pero otras tienen fuertes
sentimientos sobre la diferencia en el significado. El punto clave es
que puede hacer que las cosas sean confusas para las personas que tratan
de ayudarte. Trata de ser tan precisa como sea posible cuando describes
tu problema.</p>
<p>Si es posible, trata de resumir lo que no funciona en un ejemplo
simple y reproducible. Si puedes reproducir el problema usando una
pequeña cantidad de datos en lugar de tus 50.000 filas y 10.000
columnas, proporciona el <strong>dataset</strong> pequeño con la
descripción de tu problema. Cuando sea apropiado, trata de generalizar
lo que estas haciendo, así incluso las personas que no están
familiarizadas con tu campo de estudio podrán entender tu pregunta. Por
ejemplo, en lugar de usar un subconjunto de tu <strong>datase</strong>
real, crea uno pequeño (3 columnas, 5 filas) y genérico.</p>
</div>
<div class="section level3">
<h3 id="dónde-pedir-ayuda">¿Dónde pedir ayuda?<a class="anchor" aria-label="anchor" href="#d%C3%B3nde-pedir-ayuda"></a>
</h3>
<ul>
<li>A la persona sentada junto a tu durante el taller. No dudes en
hablar con tu vecina durante el taller, compara tus respuestas, pide
ayuda. También podrías estar interesada en organizar reuniones
regularmente luego del taller para seguir aprendiendo una de otra.</li>
<li>Tus amigables colegas: si conoces a alguien con mas experiencia que
tu, ellas podrían estar capacitadas y dispuestas a ayudarte.</li>
<li>
<a href="https://stackoverflow.com/questions/tagged/python" class="external-link">Stack
Overflow</a>: si tu pregunta no ha sido contestada con anterioridad y
además está bien planteada, hay chances de que obtengas una respuesta en
5 minutos. Recuerda seguir los lineamientos de cómo preguntar
correctamente.</li>
<li><a href="https://www.python.org/community/lists/" class="external-link">Listas de correo
de Python</a></li>
</ul>
</div>
</section><section id="más-recursos"><h2 class="section-heading">Más recursos<a class="anchor" aria-label="anchor" href="#m%C3%A1s-recursos"></a>
</h2>
<hr class="half-width">
<p><a href="https://pypi.python.org/pypi" class="external-link">PyPI - the Python Package
Index</a></p>
<p><a href="https://docs.python-guide.org/en/latest/" class="external-link">The Hitchhiker’s
Guide to Python</a></p>
<p><a href="https://getpython3.com/diveintopython3/" class="external-link">Dive into Python
3</a></p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Keypoints<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Python es un lenguaje de programación de código libre y plataforma
independiente.</li>
<li>SciPy es un ecosistema para Python que provee las herramientas
necesarias para la computación científica.</li>
<li>Jupyter Notebook y la Spyder IDE son excelentes herramientas para
escribir código e interactuar con Python. Con su gran comunidad es fácil
encontrar ayuda en internet.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-01-short-introduction-to-Python"><p>Content from <a href="01-short-introduction-to-Python.html">Breve introducción a la Programación en Python</a></p>
<hr>
<p> Last updated on 2023-02-07 | 
        
        <a href="https://github.com/datacarpentry/python-ecology-lesson-es/edit/main/episodes/01-short-introduction-to-Python.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<section id="intérprete"><h2 class="section-heading">Intérprete<a class="anchor" aria-label="anchor" href="#int%C3%A9rprete"></a>
</h2>
<hr class="half-width">
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>¿Qué es Python?</li>
<li>¿Porqué deberías aprender Python?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Describir las ventajas de usar programación vs. completar tareas
repetitivas a mano.</li>
<li>Definir los tipos de datos en Python: <strong>cadenas</strong>,
<strong>enteros</strong>, y números de <strong>punto
flotante</strong>.</li>
<li>Realizar operaciones matemáticas en Python utilizando operadores
básicos.</li>
<li>Dentro del contexto de Python definir: <strong>listas</strong>,
<strong>tuplas</strong>, y <strong>diccionarios</strong>.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>Python es un lenguaje interpretado que puede ser usado de dos
formas:</p>
<ul>
<li>Modo “Interactivo”: cuando lo usas como una “calculadora avanzada”
ejecutando un comando a la vez. Para iniciar Python en este modo,
simplemente ejecuta <code>python</code> en la línea de comandos:</li>
</ul>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> python</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Python 3.5.1 (default, Oct 23 2015, 18:05:06)
[GCC 4.8.3] on linux2
Type "help", "copyright", "credits" or "license" for more information.
&gt;&gt;&gt;</code></pre>
</div>
<p>Los res símbolos de mayor que <code>&gt;&gt;&gt;</code> forman un
indicador interactivo en Python, que significa que está esperando tu
entrada de datos.</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="op">+</span> <span class="dv">2</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="fl">4</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Hello World"</span>)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Hello World</code></pre>
</div>
<ul>
<li>Modo “Script”: cuando ejecutas una serie de “comandos” guardados en
un archivo de texto, generalmente con una extensión <code>.py</code>
después del nombre de tu archivo:</li>
</ul>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> python my_script.py</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Hello World</code></pre>
</div>
</section><section id="introducción-a-los-tipos-de-datos-incorporados-en-python"><h2 class="section-heading">Introducción a los tipos de datos incorporados en Python<a class="anchor" aria-label="anchor" href="#introducci%C3%B3n-a-los-tipos-de-datos-incorporados-en-python"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="strings-integers-and-floats">Strings, integers, and floats<a class="anchor" aria-label="anchor" href="#strings-integers-and-floats"></a>
</h3>
<p>Una de las cosas más básicas que podemos hacer en Python es asignar
valores a las variables:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>text <span class="op">=</span> <span class="st">"Data Carpentry"</span>  <span class="co"># Un ejemplo de string</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>number <span class="op">=</span> <span class="dv">42</span>  <span class="co"># Un ejemplo de integer</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>pi_value <span class="op">=</span> <span class="fl">3.1415</span>  <span class="co"># Un ejemplo de float</span></span></code></pre>
</div>
<p>Aquí hemos asignado datos a las variables
<code>text</code>,<code>number</code> y <code>pi_value</code>,
utilizando el operador de asignación <code>=</code>. Para revisar el
valor de una variable, nosotros podemos escribir el nombre de la
variable en el intérprete y presionar <kbd>Return</kbd>:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>text</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="st">"Data Carpentry"</span></span></code></pre>
</div>
<p>Todo en Python tiene un tipo. Para obtener el tipo de algo, podemos
pasarlo a la función <code>type</code>:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="bu">type</span>(text)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>&lt;class 'str'&gt;</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="bu">type</span>(number)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>&lt;class 'int'&gt;</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="bu">type</span>(<span class="fl">6.02</span>)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>&lt;class 'float'&gt;</code></pre>
</div>
<p>La variable <code>text</code> es de tipo ‘str’, abreviatura de
<strong>string</strong> o cadena de caracteres. Las cadenas almacenan
secuencias de caracteres, que pueden ser letras, números, puntuación o
formas más exóticas de texto (¡incluso emoji!).</p>
<p>También podemos ver el valor de algo usando otra función incorporada,
<code>print</code>:</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(text)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Data Carpentry</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="dv">11</span>)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="fl">11</span></span></code></pre>
</div>
<p>Esto puede parecer redundante, pero de hecho es la única forma de
mostrar resultados en un script:</p>
<p><em>example.py</em></p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># En un archivo script de Python</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="co"># los comentarios en Python inician con #</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Las siguientes líneas asignan la cadena "Data Carpentry" a la variable "text".</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>text <span class="op">=</span> <span class="st">"Data Carpentry"</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="co"># ¡La siguiente línea no hace nada!</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>text</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="co"># La siguiente línea usa la función print para imprimir el valor asignado a "text"</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(text)</span></code></pre>
</div>
<p><em>Ejecutando el script</em></p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> python example.py</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Data Carpentry</code></pre>
</div>
<p>Nota que “Data Carpentry” se imprime una vez.</p>
<p><strong>Sugerencia</strong>: <code>print</code> y <code>type</code>
son funciones incorporadas en Python. Más adelante en esta lección,
veremos métodos y funciones definidas por el usuario. La documentación
de Python es excelente para darte una referencia sobre las diferencias
entre ellos.</p>
</div>
<div class="section level3">
<h3 id="operadores">Operadores<a class="anchor" aria-label="anchor" href="#operadores"></a>
</h3>
<p>Podemos realizar cálculos matemáticos en Python usando los operadores
básicos <code>+, -, /, *, %</code>:</p>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="op">+</span> <span class="dv">2</span>  <span class="co"># Suma</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="fl">4</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span> <span class="op">*</span> <span class="dv">7</span>  <span class="co"># Multiplicación</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="fl">42</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="op">**</span> <span class="dv">16</span>  <span class="co"># Potencia</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="fl">65536</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb31">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="dv">13</span> <span class="op">%</span> <span class="dv">5</span>  <span class="co"># Módulo</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="fl">3</span></span></code></pre>
</div>
<p>También podemos utilizar operadores de comparación y lógicos:
<code>&lt;,&gt;, ==,! =, &lt;=,&gt; =</code> y declaraciones de
identidad como <code>and, or, not</code>. El tipo de datos devuelto por
estos operadres es llamado <strong><em>boolean</em></strong> y retorna
verdadero o falso, como ves a continuación.</p>
<div class="codewrapper sourceCode" id="cb33">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> <span class="op">&gt;</span> <span class="dv">4</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">False</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb35">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="va">True</span> <span class="kw">and</span> <span class="va">True</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">True</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb37">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="va">True</span> <span class="kw">or</span> <span class="va">False</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">True</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb39">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="va">True</span> <span class="kw">and</span> <span class="va">False</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">False</span></span></code></pre>
</div>
</div>
</section><section id="secuencias-listas-y-tuplas"><h2 class="section-heading">Secuencias: Listas y Tuplas<a class="anchor" aria-label="anchor" href="#secuencias-listas-y-tuplas"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="listas">Listas<a class="anchor" aria-label="anchor" href="#listas"></a>
</h3>
<p><strong>list</strong> (o listas) son una estructura de datos común
para almacenar una secuencia ordenada de elementos. Se puede acceder a
cada elemento mediante un índice. Ten en cuenta que en Python, los
índices comienzan con 0 en lugar de 1:</p>
<div class="codewrapper sourceCode" id="cb41">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>numbers <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>]</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>numbers[<span class="dv">0</span>]</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="fl">1</span></span></code></pre>
</div>
<p>Se puede usar un bucle <code>for</code> para acceder a los elementos
de una lista u otras estructuras de datos de Python, uno a la vez:</p>
<div class="codewrapper sourceCode" id="cb43">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="cf">for</span> num <span class="kw">in</span> numbers:</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>...     <span class="bu">print</span>(num)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>...</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="fl">1</span></span>
<span><span class="fl">2</span></span>
<span><span class="fl">3</span></span></code></pre>
</div>
<p>Usar <strong>sangría</strong> es muy importante en Python. Ten en
cuenta que la segunda línea en el ejemplo de arriba está sangrada (o
indentada). Al igual que los tres <code>&gt;&gt;&gt;</code> son un
indicador interactivo en Python, los tres puntos <code>...</code> son
indicadores de líneas multiples en Python. Esta es la manera en que
Python marca un bloque de código. [Nota: no tienes que escribir
<code>&gt;&gt;&gt;</code> o <code>...</code>.]</p>
<p>Para agregar elementos al final de una lista, podemos usar el método
<code>append</code>. Los métodos son una forma de interactuar con un
objeto (una lista, por ejemplo). Podemos invocar un método usando el
punto <code>.</code> seguido del nombre del método y una lista de
argumentos entre paréntesis. Veamos un ejemplo usando
<code>append</code>:</p>
<div class="codewrapper sourceCode" id="cb45">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>numbers.append(<span class="dv">4</span>)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(numbers)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1, 2, 3, 4]</code></pre>
</div>
<p>Para averiguar qué métodos están disponibles para un objeto, podemos
usar el comando incorporado <code>help</code>:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>help(numbers)

Help on list object:

class list(object)
 |  list() -&gt; new empty list
 |  list(iterable) -&gt; new list initialized from iterable's items
 ...</code></pre>
</div>
</div>
<div class="section level3">
<h3 id="tuplas">Tuplas<a class="anchor" aria-label="anchor" href="#tuplas"></a>
</h3>
<p>Una tupla <strong>tuple</strong> es similar a una lista en que es una
secuencia ordenada de elementos. Sin embargo, las tuplas no se pueden
cambiar una vez creadas (son “inmutables”). Las tuplas se crean
colocando valores separados por comas dentro de los paréntesis
<code>()</code>.</p>
<div class="codewrapper sourceCode" id="cb48">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Las tuplas usan paréntesis</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>a_tuple <span class="op">=</span> (<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>another_tuple <span class="op">=</span> (<span class="st">'blue'</span>, <span class="st">'green'</span>, <span class="st">'red'</span>)</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Nota: las listas usan corchetes cuadrados</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>a_list <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>]</span></code></pre>
</div>
<div id="tuplas-vs.-listas" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="tuplas-vs.-listas" class="callout-inner">
<h3 class="callout-title">Tuplas <em>vs.</em> Listas<a class="anchor" aria-label="anchor" href="#tuplas-vs.-listas"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>¿Qué sucede cuando ejecutas <code>a_list[1] = 5</code> ?</li>
<li>¿Qué sucede cuando ejecutas <code>a_tuple[2] = 5</code>?</li>
<li>¿Qué te dice <code>type(a_tuple)</code> sobre
<code>a_tuple</code>?</li>
</ol>
</div>
</div>
</div>
</div>
</section><section id="diccionarios"><h2 class="section-heading">Diccionarios<a class="anchor" aria-label="anchor" href="#diccionarios"></a>
</h2>
<hr class="half-width">
<p>Un diccionario <strong>dictionary</strong> es un contenedor que
almacena pares de objetos - claves y valores.</p>
<div class="codewrapper sourceCode" id="cb49">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>translation <span class="op">=</span> {<span class="st">'one'</span>: <span class="dv">1</span>, <span class="st">'two'</span>: <span class="dv">2</span>}</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>translation[<span class="st">'one'</span>]</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="fl">1</span></span></code></pre>
</div>
<p>Los diccionarios funcionan como listas, excepto que se crea el índice
utilizando <em>claves</em> <strong>keys</strong>. Puedes pensar en una
clave como un nombre o un identificador único para un conjunto de
valores en el diccionario. Las claves sólo pueden tener tipos
particulares, tienen que ser “<strong>hashable</strong>”. Las cadenas y
los tipos numéricos son aceptables, pero las listas no lo son.</p>
<div class="codewrapper sourceCode" id="cb51">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>rev <span class="op">=</span> {<span class="dv">1</span>: <span class="st">'one'</span>, <span class="dv">2</span>: <span class="st">'two'</span>}</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>rev[<span class="dv">1</span>]</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="st">'one'</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb53">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>bad <span class="op">=</span> {[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>]: <span class="dv">3</span>}</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Traceback (most recent call last):
  File "&lt;stdin&gt;", line 1, in &lt;module&gt;
TypeError: unhashable type: 'list'</code></pre>
</div>
<p>En Python, un “<strong>Traceback</strong>” es un bloque de error de
varias líneas impreso para el usuario.</p>
<p>Para agregar un elemento al diccionario, asignamos un valor a una
nueva clave:</p>
<div class="codewrapper sourceCode" id="cb55">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>rev <span class="op">=</span> {<span class="dv">1</span>: <span class="st">'one'</span>, <span class="dv">2</span>: <span class="st">'two'</span>}</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>rev[<span class="dv">3</span>] <span class="op">=</span> <span class="st">'three'</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>rev</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>{1: 'one', 2: 'two', 3: 'three'}</code></pre>
</div>
<p>Usar bucles <code>for</code> con diccionarios es un poco más
complicado. Podemos hacer esto de dos maneras:</p>
<div class="codewrapper sourceCode" id="cb57">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> key, value <span class="kw">in</span> rev.items():</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(key, <span class="st">'-&gt;'</span>, value)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="fl">1</span> <span class="op">-&gt;</span> <span class="va">one</span></span>
<span><span class="fl">2</span> <span class="op">-&gt;</span> <span class="va">two</span></span>
<span><span class="fl">3</span> <span class="op">-&gt;</span> <span class="va">three</span></span></code></pre>
</div>
<p>o</p>
<div class="codewrapper sourceCode" id="cb59">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> key <span class="kw">in</span> rev.keys():</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(key, <span class="st">'-&gt;'</span>, rev[key])</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="fl">1</span> <span class="op">-&gt;</span> <span class="va">one</span></span>
<span><span class="fl">2</span> <span class="op">-&gt;</span> <span class="va">two</span></span>
<span><span class="fl">3</span> <span class="op">-&gt;</span> <span class="va">three</span></span></code></pre>
</div>
<div id="cambiando-diccionarios" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="cambiando-diccionarios" class="callout-inner">
<h3 class="callout-title">Cambiando diccionarios<a class="anchor" aria-label="anchor" href="#cambiando-diccionarios"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>Primero, imprime el valor de <code>rev</code> del diccionario en la
pantalla.</li>
<li>Reasigna el segundo valor (parar el <em>par clave: valor</em>) para
que ya no lea “dos” sino “manzana”.</li>
<li>Imprime el valor de <code>rev</code> en la pantalla nuevamente y ve
si el valor ha cambiado.</li>
</ol>
</div>
</div>
</div>
<p>Es importante tener en cuenta que los diccionarios están
“desordenados” y no recuerdan la secuencia de sus elementos (es decir,
el orden en el que los pares clave: valor fueron añadidos al
diccionario). Debido a esto, el orden en que los elementos son devuelto
en los bucles sobre los diccionarios, puede aparecer al azar e incluso
puede cambiar con el tiempo.</p>
</section><section id="funciones"><h2 class="section-heading">Funciones<a class="anchor" aria-label="anchor" href="#funciones"></a>
</h2>
<hr class="half-width">
<p>Definir una sección de código como una función en Python se hace
utilizando la palabra clave <code>def</code>. Por ejemplo, una función
que tome dos argumentos y devuelve su suma puede ser definida como:</p>
<div class="codewrapper sourceCode" id="cb61">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> add_function(a, b):</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> a <span class="op">+</span> b</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>z <span class="op">=</span> add_function(<span class="dv">20</span>, <span class="dv">22</span>)</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(z)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="fl">42</span></span></code></pre>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Keypoints<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Python es un lenguaje interpretado que puede ser usado
interactivamente (ejecutando un comando a la vez) o en modo scripting
(ejecutando una serie de comandos guardados en un archivo).</li>
<li>Se puede asignar un valor a una variable en Python. Esas variables
pueden ser de varios tipos, tales como cadenas, y números: enteros, de
punto flotante y complejos.</li>
<li>Las listas y las tuplas son similares en el sentido de que son
listas ordenadas de elementos; difieren en que una tupla es inmutable
(sus elementos no pueden ser modificados).</li>
<li>Los diccionarios son estructuras de datos desordenadas que
proporcionan mapeos entre claves y valores.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-02-starting-with-data"><p>Content from <a href="02-starting-with-data.html">Comenzando con datos</a></p>
<hr>
<p> Last updated on 2023-02-07 | 
        
        <a href="https://github.com/datacarpentry/python-ecology-lesson-es/edit/main/episodes/02-starting-with-data.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<section id="trabajando-con-pandas-dataframes-en-python"><h2 class="section-heading">Trabajando con Pandas DataFrames en Python<a class="anchor" aria-label="anchor" href="#trabajando-con-pandas-dataframes-en-python"></a>
</h2>
<hr class="half-width">
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>¿Cómo importar datos en Python?</li>
<li>¿Qué es Pandas?</li>
<li>¿Por qué debería de usar Pandas para trabajar con datos?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explorar el directorio del taller y descargar el dataset.</li>
<li>Explicar qué es una biblioteca y para qué se usa.</li>
<li>Describir qué es, Pandas, la Biblioteca de Análisis de Datos de
Python.</li>
<li>Cargar Pandas, la biblioteca de Análisis de Datos de Python.</li>
<li>Usar <code>read_csv</code> para leer datos tabulares en Python.</li>
<li>Describir qué es un <strong>DataFrame</strong> en Python.</li>
<li>Acceder y resumir datos guardados en un
<strong>DataFrame</strong>.</li>
<li>Definir la indexación y su relación con las estructuras de
datos.</li>
<li>Ejecutar operaciones matemáticas básicas y calcular estadísticas
descriptivas sobre datos dentro de un Pandas
<strong>Dataframe</strong>.</li>
<li>Crear gráficos simples.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>Podemos automatizar el proceso de manipular datos con Python. Vale la
pena pasar tiempo escribiendo el código que haga estas tareas ya que una
vez que se escribió, lo podemos usar una y otra vez en distintos
conjuntos de datos que usen un formato similar. Esto hace a nuestros
métodos fácilmente reproducibles. También resulta fácil compartir
nuestro código con nuestros colegas y ellos pueden replicar el mismo
análisis.</p>
<div class="section level4">
<h4 id="comenzando-en-el-mismo-lugar">Comenzando en el mismo lugar<a class="anchor" aria-label="anchor" href="#comenzando-en-el-mismo-lugar"></a>
</h4>
<p>Para que la lección salga de la mejor manera posible, vamos a
asegurarnos que todos estemos en el mismo directorio. Esto debería
ayudarnos a evitar inconvenientes con los nombres de los directorios y
los archivos. Navega al directorio del taller. Si tu estás trabajando en
IPython Notebook asegurate de iniciar tu notebook en el directorio del
taller.</p>
<p>Un comentario al margen es que hay bibliotecas de Python, como <a href="https://docs.python.org/3/library/os.html" class="external-link">OS Library</a>, las
cuales pueden trabajar con la estructra de directorios, sin emebargo
este no es nuestro objetivo el día de hoy.</p>
</div>
<div class="section level4">
<h4 id="nuestros-datos">Nuestros datos<a class="anchor" aria-label="anchor" href="#nuestros-datos"></a>
</h4>
<p>Para esta lección, usaremos los datos de “Portal Teaching” que son
subconjunto de los datos estudiados por Ernst et al. <a href="https://www.esapubs.org/archive/ecol/E090/118/default.htm" class="external-link">Long-term
monitoring and experimental manipulation of a Chihuahuan Desert
ecosystem near Portal, Arizona, USA</a>.</p>
<p>Usaremos los datos de <a href="https://figshare.com/articles/Portal_Project_Teaching_Database/1314459" class="external-link">Portal
Project Teaching Database</a>. Esta sección usa el archivo
<code>surveys.csv</code> el cual puede ser descargado desde: <a href="https://ndownloader.figshare.com/files/2292172" class="external-link">https://ndownloader.figshare.com/files/2292172</a></p>
<p>Vamos a estudiar la especie y el peso de los animales capturados en
sitios dentro de nuestra área de estudio. El conjunto de datos esta
guardado en un archivo <code>.csv</code>: cada línea tiene información
sobre un solo animal y las columnas representan:</p>
<table class="table">
<thead><tr class="header">
<th>Columna</th>
<th>Descripción</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>record_id</td>
<td>identificador único de la observación</td>
</tr>
<tr class="even">
<td>month</td>
<td>mes de observación</td>
</tr>
<tr class="odd">
<td>day</td>
<td>día de la observación</td>
</tr>
<tr class="even">
<td>year</td>
<td>año de la observación</td>
</tr>
<tr class="odd">
<td>plot_id</td>
<td>ID de un sitio en particular</td>
</tr>
<tr class="even">
<td>species_id</td>
<td>código de dos letras</td>
</tr>
<tr class="odd">
<td>sex</td>
<td>sexo del animal (“M”, “F”)</td>
</tr>
<tr class="even">
<td>hindfoot_length</td>
<td>tamaño de pata en mm</td>
</tr>
<tr class="odd">
<td>weight</td>
<td>peso del animal en gramos</td>
</tr>
</tbody>
</table>
<p>Las primeras líneas de nuestro archivo se ven de la siguiente
manera:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>record_id,month,day,year,plot_id,species_id,sex,hindfoot_length,weight
1,7,16,1977,2,NL,M,32,
2,7,16,1977,3,NL,M,33,
3,7,16,1977,2,DM,F,37,
4,7,16,1977,7,DM,M,36,
5,7,16,1977,3,DM,M,35,
6,7,16,1977,1,PF,M,14,
7,7,16,1977,2,PE,F,,
8,7,16,1977,1,DM,M,37,
9,7,16,1977,1,DM,F,34,</code></pre>
</div>
<hr>
</div>
<div class="section level3">
<h3 id="acerca-de-las-bibliotecas">Acerca de las bibliotecas<a class="anchor" aria-label="anchor" href="#acerca-de-las-bibliotecas"></a>
</h3>
<p>Una biblioteca en Python contiene un conjunto de herramientas
(llamadas funciones) que hacen tareas en nuestros datos. Importar una
biblioteca es como traer un la pieza de laboratorio de nuestro locker y
montarla en nuestra mesa de trabajo para usarla en nuestro proyecto. Una
vez que la bilioteca está instalada, puede ser usada y llamada para
hacer muchas tareas.</p>
</div>
<div class="section level3">
<h3 id="pandas-en-python">Pandas en Python<a class="anchor" aria-label="anchor" href="#pandas-en-python"></a>
</h3>
<p>Una de las mejores opciones para trabajar con datos tabulares en
Python es usar la <a href="https://pandas.pydata.org/" class="external-link">Python Data
Analysis Library</a> (alias Pandas). La biblioteca Pandas provee
estructuras de datos, genera gráficos de alta calidad con <a href="https://matplotlib.org/" class="external-link">matplotlib</a> y se integra de buena
forma con otras bibliotecas que usan <strong>arrays</strong> de <a href="https://www.numpy.org/" class="external-link">NumPy</a> (la cual es otra biblioteca de
Python).</p>
<p>Python no carga todas las bibliotecas disponibles por default. Se
tiene que usar el enunciado <code>import</code> en nuestro código para
usar las funciones de la biblioteca. Para importar una biblioteca se usa
la sintaxis <code>import nombreDeLaBiblioteca</code>. Si además le
queremos poner un sobrenombre para acortar los comandos, se puede
agregar <code>as sobrenombreAUsar</code>. Un ejemplo es importar la
biblioteca pandas usando su sobrenombre común <code>pd</code> como está
aquí abajo.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span></code></pre>
</div>
<p>Cada vez que llamemos a una función que está en la biblioteca, se usa
la sintaxis <code>NombreDeLaBiblioteca.NombreDeLaFuncion</code>. Agregar
el nombre de la biblioteca con un <code>.</code> antes del nombre de la
función le indica a Python donde encontrar la función. En el ejemplo
anterior hemos importado a Pandas como <code>pd</code>. Esto significa
que no vamos a tener que escribir <code>pandas</code> cada vez que
llamemos a una función de Pandas y solo lo hagamos con su
sobrenombre.</p>
</div>
</section><section id="leyendo-datos-en-csv-usando-pandas"><h2 class="section-heading">Leyendo datos en CSV usando Pandas<a class="anchor" aria-label="anchor" href="#leyendo-datos-en-csv-usando-pandas"></a>
</h2>
<hr class="half-width">
<p>Empezaremos encontrando y leyendo los datos del censo que están en
formato CSV. CSV son las siglas para <em>Comma-Separated Values</em>,
valores separados por coma, y es una manera común de guardar datos.
Otros símbolos pueden ser usados, te puedes encontrar valores separados
por tabuladores, por punto y coma o por espacios en blanco. Es fácil
remplazar un separador por otro, para usar tu aplicación. La primera
línea del archivo generalmente contiene los encabezados que dicen que
hay en cada columna. CSV (y otros separadores) hacen fácil compartir los
datos y pueden ser importados y exportados desde distintos programas,
incluyendo Microsoft Excel. Para más detalles sobre los archivos CSV, ve
la lección <a href="https://www.datacarpentry.org/spreadsheet-ecology-lesson/05-exporting-data/" class="external-link">Organización
de datos en hojas de cálculo</a>. Podemos usar la función de Pandas
<code>read_csv</code>para abrir el archivo directamente en un <a href="https://pandas.pydata.org/pandas-docs/stable/dsintro.html#dataframe" class="external-link">DataFrame</a>.</p>
<div class="section level3">
<h3 id="entonces-qué-es-un-dataframe">Entonces, ¿qué es un DataFrame?<a class="anchor" aria-label="anchor" href="#entonces-qu%C3%A9-es-un-dataframe"></a>
</h3>
<p>Un <strong>DataFrame</strong> es una estructura de datos con dos
dimensiones en la cual se puede guardar datos de distintos tipos (como
caractéres, enteros, valores de punto flotante, factores y más) en
columnas. Es similar a una hoja de cálculo o una tabla de SQL o el
<code>data.frame</code> de R. Un <strong>DataFrame</strong> siempre
tiene un índice (con inicio en 0). El índice refiere a la posición de un
elemento en la estructura de datos.</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Observa que se usa pd.read_csv debido a que importamos a pandas como pd</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>pd.read_csv(<span class="st">"data/surveys.csv"</span>)</span></code></pre>
</div>
<p>El comando anterior lleva a la siguiente <strong>salida</strong>:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>record_id  month  day  year  plot_id species_id sex  hindfoot_length  weight
0          1      7   16  1977        2         NL   M               32   NaN
1          2      7   16  1977        3         NL   M               33   NaN
2          3      7   16  1977        2         DM   F               37   NaN
3          4      7   16  1977        7         DM   M               36   NaN
4          5      7   16  1977        3         DM   M               35   NaN
...
35544      35545     12   31  2002       15     AH  NaN              NaN  NaN
35545      35546     12   31  2002       15     AH  NaN              NaN  NaN
35546      35547     12   31  2002       10     RM    F               15   14
35547      35548     12   31  2002        7     DO    M               36   51
35548      35549     12   31  2002        5     NaN  NaN             NaN  NaN

[35549 rows x 9 columns]</code></pre>
</div>
<p>Podemos ver que se leyeron 35,549 líneas. Cada una de los líneas
tiene 9 columnas. La primera columna es el índice del DataFrame. El
índice es usado para identificar la posición de los datos, pero no es
una columna del DataFrame. Parace ser que la función
<code>read_csv</code>de Pandas leyó el archivo correctamente. Sin
embargo, no hemos salvado ningún dato en memoria por lo que no podemos
trabajar con estos. Necesitamos asignar el <strong>DataFrame</strong> a
una variable. Recuerda que una variable es el nombre para un valor, como
<code>x</code>o <code>data</code>. Podemos crear un nuevo objeto con el
nombre de la variable y le asignamos un valor usando <code>=</code>.</p>
<p>Llamemos los datos del censo importados <code>surveys_df</code>:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>surveys_df <span class="op">=</span> pd.read_csv(<span class="st">"data/surveys.csv"</span>)</span></code></pre>
</div>
<p>Notemos que cuando asignamos los datos importado a un
<strong>DataFrame</strong> a una variable, Python no produce ninguna
salida a pantalla. Podemos ver el contenido de <code>surveys_df</code>
escribiendo el nombre en la línea de comando de Python.t.</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>surveys_df</span></code></pre>
</div>
<p>el cual imprime los contenidos como anteriormente.</p>
<p>Nota: si la salida es más ancha que la pantalla de teminal al
imprimirlo se verá algo distinto conforme el gran conjunto de datos
pasa. Se podría ver simplemente la última columna de los datos:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>17        NaN
18        NaN
19        NaN
20        NaN
21        NaN
22        NaN
23        NaN
24        NaN
25        NaN
26        NaN
27        NaN
28        NaN
29        NaN
...       ...
35519    36.0
35520    48.0
35521    45.0
35522    44.0
35523    27.0
35524    26.0
35525    24.0
35526    43.0
35527     NaN
35528    25.0
35529     NaN
35530     NaN
35531    43.0
35532    48.0
35533    56.0
35534    53.0
35535    42.0
35536    46.0
35537    31.0
35538    68.0
35539    23.0
35540    31.0
35541    29.0
35542    34.0
35543     NaN
35544     NaN
35545     NaN
35546    14.0
35547    51.0
35548     NaN

[35549 rows x 9 columns]</code></pre>
</div>
<p>No temas, todos los datos están ahí, si tu navegas hacía arriba de tu
terminal. Seleccionemos solo algunas de las líneas, esto hara más facil
que la salida quepa en una terminal, se puede ver que Pandas formateo
los datos de tal manera que quepan en la pantalla:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>surveys_df.head() <span class="co"># The head() method displays the first several lines of a file. It</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>                  <span class="co"># is discussed below.</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>   record_id  month  day  year  plot_id species_id sex  hindfoot_length  \
5          6      7   16  1977        1         PF   M             14.0
6          7      7   16  1977        2         PE   F              NaN
7          8      7   16  1977        1         DM   M             37.0
8          9      7   16  1977        1         DM   F             34.0
9         10      7   16  1977        6         PF   F             20.0

   weight
5     NaN
6     NaN
7     NaN
8     NaN
9     NaN</code></pre>
</div>
</div>
<div class="section level3">
<h3 id="explorando-los-datos-del-censo-de-especies">Explorando los datos del censo de especies<a class="anchor" aria-label="anchor" href="#explorando-los-datos-del-censo-de-especies"></a>
</h3>
<p>Una vez más podemos usar la función <code>type</code> para ver que
cosa es <code>surveys_df</code>:is:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="bu">type</span>(surveys_df)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>&lt;class 'pandas.core.frame.DataFrame'&gt;</code></pre>
</div>
<p>Como podíamos esperar, es un <strong>DataFrame</strong> (o, usando el
nombre completo por el cual Python usa internamente, un
<code>pandas.core.frame.DataFrame</code>).</p>
<p>¿Qué tipo de cosas <code>surveys_df</code> contiene? Los
<strong>DataFrame</strong> tienen un atributo llamado
<code>dtypes</code> que contesta esta pregunta:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>surveys_df.dtypes</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>record_id            int64
month                int64
day                  int64
year                 int64
plot_id              int64
species_id          object
sex                 object
hindfoot_length    float64
weight             float64
dtype: object</code></pre>
</div>
<p>Todos los valores de una columna tienen el mismo tipo. Por ejemplo,
months tienen el tipo <code>int64</code>, el cual es un tipo de entero.
Las celdas en la columna de mes no pueden tener valores fraccionarios,
pero las columnas de <code>weight</code> y <code>hindfoot_length</code>
pueden, ya que son de tupo <code>float64</code>. El tipo
<code>object</code> no tiene un nombre muy útil, pero en ete caso
representa una palabra (como ‘M’ y ‘F’ en el caso del sexo).</p>
<p>En otra lección discutiremos sobre el significado de los distintos
tipos.</p>
<div class="section level4">
<h4 id="formas-útiles-de-ver-objetos-dataframe-en-python">Formas útiles de ver objetos <strong>DataFrame</strong> en
Python<a class="anchor" aria-label="anchor" href="#formas-%C3%BAtiles-de-ver-objetos-dataframe-en-python"></a>
</h4>
<p>Hay distintas maneras de resumir y accesar a los datos guardados en
un DataFrame, usando los atributos y métodos que proveé el objeto
DataFrame.</p>
<p>Para accesar a un atributo, se usa el nombre del objeto
<strong>DataFrame</strong> seguido del nombre del atributo
<code>df_object.attribute</code>. Usando el <strong>DataFrame</strong>
<code>surveys_df</code> y el atributo <code>columns</code>, un índice de
todos los nombres de las columnas en el <strong>DataFrame</strong> puede
ser accesado con <code>surveys_df.columns</code>.</p>
<p>Métodos son llamados de la misma manera usando la sintáxis
<code>df_object.method()</code>. Como ejemplo,
<code>surveys_df.head()</code> obtiene las primeros líneas del
<strong>DataFrame</strong> <code>surveys_df</code> usando <strong>el
método <code>head()</code></strong>. Con un método, podemos proporcionar
información extra en los padres para contreol su comportamiento.</p>
<p>Echemos un ojo a los datos usando este.</p>
<div id="reto---dataframes" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="reto---dataframes" class="callout-inner">
<h3 class="callout-title">Reto - DataFrames<a class="anchor" aria-label="anchor" href="#reto---dataframes"></a>
</h3>
<div class="callout-content">
<p>Usando nuestro <strong>DataFrame</strong> <code>surveys_df</code>,
ejecuta los atributos y métodos siguientes y observa que regresan.</p>
<ol style="list-style-type: decimal">
<li><p><code>surveys_df.columns</code></p></li>
<li><p><code>surveys_df.shape</code> Toma nota de la salida
de<code>shape</code> - ¿Qué formato tiene la salida del atributo que
regresa la forma de un DataFrame?</p></li>
</ol>
<p>Sugerencia: <a href="https://docs.python.org/3/tutorial/datastructures.html#tuples-and-sequences" class="external-link">Más
acerca de tuplas, aquí</a>.</p>
<ol start="3" style="list-style-type: decimal">
<li><p><code>surveys_df.head()</code> También ejecuta
<code>surveys_df.head(15)</code> ¿qué hace esto?</p></li>
<li><p><code>surveys_df.tail()</code></p></li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="calculando-estadísticas-de-los-datos-en-un-dataframe-de-pandas">Calculando estadísticas de los datos en un
<strong>DataFrame</strong> de Pandas<a class="anchor" aria-label="anchor" href="#calculando-estad%C3%ADsticas-de-los-datos-en-un-dataframe-de-pandas"></a>
</h3>
<p>Hemos leídos los datos en Python. Ahora calculemos algunas
estadísticas para entender un poco de los datos con los que estamos
trabajando. Podríamos querer saber cuántos animales fueron colectados en
cada sitio, o cuántos de cada especie fueron capturados. Podemos
calcular estas estadísticas rápidamente usando grupos. Pero antes
tenemos que saber como los queremos argupar.</p>
<p>Empezemos a explorar los datos:</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Echemos un vistazo a las columnas</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>surveys_df.columns</span></code></pre>
</div>
<p>lo que <strong>regresa</strong>:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Index(['record_id', 'month', 'day', 'year', 'plot_id', 'species_id', 'sex',
       'hindfoot_length', 'weight'],
      dtype='object')</code></pre>
</div>
<p>Obtengamos una lista de todas las especies. La función
<code>pd.unique</code> nos dice los distintos valores presentes en la
columna<code>species_id</code>.</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>pd.unique(surveys_df[<span class="st">'species_id'</span>])</span></code></pre>
</div>
<p>lo que <strong>regresa</strong>:</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>array([<span class="st">'NL'</span>, <span class="st">'DM'</span>, <span class="st">'PF'</span>, <span class="st">'PE'</span>, <span class="st">'DS'</span>, <span class="st">'PP'</span>, <span class="st">'SH'</span>, <span class="st">'OT'</span>, <span class="st">'DO'</span>, <span class="st">'OX'</span>, <span class="st">'SS'</span>,</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>       <span class="st">'OL'</span>, <span class="st">'RM'</span>, nan, <span class="st">'SA'</span>, <span class="st">'PM'</span>, <span class="st">'AH'</span>, <span class="st">'DX'</span>, <span class="st">'AB'</span>, <span class="st">'CB'</span>, <span class="st">'CM'</span>, <span class="st">'CQ'</span>,</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>       <span class="st">'RF'</span>, <span class="st">'PC'</span>, <span class="st">'PG'</span>, <span class="st">'PH'</span>, <span class="st">'PU'</span>, <span class="st">'CV'</span>, <span class="st">'UR'</span>, <span class="st">'UP'</span>, <span class="st">'ZL'</span>, <span class="st">'UL'</span>, <span class="st">'CS'</span>,</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>       <span class="st">'SC'</span>, <span class="st">'BA'</span>, <span class="st">'SF'</span>, <span class="st">'RO'</span>, <span class="st">'AS'</span>, <span class="st">'SO'</span>, <span class="st">'PI'</span>, <span class="st">'ST'</span>, <span class="st">'CU'</span>, <span class="st">'SU'</span>, <span class="st">'RX'</span>,</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>       <span class="st">'PB'</span>, <span class="st">'PL'</span>, <span class="st">'PX'</span>, <span class="st">'CT'</span>, <span class="st">'US'</span>], dtype<span class="op">=</span><span class="bu">object</span>)</span></code></pre>
</div>
<div id="reto---estadísticas" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="reto---estadísticas" class="callout-inner">
<h3 class="callout-title">Reto - Estadísticas<a class="anchor" aria-label="anchor" href="#reto---estad%C3%ADsticas"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li><p>Crear una lista de los IDs de los sitios (“plot_id”) que están en
los datos del censo. Llamamemos a esta lista <code>site_names</code>.
¿Cuántos sitios hay en los datos?, ¿cuántas especies hay en los
datos?</p></li>
<li><p>¿Cuál es la diferencia entre <code>len(site_names)</code>
y<code>surveys_df['plot_id'].nunique()</code>?</p></li>
</ol>
</div>
</div>
</div>
</div>
</section><section id="grupos-en-pandas"><h2 class="section-heading">Grupos en Pandas<a class="anchor" aria-label="anchor" href="#grupos-en-pandas"></a>
</h2>
<hr class="half-width">
<p>En algunas ocasiones queremos calcular estadísticas de datos
agrupados por subconjuntos o atributos de nuestros datos. Por ejemplo,
si queremos calcular el promedio de peso de nuestros individuos por
sitio.</p>
<p>Podemos calcular algunas estadísticas básica de todos los datos en
una columna usando el siguiente comando:</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>surveys_df[<span class="st">'weight'</span>].describe()</span></code></pre>
</div>
<p>nos devuelve la siguiente <strong>salida</strong></p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>count    <span class="fl">32283.000000</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>mean        <span class="fl">42.672428</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>std         <span class="fl">36.631259</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="bu">min</span>          <span class="fl">4.000000</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="dv">25</span><span class="op">%</span>         <span class="fl">20.000000</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="dv">50</span><span class="op">%</span>         <span class="fl">37.000000</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="dv">75</span><span class="op">%</span>         <span class="fl">48.000000</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="bu">max</span>        <span class="fl">280.000000</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>Name: weight, dtype: float64</span></code></pre>
</div>
<p>También podemos extraer una métrica en particular::</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>surveys_df[<span class="st">'weight'</span>].<span class="bu">min</span>()</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>surveys_df[<span class="st">'weight'</span>].<span class="bu">max</span>()</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>surveys_df[<span class="st">'weight'</span>].mean()</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>surveys_df[<span class="st">'weight'</span>].std()</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>surveys_df[<span class="st">'weight'</span>].count()</span></code></pre>
</div>
<p>Pero si nosotros queremos extraer información por una o más
variables, por ejemplo sexo, podemos usar el <strong>método
<code>.groupby</code> de Pandas</strong>. Una vez que creamos un
<strong>DataFrame</strong> groupby, podemos calcular estadísticas por el
grupo de nuestra elección.</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Datos agrupados por sexo</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>grouped_data <span class="op">=</span> surveys_df.groupby(<span class="st">'sex'</span>)</span></code></pre>
</div>
<p>La <strong>función <code>describe</code> de Pandas</strong> regresa
estadísticas descriptivas incluyendo: media, meadiana, máx, mín, std y
conteos para una columna en particular de los datos. La función
<code>describe</code> solo regresa los valores de estas estadísticas
para las columnas numéricas.</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estadísticas para todas las columnas numéricas por sexo</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>grouped_data.describe()</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Regresa la media de cada columna numérica por sexo</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>grouped_data.mean()</span></code></pre>
</div>
<p><code>grouped_data.mean()</code> <strong>SALIDA:</strong></p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>        record_id     month        day         year    plot_id  <span class="op">\</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>sex</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>F    <span class="fl">18036.412046</span>  <span class="fl">6.583047</span>  <span class="fl">16.007138</span>  <span class="fl">1990.644997</span>  <span class="fl">11.440854</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>M    <span class="fl">17754.835601</span>  <span class="fl">6.392668</span>  <span class="fl">16.184286</span>  <span class="fl">1990.480401</span>  <span class="fl">11.098282</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>     hindfoot_length     weight</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>sex</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>F          <span class="fl">28.836780</span>  <span class="fl">42.170555</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>M          <span class="fl">29.709578</span>  <span class="fl">42.995379</span></span></code></pre>
</div>
<p>El comando <code>groupby</code> es muy potente y no permite
rápidamente generar estadísticas descriptivas.</p>
<div id="reto---descripción-de-datos" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="reto---descripción-de-datos" class="callout-inner">
<h3 class="callout-title">Reto - Descripción de datos<a class="anchor" aria-label="anchor" href="#reto---descripci%C3%B3n-de-datos"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>¿Cuántos individuos son hembras <code>F</code> y cuántos son machos
<code>M</code>?</li>
<li>Qué pasa cuando agrupas sobre dos columnas usando el siguiente
enunciado y después tomas los valores medios:</li>
</ol>
<ul>
<li><code>grouped_data2 = surveys_df.groupby(['plot_id','sex'])</code></li>
<li><code>grouped_data2.mean()</code></li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li>Calcula las estadísticas descriptivas del peso para cada sitio.
Sugerencia: puedes usar la siguiente sintaxis para solo crear las
estadísticas para una columna de tus datos
<code>by_site['weight'].describe()</code>
</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">
  ¿tuviste bien el reto #3t?
  </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<p><strong>Un pedaxo de la salida para el reto 3 se ve así:</strong></p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> site
 1     count    1903.000000
       mean       51.822911
       std        38.176670
       min         4.000000
       25%        30.000000
       50%        44.000000
       75%        53.000000
       max       231.000000
         ...</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="creando-estadísticas-de-conteos-rapidamente-con-pandas">Creando estadísticas de conteos rapidamente con Pandas<a class="anchor" aria-label="anchor" href="#creando-estad%C3%ADsticas-de-conteos-rapidamente-con-pandas"></a>
</h3>
<p>Ahora contemos el número de muestras de cada especie. Podemos hacer
esto de dsitintas maneras, pero usaremos <code>groupby</code> combinada
con <strong>el método <code>count()</code></strong>.</p>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cuenta el número de muestras por especie</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>species_counts <span class="op">=</span> surveys_df.groupby(<span class="st">'species_id'</span>)[<span class="st">'record_id'</span>].count()</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(species_counts)</span></code></pre>
</div>
<p>O, también podemos contar las líneas que tienen la especie “DO”:</p>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>surveys_df.groupby(<span class="st">'species_id'</span>)[<span class="st">'record_id'</span>].count()[<span class="st">'DO'</span>]</span></code></pre>
</div>
<div id="reto---haciendo-una-lista" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="reto---haciendo-una-lista" class="callout-inner">
<h3 class="callout-title">Reto - Haciendo una lista<a class="anchor" aria-label="anchor" href="#reto---haciendo-una-lista"></a>
</h3>
<div class="callout-content">
<p>¿Qué otra manera hay de crear una lista de especies y asociarle
<code>count</code> de las muestras de los datos? Sugerencia: puedes
hacer ejecutar las funciones <code>count</code>, <code>min</code>, etc.
en un <strong>DataFrame</strong> groupby de la misma manera de la que se
hace en un DataFrame</p>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="funciones-básicas-de-matemáticas">Funciones básicas de matemáticas<a class="anchor" aria-label="anchor" href="#funciones-b%C3%A1sicas-de-matem%C3%A1ticas"></a>
</h3>
<p>Si nosotros quisieramos, se puede hacer operaciones en una columna de
los datos. Como ejemplo multipliquemos todos los valores de peso por 2.
Un uso más útil podría ser normalizar los datos con la media, área o
algñun otro valor calculado de nuestros datos.</p>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Multiplicar todos los valores de peso por 2</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>surveys_df[<span class="st">'weight'</span>]<span class="op">*</span><span class="dv">2</span></span></code></pre>
</div>
</div>
</section><section id="graficar-rápida-y-fácilmente-los-datos-usando-pandas"><h2 class="section-heading">Graficar rápida y fácilmente los datos usando Pandas<a class="anchor" aria-label="anchor" href="#graficar-r%C3%A1pida-y-f%C3%A1cilmente-los-datos-usando-pandas"></a>
</h2>
<hr class="half-width">
<p>También podemos gráficar nuestras estadísticas descriptivas usando
Pandas.</p>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Aseguremonos de que las imágenes aparezcan insertadas en iPython Notebook</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>matplotlib inline</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Creaemos una gráfica de barras</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>species_counts.plot(kind<span class="op">=</span><span class="st">'bar'</span>)<span class="op">;</span></span></code></pre>
</div>
<p><img src="fig/countPerSpecies.png" alt="Peso de especies por sitios" class="figure"> Conteos de especie por sitio</p>
<p>También podemos ver cuantos animales fueron capturados por sitio:</p>
<div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>total_count <span class="op">=</span> surveys_df.groupby(<span class="st">'plot_id'</span>)[<span class="st">'record_id'</span>].nunique()</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="co"># También grafiquemos eso</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>total_count.plot(kind<span class="op">=</span><span class="st">'bar'</span>)<span class="op">;</span></span></code></pre>
</div>
<div id="reto---gráficas" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="reto---gráficas" class="callout-inner">
<h3 class="callout-title">Reto - Gráficas<a class="anchor" aria-label="anchor" href="#reto---gr%C3%A1ficas"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>Crea una gráfica del promedio de peso de las especies por
sitio.</li>
<li>Crea una gráfica del total de machos contra el total de hembras para
todo el conjunto de datos.</li>
</ol>
</div>
</div>
</div>
<div id="reto-de-graficación-final" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="reto-de-graficación-final" class="callout-inner">
<h3 class="callout-title">Reto de graficación final<a class="anchor" aria-label="anchor" href="#reto-de-graficaci%C3%B3n-final"></a>
</h3>
<div class="callout-content">
<p>Crea una gráfica de barras apiladas con el peso en el eje Y, y la
variable de apilamiento que sea el sexo. La gráfica debe mostrar el peso
total por sexo para cada sitio. Algúnos tips que te pueden ayudar a
resolver el reto son los siguientes:</p>
<ul>
<li><a href="https://pandas.pydata.org/pandas-docs/stable/visualization.html#basic-plotting-plot" class="external-link">Para
mayor información en gráfica con Pandas, visita la siguiente
liga.</a></li>
<li>Puedes usar el siguiente código para crear una gráficad de barras
apiladas pero los datos para apilar deben de estar en distintas
columnas. Aquí hay un pequeño ejemplo con algunos datos donde ‘a’, ‘b’ y
‘c’ son los grupos, y ‘one’ y ‘two’ son los subgrupos.</li>
</ul>
<div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>d <span class="op">=</span> {<span class="st">'one'</span> : pd.Series([<span class="fl">1.</span>, <span class="fl">2.</span>, <span class="fl">3.</span>], index<span class="op">=</span>[<span class="st">'a'</span>, <span class="st">'b'</span>, <span class="st">'c'</span>]),<span class="st">'two'</span> : pd.Series([<span class="fl">1.</span>, <span class="fl">2.</span>, <span class="fl">3.</span>, <span class="fl">4.</span>], index<span class="op">=</span>[<span class="st">'a'</span>, <span class="st">'b'</span>, <span class="st">'c'</span>, <span class="st">'d'</span>])}</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>pd.DataFrame(d)</span></code></pre>
</div>
<p>muestra los siguientes datos</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>      one  two
  a    1    1
  b    2    2
  c    3    3
  d  NaN    4</code></pre>
</div>
<p>Podemos gráficar esto con</p>
<div class="codewrapper sourceCode" id="cb32">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Graficar datos apilados de modo que las columnas 'one' y 'two' estén apiladas</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>my_df <span class="op">=</span> pd.DataFrame(d)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>my_df.plot(kind<span class="op">=</span><span class="st">'bar'</span>,stacked<span class="op">=</span><span class="va">True</span>,title<span class="op">=</span><span class="st">"The title of my graph"</span>)</span></code></pre>
</div>
<figure><img src="fig/stackedBar1.png" alt="Gŕafica de barras apiladas" class="figure mx-auto d-block"></figure><ul>
<li>Podemos usar el método <code>.unstack()</code> para transformar los
datos agrupados en columnas para cada gráfica. Intenta ejecutar
<code>.unstack()</code> en algún DataFrame anterior y observa a que
lleva.</li>
</ul>
<p>Empieza transformando los datos agrupados (por sitio y sexo) en una
disposición desapilada entonces crea una gráfica apilada.</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">
  Soluciones para el reto final
  </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<p>Primero agrupemos los datos por sitio y por sexo y después calculemos
el total para cada sitio.</p>
<div class="codewrapper sourceCode" id="cb33">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>by_site_sex <span class="op">=</span> surveys_df.groupby([<span class="st">'plot_id'</span>,<span class="st">'sex'</span>])</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>site_sex_count <span class="op">=</span> by_site_sex[<span class="st">'weight'</span>].<span class="bu">sum</span>()</span></code></pre>
</div>
<p>Esto calcula la suma de los pesos para cada sexo por sitio como una
tabla</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>site  sex
plot_id  sex
1        F      38253
         M      59979
2        F      50144
         M      57250
3        F      27251
         M      28253
4        F      39796
         M      49377
&lt;lo demás fue omitido para abreviar&gt;</code></pre>
</div>
<p>Ahora usaremos <code>.unstack()</code> en los datos agrupados para
entender como el peso total de cada sexo contribuye a cada sitio.</p>
<div class="codewrapper sourceCode" id="cb35">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>by_site_sex <span class="op">=</span> surveys_df.groupby([<span class="st">'plot_id'</span>,<span class="st">'sex'</span>])</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>site_sex_count <span class="op">=</span> by_site_sex[<span class="st">'weight'</span>].<span class="bu">sum</span>()</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>site_sex_count.unstack()</span></code></pre>
</div>
<p>El método <code>unstack</code> de arriba despliega la siguiente
salida:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>sex          F      M
plot_id
1        38253  59979
2        50144  57250
3        27251  28253
4        39796  49377
&lt;los demás sitios son omitido por brevedar&gt;</code></pre>
</div>
<p>Ahora creamos una gráfica de barras apilada con los datos donde el
peso para cada sexo es apilado por sitio.</p>
<p>En vez de mostrarla como tabla, nosotros podemos graficar los datos
apilando los datos de cada sexo como sigue:</p>
<div class="codewrapper sourceCode" id="cb37">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>by_site_sex <span class="op">=</span> surveys_df.groupby([<span class="st">'plot_id'</span>,<span class="st">'sex'</span>])</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>site_sex_count <span class="op">=</span> by_site_sex[<span class="st">'weight'</span>].<span class="bu">sum</span>()</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>spc <span class="op">=</span> site_sex_count.unstack()</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>s_plot <span class="op">=</span> spc.plot(kind<span class="op">=</span><span class="st">'bar'</span>,stacked<span class="op">=</span><span class="va">True</span>,title<span class="op">=</span><span class="st">"Total weight by site and sex"</span>)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>s_plot.set_ylabel(<span class="st">"Weight"</span>)</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>s_plot.set_xlabel(<span class="st">"Plot"</span>)</span></code></pre>
</div>
<figure><img src="fig/stackedBar.png" alt="Gráfica de barras apiladas" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Keypoints<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Las bibliotecas en Python son conjuntos de herramientas, funciones y
estructuras de datos, agrupadas de forma conveniente para facilitar
nuestro trabajo.</li>
<li>Pandas es una librería que ofrece funcionalidades avanzadas para
manejar datos tabulares, procesarlos y obtener resultados similares a
los que ofrecen las hojas de cálculo.</li>
<li>El DataFrame es la estructura de datos fundamental de Pandas,
representa una tabla de datos panel con indexación integrada. Cada
columna contiene los valores de una variable y cada fila un conjunto de
valores de cada columna.</li>
<li>Un índice es un vector inmutable, ordenado y divisible, que almacena
las etiquetas de los ejes de todas las estructuras de Pandas. Se utiliza
para agrupar y seleccionar de distintas maneras el contenido de un
DataFrame.</li>
<li>Pandas ofrece funcionalidades que permiten realizar operaciones
matemáticas, calcular estadísticas y generar gráficos a partir del
contenido de una Serie o DataFrame.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-03-index-slice-subset"><p>Content from <a href="03-index-slice-subset.html">Indexación, segmentación y creación de subconjuntos a partir de DataFrames en Python</a></p>
<hr>
<p> Last updated on 2023-02-07 | 
        
        <a href="https://github.com/datacarpentry/python-ecology-lesson-es/edit/main/episodes/03-index-slice-subset.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<p>En la lección 01, leímos un archivo CSV y cargamos los datos en un
pandas <strong>DataFrame</strong>. Aprendimos:</p>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>¿Cómo puedo acceder a un dato específico en mi ‘dataset’?</li>
<li>¿Cómo pueden ayudarme Python y Pandas a analizar mis datos?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Describir que es indexación en base-0.</li>
<li>Manipular y extraer datos usando encabezados de columnas e
índices.</li>
<li>Usar ‘slicing’ para seleccionar conjuntos de datos de un
‘DataFrame’.</li>
<li>Emplear etiquetas e índices enteros para seleccionar rangos de datos
en un ‘DataFrame’.</li>
<li>Reasignar valores dentro de subconjuntos de datos de un
‘DataFrame’.</li>
<li>Crear una copia de un ‘DataFrame’.</li>
<li>Consultar/Seleccionar un subconjunto de datos usando un conjunto de
criterios utilizando los siguientes operadores: =, !=, &gt;, &lt;,
&gt;=, &lt;=.</li>
<li>Localizar subconjuntos de datos utilizando máscaras.</li>
<li>Describir objetos tipo ‘boolean’ en Python y manipular datos usando
‘booleans’.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<ul>
<li>como guardar el <strong>DataFrame</strong> en un objeto,</li>
<li>como realizar operaciones matemáticas básica sobre datos,</li>
<li>como calcular resúmenes estadísticos, y</li>
<li>como crear gráficos a partir de los datos.</li>
</ul>
<p>En esta lección, exploraremos <strong>formas de acceder a diferentes
partes de los datos</strong> usando:</p>
<ul>
<li>indexación,</li>
<li>segmentación, y</li>
<li>creación de subconjuntos.</li>
</ul>
<section id="cargando-nuestros-datos"><h2 class="section-heading">Cargando nuestros datos<a class="anchor" aria-label="anchor" href="#cargando-nuestros-datos"></a>
</h2>
<hr class="half-width">
<p>Vamos a continuar usando el dataset <strong>surveys</strong> que
usamos con la lección anterior. Reabrámoslo y leamos los datos de
nuevo:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Asegura que panda este disponible</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># lee el archivo **surveys** CSV</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>surveys_df <span class="op">=</span> pd.read_csv(<span class="st">"data/surveys.csv"</span>)</span></code></pre>
</div>
</section><section id="indexando-y-fragmentando-en-python"><h2 class="section-heading">Indexando y Fragmentando en Python<a class="anchor" aria-label="anchor" href="#indexando-y-fragmentando-en-python"></a>
</h2>
<hr class="half-width">
<p>A menudo necesitamos trabajar con subconjuntos de un objeto
<strong>DataFrame</strong>. Existen diferentes maneras de lograr esto,
incluyendo: usando etiquetas (encabezados de columnas), rangos
numéricos, o índices de localizaciones específicas x,y.</p>
</section><section id="seleccionando-datos-mediante-el-uso-de-etiquetas-encabezados-de-columnas"><h2 class="section-heading">Seleccionando datos mediante el uso de Etiquetas (Encabezados de
Columnas)<a class="anchor" aria-label="anchor" href="#seleccionando-datos-mediante-el-uso-de-etiquetas-encabezados-de-columnas"></a>
</h2>
<hr class="half-width">
<p>Utilizamos corchetes <code>[]</code> para seleccionar un subconjunto
de un objeto en Python. Por ejemplo, podemos seleccionar todos los datos
de una columna llamada <code>species_id</code> del
<code>surveys_df</code> <strong>DataFrame</strong> usando el nombre de
la columna. Existen dos maneras de hacer esto:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sugerencia: usa el método .head() que vimos anteriormente para hacer la salida más corta</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Método 1: selecciona un 'subconjunto' de los datos usando el nombre de la columna</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>surveys_df[<span class="st">'species_id'</span>]</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Método 2: usa el nombre de la columna como un 'atributo'; esto produce la misma salida</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>surveys_df.species_id</span></code></pre>
</div>
<p>También podemos crear un nuevo objeto que contiene solamente los
datos de la columna <code>species_id</code> de la siguiente manera:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Crea un objeto, `surveys_species`, que solamente contenga la columna `species_id`</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>surveys_species <span class="op">=</span> surveys_df[<span class="st">'species_id'</span>]</span></code></pre>
</div>
<p>También podemos pasar una lista de nombres de columnas, a manera de
índice para seleccionar las columnas en ese orden. Esto es útil cuando
necesitamos reorganizar nuestros datos.</p>
<p><strong>NOTA:</strong> Si el nombre de una columna no esta incluido
en el <code>DataFrame</code>, se producirá una excepción (error).</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Selecciona las especies y crea un gráfico con las columnas del **DataFrame**</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>surveys_df[[<span class="st">'species_id'</span>, <span class="st">'plot_id'</span>]]</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># ¿Qué pasa cuando invertimos el orden?</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>surveys_df[[<span class="st">'plot_id'</span>, <span class="st">'species_id'</span>]]</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co"># ¿Qué pasa si preguntamos por una columna que no existe?</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>surveys_df[<span class="st">'speciess'</span>]</span></code></pre>
</div>
<p>Python nos informa que tipo de error es en el rastreo, en la parte
inferior dice <code>KeyError: 'speciess'</code> lo que significa que
<code>speciess</code> no es un nombre de columna (o <strong>Key</strong>
que está relacionado con el diccionario de tipo de datos de Python).</p>
</section><section id="extrayendo-subconjuntos-basados-en-rangos-segmentando"><h2 class="section-heading">Extrayendo subconjuntos basados en rangos: Segmentando<a class="anchor" aria-label="anchor" href="#extrayendo-subconjuntos-basados-en-rangos-segmentando"></a>
</h2>
<hr class="half-width">
<p><strong>RECORDATORIO</strong>: Python usa Indexación en base-0</p>
<p>Recordemos que Python usa indexación en base-0. Esto quiere decir que
el primer elemento en un objeto esta localizado en la posición 0. Esto
es diferente de otros lenguajes como R y Matlab que indexan elementos
dentro de objetos iniciando en 1.</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Crea una lista de números:</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>]</span></code></pre>
</div>
<p><img src="fig/slicing-indexing.png" alt="indexing diagram" class="figure"><img src="fig/slicing-slicing.png" alt="slicing diagram" class="figure"></p>
<div id="desafío---extrayendo-datos" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="desafío---extrayendo-datos" class="callout-inner">
<h3 class="callout-title">Desafío - Extrayendo datos<a class="anchor" aria-label="anchor" href="#desaf%C3%ADo---extrayendo-datos"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>¿Qué valor devuelve el siguiente código?</li>
</ol>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>a[<span class="dv">0</span>]</span></code></pre>
</div>
<ol start="2" style="list-style-type: decimal">
<li>¿Qué valor devuelve este?:</li>
</ol>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>a[<span class="dv">5</span>]</span></code></pre>
</div>
<ol start="3" style="list-style-type: decimal">
<li><p>En el ejemplo anterior, llamar a <code>a [5]</code> devuelve un
error. ¿Por qué?</p></li>
<li><p>¿Qué tal este?</p></li>
</ol>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>a[<span class="bu">len</span>(a)]</span></code></pre>
</div>
</div>
</div>
</div>
</section><section id="segmentando-subconjuntos-de-filas-en-python"><h2 class="section-heading">Segmentando Subconjuntos de Filas en Python<a class="anchor" aria-label="anchor" href="#segmentando-subconjuntos-de-filas-en-python"></a>
</h2>
<hr class="half-width">
<p>La segmentación utilizando el operador <code>[]</code> selecciona un
conjunto de filas y/o columnas de un <strong>DataFrame</strong>. Para
segmentar un conjunto de filas, usa la siguiente sintaxis:
<code>data[start:stop]</code>. Cuando se hace segmentación en pandas, el
límite inicial (<strong>start</strong>) se incluye en los datos de
salida. El límite final (<strong>stop</strong>) es un paso MÁS ALLÁ de
la fila que desea seleccionar. Así que si deseas seleccionar las filas
0, 1 y 2, tu código se vería así:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Selecciona las filas 0, 1, 2 (la fila 3 no es seleccionada)</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>surveys_df[<span class="dv">0</span>:<span class="dv">3</span>]</span></code></pre>
</div>
<p>El límite final en Python es diferente del que puedes estar
acostumbrado a usar en Lenguajes como Matlab y R.</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Selecciona las primeras cinco filas (con índices 0, 1, 2, 3, 4)</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>surveys_df[:<span class="dv">5</span>]</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Selecciona el último elemento de la lista</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co"># (el segmento comienza en el último elemento y finaliza al final de la lista)</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>surveys_df[<span class="op">-</span><span class="dv">1</span>:]</span></code></pre>
</div>
<p>También podemos reasignar valores dentro de subconjuntos de nuestro
<strong>DataFrame</strong>.</p>
<p>Pero antes de hacerlo, veamos la diferencia entre el concepto de
copiar objetos y el concepto de referenciar objetos en Python.</p>
</section><section id="copiar-objetos-vs-referenciar-objetos-en-python"><h2 class="section-heading">Copiar Objetos vs Referenciar Objetos en Python<a class="anchor" aria-label="anchor" href="#copiar-objetos-vs-referenciar-objetos-en-python"></a>
</h2>
<hr class="half-width">
<p>Empecemos con un ejemplo:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Usando el método 'copy()'</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>true_copy_surveys_df <span class="op">=</span> surveys_df.copy()</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Usando el operador '='</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>ref_surveys_df <span class="op">=</span> surveys_df</span></code></pre>
</div>
<p>Puedes pensar que el código <code>ref_surveys_df = surveys_df</code>
crea una copia nueva y distinta de objeto <strong>DataFrame</strong>
<code>surveys_df</code>. Sin embargo, usar el operador <code>=</code> en
una instrucción simple de la forma <code>y = x</code>
<strong>no</strong> crea una copia de nuestro
<strong>DataFrame</strong>. En lugar de esto, <code>y = x</code> crea
una variable nueva <code>y</code> que hace referencia al
<strong>mismo</strong> objeto al que <code>x</code> hace referencia.
Para decirlo de otra manera, solamente hay <strong>un</strong> objeto
(el <strong>DataFrame</strong>), y ambos objetos <code>x</code> y
<code>y</code> hacen referencia a él.</p>
<p>En contraste, el método <code>copy()</code> de un
<strong>DataFrame</strong> crea una copia verdadera del
<strong>DataFrame</strong>.</p>
<p>Veamos lo que sucede cuando reasignamos los valores dentro de un
subconjunto del <strong>DataFrame</strong> que hace referencia a otro
objeto <strong>DataFrame</strong>:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Asigna el valor `0` a las primeras tres filas de datos en el **DataFrame**</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>ref_surveys_df[<span class="dv">0</span>:<span class="dv">3</span>] <span class="op">=</span> <span class="dv">0</span></span></code></pre>
</div>
<p>Probemos el siguiente código:</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ref_surveys_df fue creado usando el operador '='</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>ref_surveys_df.head()</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># surveys_df es el **DataFrame** original</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>surveys_df.head()</span></code></pre>
</div>
<p>¿Cuál es la diferencia entre estos dos
<strong>DataFrames</strong>?</p>
<p>Cuando asignamos a las tres primeras filas el valor de <code>0</code>
usando el <strong>DataFrame</strong> <code>ref_surveys_df</code>, el
<strong>DataFrame</strong> <code>surveys_df</code> también es
modificado. Recuerda que creamos el objeto <code>ref_survey_df</code>
arriba usando la instrucción <code>ref_survey_df = surveys_df</code>.
Por lo tanto <code>surveys_df</code> y <code>ref_surveys_df</code> hacen
referencia exactamente al mismo objeto <strong>DataFrame</strong>. Si
cualquiera de los dos objetos (<code>ref_survey_df</code>,
<code>surveys_df</code>) es modificado, el otro objeto va a observar los
mismos cambios.</p>
<p><strong>Revisar y Recapitular</strong>:</p>
<ul>
<li>
<p>Para crear una <strong>copia</strong> de un objeto, usamos el
método <strong>copy()</strong> de un <code>DataFrame</code></p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>true_copy_surveys_df <span class="op">=</span> surveys_df.copy()</span></code></pre>
</div>
</li>
<li>
<p>Para crear una <strong>referencia</strong> a un objeto usamos el
operador <code>=</code></p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>ref_surveys_df <span class="op">=</span> surveys_df</span></code></pre>
</div>
</li>
</ul>
<p>Muy bien, hora de practicar. Vamos a crear un nuevo objeto
<code>DataFrame</code> a partir del archivo CSV con los datos
originales.</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>surveys_df <span class="op">=</span> pd.read_csv(<span class="st">"data/surveys.csv"</span>)</span></code></pre>
</div>
</section><section id="segmentando-subconjuntos-de-filas-y-columnas-en-python"><h2 class="section-heading">Segmentando subconjuntos de filas y columnas en Python<a class="anchor" aria-label="anchor" href="#segmentando-subconjuntos-de-filas-y-columnas-en-python"></a>
</h2>
<hr class="half-width">
<p>Podemos seleccionar subconjuntos de datos, contenidos en rangos
específicos de filas y columnas, usando etiquetas o indexación basada en
números enteros.</p>
<ul>
<li>
<code>loc</code> es usado principalmente para indexación basada en
<em>etiquetas</em>. Permite usar <em>números enteros</em> pero son
interpretados como una <em>etiqueta</em>.</li>
<li>
<code>iloc</code> es usado para indexación basada en <em>números
enteros</em>
</li>
</ul>
<p>Para seleccionar un subconjunto de filas <strong>y</strong> columnas
de nuestro objeto <code>DataFrame</code>, podemos usar el método
<code>iloc</code>. Por ejemplo, podemos seleccionar <code>month</code>,
<code>day</code> y <code>year</code> (que corresponden a las columnas 2,
3 y 4, si empezamos a contar las columnas en 1) para las primeras tres
filas, de la siguiente manera:</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># iloc[segmentación de fila, segmentación de columna]</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>surveys_df.iloc[<span class="dv">0</span>:<span class="dv">3</span>, <span class="dv">1</span>:<span class="dv">4</span>]</span></code></pre>
</div>
<p>lo cual nos produce la siguiente <strong>salida</strong></p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>   month  day  year
0      7   16  1977
1      7   16  1977
2      7   16  1977</code></pre>
</div>
<p>Ten en cuenta que pedimos un segmento de 0:3. Esto produjo 3 filas de
datos. Cuando pides un segmento de 0:3, le estas diciendo a
<strong>Python</strong> que comience en el índice 0 y seleccione las
filas 0, 1, 2, <strong>hasta 3 pero sin incluir esta
última</strong>.</p>
<p>Exploremos otras maneras de indexar y seleccionar subconjuntos de
datos:</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Selecciona todas las columnas para las filas con índices entre 0 y 10</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>surveys_df.loc[[<span class="dv">0</span>, <span class="dv">10</span>], :]</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co"># ¿Qué salida produce el la siguiente instrucción?</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>surveys_df.loc[<span class="dv">0</span>, [<span class="st">'species_id'</span>, <span class="st">'plot_id'</span>, <span class="st">'weight'</span>]]</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="co"># ¿Qué pasa cuando ejecutas el siguiente código?</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>surveys_df.loc[[<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">35549</span>], :]</span></code></pre>
</div>
<p><strong>NOTA</strong>: Las etiquetas utilizadas deben estar incluidas
en el <code>DataFrame</code> o se obtendrá un error de tipo
<code>KeyError</code>.</p>
<p>La indexación por etiquetas (<code>loc</code>) difiere de la
indexación por números enteros (<code>iloc</code>). Cuando usamos
<code>loc</code>, los limites inicial y final se
<strong>incluyen</strong>. Cuando usamos <code>loc</code>,
<em>podemos</em> usar números enteros, pero dichos números enteros harán
referencia a etiquetas usadas a manera de índice y no a la posición. Por
ejemplo, si usamos <code>loc</code> y seleccionamos 1:4 vamos a obtener
resultados diferentes que si usamos <code>iloc</code> para seleccionar
las filas 1:4.</p>
<p>Podemos seleccionar un dato específico utilizando la la intersección
de una fila y una columna dentro del <code>DataFrame</code>, junto con
la indexación basada en números enteros <code>iloc</code>:</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sintaxis para encontrar un dato especifico dentro de un `DataFrame` utilizando indexación `iloc`</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>dat.iloc[fila, columna]</span></code></pre>
</div>
<p>En este ejemplo de <code>iloc</code>,</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>surveys_df.iloc[<span class="dv">2</span>, <span class="dv">6</span>]</span></code></pre>
</div>
<p>la <strong>salida</strong> es la siguiente</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="st">'F'</span></span></code></pre>
</div>
<p>Recuerda que la indexación en Python inicia en 0. Así que, la
direccíon basada en índice [2, 6] selecciona el elemento ubicado en la
intersección de la tercera fila (índice 2) y la séptima columna (índice
6) en el <code>DataFrame</code>.</p>
<div id="desafío---rangos" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="desafío---rangos" class="callout-inner">
<h3 class="callout-title">Desafío - Rangos<a class="anchor" aria-label="anchor" href="#desaf%C3%ADo---rangos"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>¿Qué ocurre al ejecutar el siguiente código?:</li>
</ol>
<ul>
<li><code>surveys_df[0:1]</code></li>
<li><code>surveys_df[:4]</code></li>
<li><code>surveys_df[:-1]</code></li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>¿Qué pasa al ejecutar este otro?:</li>
</ol>
<ul>
<li><p><code>dat.iloc[0:4, 1:4]</code></p></li>
<li><p><code>dat.loc[0:4, 1:4]</code></p></li>
<li><p>¿Qué diferencia observas entre los resultados de los comandos
inmediatamente anteriores?</p></li>
</ul>
</div>
</div>
</div>
</section><section id="creando-subconjuntos-de-datos-mediante-el-filtrado-por-criterios"><h2 class="section-heading">Creando subconjuntos de datos mediante el filtrado por
criterios<a class="anchor" aria-label="anchor" href="#creando-subconjuntos-de-datos-mediante-el-filtrado-por-criterios"></a>
</h2>
<hr class="half-width">
<p>También podemos seleccionar un subconjunto de nuestros datos,
mediante el filtrado de la data original, usando algún criterio. Por
ejemplo, podemos seleccionar todas las filas que tienen el valor de 2002
en la columna <code>year</code>:</p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>surveys_df[surveys_df.year <span class="op">==</span> <span class="dv">2002</span>]</span></code></pre>
</div>
<p>Lo cual produce la siguiente salida:</p>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>record_id  month  day  year  plot_id species_id  sex  hindfoot_length  weight</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="dv">33320</span>      <span class="dv">33321</span>      <span class="dv">1</span>   <span class="dv">12</span>  <span class="dv">2002</span>        <span class="dv">1</span>         DM    M     <span class="dv">38</span>      <span class="dv">44</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="dv">33321</span>      <span class="dv">33322</span>      <span class="dv">1</span>   <span class="dv">12</span>  <span class="dv">2002</span>        <span class="dv">1</span>         DO    M     <span class="dv">37</span>      <span class="dv">58</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="dv">33322</span>      <span class="dv">33323</span>      <span class="dv">1</span>   <span class="dv">12</span>  <span class="dv">2002</span>        <span class="dv">1</span>         PB    M     <span class="dv">28</span>      <span class="dv">45</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="dv">33323</span>      <span class="dv">33324</span>      <span class="dv">1</span>   <span class="dv">12</span>  <span class="dv">2002</span>        <span class="dv">1</span>         AB  NaN    NaN     NaN</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="dv">33324</span>      <span class="dv">33325</span>      <span class="dv">1</span>   <span class="dv">12</span>  <span class="dv">2002</span>        <span class="dv">1</span>         DO    M     <span class="dv">35</span>      <span class="dv">29</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>...</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="dv">35544</span>      <span class="dv">35545</span>     <span class="dv">12</span>   <span class="dv">31</span>  <span class="dv">2002</span>       <span class="dv">15</span>         AH  NaN    NaN     NaN</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="dv">35545</span>      <span class="dv">35546</span>     <span class="dv">12</span>   <span class="dv">31</span>  <span class="dv">2002</span>       <span class="dv">15</span>         AH  NaN    NaN     NaN</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="dv">35546</span>      <span class="dv">35547</span>     <span class="dv">12</span>   <span class="dv">31</span>  <span class="dv">2002</span>       <span class="dv">10</span>         RM    F     <span class="dv">15</span>      <span class="dv">14</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="dv">35547</span>      <span class="dv">35548</span>     <span class="dv">12</span>   <span class="dv">31</span>  <span class="dv">2002</span>        <span class="dv">7</span>         DO    M     <span class="dv">36</span>      <span class="dv">51</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a><span class="dv">35548</span>      <span class="dv">35549</span>     <span class="dv">12</span>   <span class="dv">31</span>  <span class="dv">2002</span>        <span class="dv">5</span>        NaN  NaN    NaN     NaN</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>[<span class="dv">2229</span> rows x <span class="dv">9</span> columns]</span></code></pre>
</div>
<p>También podemos seleccionar todas las filas que <strong>no</strong>
contienen el año 2002:</p>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>surveys_df[surveys_df.year <span class="op">!=</span> <span class="dv">2002</span>]</span></code></pre>
</div>
<p>También podemos definir conjuntos de criterios:</p>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>surveys_df[(surveys_df.year <span class="op">&gt;=</span> <span class="dv">1980</span>) <span class="op">&amp;</span> (surveys_df.year <span class="op">&lt;=</span> <span class="dv">1985</span>)]</span></code></pre>
</div>
<div class="section level3">
<h3 id="hoja-de-referencia-para-sintaxis-de-python">Hoja de referencia para sintaxis de Python<a class="anchor" aria-label="anchor" href="#hoja-de-referencia-para-sintaxis-de-python"></a>
</h3>
<p>Podemos utilizar la sintaxis incluida a continuación, cuando queramos
hace consultas de datos por criterios en un <code>DataFrame</code>.
Experimenta seleccionando varios subconjuntos de los datos contenidos en
<code>surveys_df</code>.</p>
<ul>
<li>Igual a: <code>==</code>
</li>
<li>No igual o diferente de: <code>!=</code>
</li>
<li>Mayor que, menor que: <code>&gt;</code> or <code>&lt;</code>
</li>
<li>Mayor o igual que <code>&gt;=</code>
</li>
<li>Menor o igual que <code>&lt;=</code>
</li>
</ul>
<div id="desafío---consultas" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="desafío---consultas" class="callout-inner">
<h3 class="callout-title">Desafío - Consultas<a class="anchor" aria-label="anchor" href="#desaf%C3%ADo---consultas"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li><p>Selecciona un subconjunto de filas, en el <code>DataFrame</code>
<code>surveys_df</code>, que contenga datos desde el año 1999 y que
contenga valores en <code>weight</code> menores o iguales a 8. ¿Cuántas
filas obtuviste como resultado? ¿Cuántas filas obtuvo tu
compañera?</p></li>
<li><p>Puedes usar la función <code>isin</code> de Python para hacer una
consulta a un <code>DataFrame</code>, basada en una lista de valores
según se muestra a continuación:</p></li>
</ol>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>surveys_df[surveys_df[<span class="st">'species_id'</span>].isin([listGoesHere])]</span></code></pre>
</div>
<p>Usa la función <code>isin</code> para encontrar todos los
<code>plots</code> que contienen una especie en particular en el
<code>DataFrame</code> <code>surveys_df</code>. ¿Cuántos registros
contienen esos valores?</p>
<ol start="3" style="list-style-type: decimal">
<li><p>Experimenta con otras consultas. Crea una consulta que encuentre
todas las filas con el valor de <code>weight</code> mayor o igual a
0.</p></li>
<li><p>El símbolo <code>~</code> puede ser usado en Python para obtener
lo <strong>opuesto</strong> a los datos seleccionados que hayas
especificado. Es equivalente a <strong>no esta en</strong>. Escribe una
consulta que seleccione todas las filas con <code>sex</code> diferente
de ‘M’ o ‘F’ en los datos de <code>surveys_df</code>.</p></li>
</ol>
</div>
</div>
</div>
</div>
</section><section id="usando-máscaras-para-identificar-una-condición-específica"><h2 class="section-heading">Usando máscaras para identificar una condición específica<a class="anchor" aria-label="anchor" href="#usando-m%C3%A1scaras-para-identificar-una-condici%C3%B3n-espec%C3%ADfica"></a>
</h2>
<hr class="half-width">
<p>Una <strong>máscara</strong> puede ser útil para identificar donde
existe o no exite un subconjunto específico de valores - por ejemplo,
NaN, o <strong>Not a Number</strong> en inglés. Para enternder el
concepto de máscaras, también tenemos que entender los objetos
<code>BOOLEAN</code> en Python.</p>
<p>Valores boleanos (<strong>boolean</strong>) incluyen
<code>True</code> o <code>False</code>. Por ejemplo,</p>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Asigna 5 a la variable x</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="co"># ¿Qué nos devuelve la ejecución del siguiente código?</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>x <span class="op">&gt;</span> <span class="dv">5</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="co"># ¿Qué nos devuelve la ejecución de este?</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>x <span class="op">==</span> <span class="dv">5</span></span></code></pre>
</div>
<p>Cuando le preguntamos a Python ¿Cuál es el valor de
<code>x &gt; 5</code>?, obtenemos <code>False</code>. Esto se debe a que
la condición <code>x</code> es mayor que 5, no se cumple dado que
<code>x</code> es igual a 5.</p>
<p>Para crear una máscara booleana:</p>
<ul>
<li>Establece el criterio a ser evaluado como <code>True</code> o
<code>False</code> (ej. <code>values &gt; 5 = True</code>)</li>
<li>Python evaluará cada valor en el objeto para determinar si el valor
cumple el criterio (<code>True</code>) o no lo cumple
(<code>False</code>).</li>
<li>Python crea un objeto de salida que es de la misma forma que el
objeto original, pero con un valor <code>True</code> o
<code>False</code> por cada índice según corresponda.</li>
</ul>
<p>Intentémoslo. Vamos a identificar todos los lugares en los datos de
<code>survey</code> que son <code>null</code> (que no existen o son
NaN). Podemos usar el método <code>isnull</code> para lograrlo. El
método <code>isnull</code> va a comparar cada celda con un valor
<code>null</code>. Si un elemento tiene un valor <code>null</code>, se
le asignará un nuevo valor de <code>True</code> en el objeto de
salida.</p>
<div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>pd.isnull(surveys_df)</span></code></pre>
</div>
<p>Un fragmento de la salida se muestra a continuación:</p>
<div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>      record_id  month    day   year plot_id species_id    sex  hindfoot_length weight</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>         <span class="va">False</span>  <span class="va">False</span>  <span class="va">False</span>  <span class="va">False</span>   <span class="va">False</span>      <span class="va">False</span>  <span class="va">False</span>   <span class="va">False</span>      <span class="va">True</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>         <span class="va">False</span>  <span class="va">False</span>  <span class="va">False</span>  <span class="va">False</span>   <span class="va">False</span>      <span class="va">False</span>  <span class="va">False</span>   <span class="va">False</span>      <span class="va">True</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>         <span class="va">False</span>  <span class="va">False</span>  <span class="va">False</span>  <span class="va">False</span>   <span class="va">False</span>      <span class="va">False</span>  <span class="va">False</span>   <span class="va">False</span>      <span class="va">True</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>         <span class="va">False</span>  <span class="va">False</span>  <span class="va">False</span>  <span class="va">False</span>   <span class="va">False</span>      <span class="va">False</span>  <span class="va">False</span>   <span class="va">False</span>      <span class="va">True</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>         <span class="va">False</span>  <span class="va">False</span>  <span class="va">False</span>  <span class="va">False</span>   <span class="va">False</span>      <span class="va">False</span>  <span class="va">False</span>   <span class="va">False</span>      <span class="va">True</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>[<span class="dv">35549</span> rows x <span class="dv">9</span> columns]</span></code></pre>
</div>
<p>Para seleccionar las filas donde hay valores <code>null</code>,
podemos utilizar una máscara a manera de índice y obtener subconjuntos
de datos así:</p>
<div class="codewrapper sourceCode" id="cb31">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Para seleccionar solamente las filas con valores NaN, podemos utilizar el método 'any()'</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>surveys_df[pd.isnull(surveys_df).<span class="bu">any</span>(axis<span class="op">=</span><span class="dv">1</span>)]</span></code></pre>
</div>
<p>Nota que la columna <code>weight</code> de nuestro
<code>DataFrame</code> contiene varios valores <code>null</code> o
<code>NaN</code>. Exploraremos diferentes maneras de abordar esto en el
episodio de <a href="https://carpentries-es.github.io/python-ecology-lesson-es/04-data-types-and-format/index.html" class="external-link">tipos
de datos y formatos</a>.</p>
<p>También podemos utilizar <code>isnull</code> en una columna en
particular. ¿Qué salida produce el siguiente código?</p>
<div class="codewrapper sourceCode" id="cb32">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ¿Qué hace el siguiente código?</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>empty_weights <span class="op">=</span> surveys_df[pd.isnull(surveys_df[<span class="st">'weight'</span>])][<span class="st">'weight'</span>]</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(empty_weights)</span></code></pre>
</div>
<p>Tomemos un minuto para observar las instrucciones de arriba. Estamos
usando el objeto booleano <code>pd.isnull(surveys_df['weight'])</code> a
manera de índice para <code>surveys_df</code>. Estamos pidiendo a Python
que seleccione aquellas filas que tienen un valor de <code>NaN</code> en
la columna <code>weight</code>.</p>
<div id="desafío---revisando-todo-lo-aprendido" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="desafío---revisando-todo-lo-aprendido" class="callout-inner">
<h3 class="callout-title">Desafío - Revisando todo lo aprendido<a class="anchor" aria-label="anchor" href="#desaf%C3%ADo---revisando-todo-lo-aprendido"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li><p>Crea un nuevo objeto <code>DataFrame</code> que solamente
contenga observaciones cuyos valores en la columna <code>sex</code>
<strong>no</strong> sean <code>female</code> o <code>male</code>. Asigna
cada valor de <code>sex</code> en el nuevo <code>DataFrame</code> a un
nuevo valor de ‘x’. Determina el número total de valores
<code>null</code> en el subconjunto.</p></li>
<li><p>Crea un nuevo objeto <code>DataFrame</code> que contenga solo
observaciones cuyos valores en la columna <code>sex</code> sean
<code>male</code> o <code>female</code> y en los cuales el valor de
<code>weight</code> sea mayor que 0. Luego, crea un gráfico de barra
apiladas del promedio de <code>weight</code>, por parcela, con valores
<code>male</code> versus <code>female</code> apilados por cada
parcela.</p></li>
</ol>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Keypoints<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>En Python, fragmentos de datos pueden ser accedidos usando índices,
cortes, encabezados de columnas, y subconjuntos basados en
condiciones.</li>
<li>Python usa indexación base-0, en la cual el primer elemento de una
lista, tupla o cualquier otra estructura de datos tiene un índice de
0.</li>
<li>‘Pandas’ permite usar procedimientos comunes de exploración de datos
como indexación de datos, cortes y creación de subconjuntos basados en
condiciones.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-04-data-types-and-format"><p>Content from <a href="04-data-types-and-format.html">Tipos de datos y formatos</a></p>
<hr>
<p> Last updated on 2023-02-07 | 
        
        <a href="https://github.com/datacarpentry/python-ecology-lesson-es/edit/main/episodes/04-data-types-and-format.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<p>El formato de columnas y filas individuales afectará el análisis
realizado en un dataset leído en Python. Por ejemplo, no se pueden
realizar cálculos matemáticos sobre una secuencia de caracteres (datos
con formato de texto). Esto puede parecer obvio, sin embargo, a veces en
Python los valores numéricos son leídos como secuencias de caracteres.
En esta situación, cuando intentas realizar cálculos con datos numéricos
sobre datos formateados como secuencias de caracteres, obtienes un
error.</p>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>¿Qué tipos de datos pueden estar contenidos en un DataFrame?</li>
<li>¿Por qué es importante el tipo de datos?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Describir cómo se almacena la información en un DataFrame de
Python.</li>
<li>Examinar la estructura de un DataFrame.</li>
<li>Modificar el formato de los valores en un DataFrame.</li>
<li>Describir cómo los tipos de datos afectan a las operaciones.</li>
<li>Definir, manipular e interconvertir integers y floats en
Python.</li>
<li>Analizar datasets que tienen valores faltantes/nulos (valores
NaN).</li>
<li>Escribir datos manipulados a un archivo.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>En esta lección repasaremos maneras de explorar y comprender mejor la
estructura y formato de nuestros datos.</p>
<section id="tipos-de-datos"><h2 class="section-heading">Tipos de Datos<a class="anchor" aria-label="anchor" href="#tipos-de-datos"></a>
</h2>
<hr class="half-width">
<p>La forma en que se almacena la información en un
<strong>DataFrame</strong> u objeto Python afecta a lo que podemos hacer
con él y también a los resultados de los cálculos. Hay dos tipos
principales de datos que estaremos explorando en esta lección: tipos de
datos numéricos y de texto.</p>
<div class="section level3">
<h3 id="tipos-de-datos-numéricos">Tipos de Datos Numéricos<a class="anchor" aria-label="anchor" href="#tipos-de-datos-num%C3%A9ricos"></a>
</h3>
<p>Los tipos de datos numéricos incluyen enteros
(<strong>integer</strong>) y números de punto flotante
(<strong>float</strong>). Un número de punto flotante tiene puntos
decimales incluso si el valor del punto decimal es 0. Por ejemplo: 1.13,
2.0, 1234.345. Si tenemos una columna que contiene tanto enteros como
números de punto flotante, Pandas asignará el tipo de dato
<code>float</code> a toda la columna, de modo tal que los puntos
decimales no se pierdan.</p>
<p>Un <strong>integer</strong> nunca tendrá un punto decimal. Así que,
si quisiéramos almacenar 1.13 como un entero de tipo
<strong>integer</strong> se almacenará como 1. Del mismo modo, 1234.345
se almacenará como 1234. A menudo, en Python verás el tipo de dato
<code>Int64</code> que representa un entero de 64 bits. El 64
simplemente se refiere a la memoria asignada para almacenar datos en
cada celda; eso se refiere a la cantidad de dígitos que puede
efectivamente almacenar cada “celda”. Asignar espacio antes de tiempo
permite a las computadoras optimizar el almacenamiento y hacer más
eficiente el procesamiento.</p>
</div>
<div class="section level3">
<h3 id="tipo-de-datos-de-texto">Tipo de Datos de Texto<a class="anchor" aria-label="anchor" href="#tipo-de-datos-de-texto"></a>
</h3>
<p>En Python, el tipo de datos de texto se conoce como secuencia de
caracteres (<strong>string</strong>). En Pandas se los conoce como
objetos (<strong>object</strong>). Las secuencias de caracteres pueden
contener números y / o caracteres. Por ejemplo, una secuencia de
caracteres puede ser una palabra, una oración, o varias oraciones. Un
objeto Pandas también podría ser un nombre de gráfico como ‘plot1’. Una
secuencia de caracteres también puede contener o consistir en números.
Por ejemplo, ‘1234’ podría ser almacenado como una secuencia de
caracteres. También ‘10.23’ podría ser almacenado como secuencia de
caracteres. Sin embargo, ¡<strong>las las secuencias de caracteres que
contienen números no se pueden utilizar en operaciones
matemáticas</strong>!</p>
<p>Pandas y Python básico utilizan nombres ligeramente diferentes para
los tipos de datos. Más sobre esto en la tabla de abajo:</p>
<table class="table">
<colgroup>
<col width="8%">
<col width="15%">
<col width="75%">
</colgroup>
<thead><tr class="header">
<th>Tipo en Pandas</th>
<th>Tipo en Python Nativo</th>
<th>Descripción</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>object</td>
<td>string</td>
<td>El <strong>dtype</strong> más general. Será asignado a tu columna si
la columna contiene tipos mixtos (números y secuencias de
caracteres).</td>
</tr>
<tr class="even">
<td>int64</td>
<td>int</td>
<td>Caracteres numéricos. 64 se refiere a la memoria asignada para
almacenar el caracter.</td>
</tr>
<tr class="odd">
<td>float64</td>
<td>float</td>
<td>Caracteres numéricos con decimales. Si una columna contiene números
y NaNs (ver más abajo), Pandas usará float64 por defecto, en caso de que
los datos faltantes contengan decimales.</td>
</tr>
<tr class="even">
<td>datetime64, timedelta[ns]</td>
<td>N/D (ver el módulo <a href="https://doc.python.org/2/library/datetime.html" class="external-link">datetime</a> en la
biblioteca estandar de Python)</td>
<td>Valores destinados a contener datos de tiempo. Mira en estos para
experimentos con series de tiempo.</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="comprobando-el-formato-de-nuestros-datos">Comprobando el formato de nuestros datos<a class="anchor" aria-label="anchor" href="#comprobando-el-formato-de-nuestros-datos"></a>
</h3>
<p>Ahora que tenemos una comprensión básica de los tipos de datos
numéricos y de texto, exploremos el formato de los datos de nuestra
encuesta. Estaremos trabajando con el mismo <strong>dataset</strong>
<code>surveys.csv</code> que hemos usado en lecciones anteriores.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ten en cuenta que se usa `pd.read_csv` porque importamos pandas con el alias `pd`</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>surveys_df <span class="op">=</span> pd.read_csv (<span class="st">"data/surveys.csv"</span>)</span></code></pre>
</div>
<p>Recuerda que podemos comprobar el tipo de un objeto de la siguiente
manera:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="bu">type</span>(surveys_df)</span></code></pre>
</div>
<p><strong>OUTPUT:</strong> <code>pandas.core.frame.DataFrame</code></p>
<p>A continuación, veamos la estructura de datos de nuestras encuestas.
En pandas, podemos comprobar el tipo de datos de una columna en un
<strong>DataFrame</strong> usando la sintaxis
<code>dataFrameName[column_name].dtype</code>:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>surveys_df[<span class="st">'sex'</span>].dtype</span></code></pre>
</div>
<p><strong>OUTPUT:</strong> <code>dtype('O')</code></p>
<p>Un tipo ‘O’ solo significa “objeto” que en el mundo de Pandas es una
secuencia de caracteres (texto).</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>surveys_df[<span class="st">'record_id'</span>].dtype</span></code></pre>
</div>
<p><strong>OUTPUT:</strong> <code>dtype('int64')</code></p>
<p>El tipo <code>int64</code> nos dice que Python está almacenando cada
valor dentro de esta columna como un entero de 64 bits. Podemos usar el
comando <code>dat.dtypes</code> para ver el tipo de datos de cada
columna de un <strong>DataFrame</strong> (todos a la vez).</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>surveys_df.dtypes</span></code></pre>
</div>
<p>which <strong>returns</strong>:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>record_id            int64</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>month                int64</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>day                  int64</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>year                 int64</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>plot_id              int64</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>species_id          <span class="bu">object</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>sex                 <span class="bu">object</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>hindfoot_length    float64</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>weight             float64</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>dtype: <span class="bu">object</span></span></code></pre>
</div>
<p>Ten en cuenta que la mayoría de las columnas en nuestros datos de
encuesta son del tipo <code>int64</code>. Esto significa que son enteros
de 64 bits. Pero la columna de peso (weight) es un valor de punto
flotante o <code>float</code>, lo que significa que contiene decimales.
Las columnas <code>species_id</code> y <code>sex</code> son objetos, lo
cual significa que contienen secuencias de caracteres
<code>string</code>.</p>
</div>
<div class="section level3">
<h3 id="trabajando-con-integers-y-floats">Trabajando con <strong>integers</strong> y
<strong>floats</strong>
<a class="anchor" aria-label="anchor" href="#trabajando-con-integers-y-floats"></a>
</h3>
<p>Así que hemos aprendido que las computadoras almacenan los números de
una de dos maneras: como enteros <code>integer</code> o como números de
punto flotante <code>float</code>. Los <strong>integers</strong> son los
números que usualmente usamos para contar. Los <strong>float</strong>
tienen parte fraccionaria (decimal). Consideremos ahora cómo el tipo de
datos puede impactar en las operaciones matemáticas entre nuestros
datos. La suma, la resta, la división y la multiplicación funcionan en
<strong>float</strong> e <strong>integer</strong> como es de
esperar.</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="dv">5</span><span class="op">+</span><span class="dv">5</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="dv">24</span><span class="op">-</span><span class="dv">4</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="dv">20</span></span></code></pre>
</div>
<p>Si dividimos un <strong>integer</strong> por otro, obtenemos un
<strong>float</strong>. El resultado en Python 3 es diferente al de
Python 2, donde el resultado es un <strong>integer</strong> (porque
Python 2 hace una división entera).</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="dv">5</span><span class="op">/</span><span class="dv">9</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fl">0.5555555555555556</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="dv">10</span><span class="op">/</span><span class="dv">3</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fl">3.3333333333333335</span></span></code></pre>
</div>
<p>También podemos convertir un número de punto flotante en un entero, o
un entero en un número de punto flotante. Ten en cuenta que Python
redondea por defecto cuando convierte de <strong>float</strong> a
<strong>integer</strong>.</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convertir 'a' a integer</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> <span class="fl">7.83</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="bu">int</span>(a)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="dv">7</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Convertir 'b' a float</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> <span class="dv">7</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="bu">float</span>(b)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="fl">7.0</span></span></code></pre>
</div>
</div>
</section><section id="trabajando-con-los-datos-de-nuestra-encuesta"><h2 class="section-heading">Trabajando con los datos de nuestra encuesta<a class="anchor" aria-label="anchor" href="#trabajando-con-los-datos-de-nuestra-encuesta"></a>
</h2>
<hr class="half-width">
<p>Volviendo a nuestros datos, si lo deseamos, podemos modificar el
formato de los valores dentro de nuestros datos. Por ejemplo, podríamos
convertir el campo <code>record_id</code> a <strong>float</strong></p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convertir el campo record_id de integer a float</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>surveys_df[<span class="st">'record_id'</span>] <span class="op">=</span> surveys_df[<span class="st">'record_id'</span>].astype(<span class="st">'float64'</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>surveys_df[<span class="st">'record_id'</span>].dtype</span></code></pre>
</div>
<p><strong>OUTPUT:</strong> <code>dtype('float64')</code></p>
<blockquote>
<h3 id="desafío---cambiando-tipos">Desafío - Cambiando tipos</h3>
<p>Intenta convertir la columna <code>plot_id</code> a
<strong>float</strong> usando</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>surveys_df.plot_id.astype(<span class="st">"float"</span>)</span></code></pre>
</div>
<p>A continuación, intenta convertir <code>weight</code> (peso) en un
<strong>integer</strong>. ¿Qué te dice Pandas? ¿Qué es lo que va mal
ahí? Más adelante, hablaremos acerca de algunas soluciones a esto.</p>
</blockquote>
<div class="section level3">
<h3 id="valores-de-datos-faltantes-o-nulos---nan">Valores de datos faltantes o nulos - NaN<a class="anchor" aria-label="anchor" href="#valores-de-datos-faltantes-o-nulos---nan"></a>
</h3>
<p>¿Qué ocurrió en en el desafío? Ten en cuenta que esto arroja un error
de valor:</p>
<p><code>ValueError: Cannot convert NA to integer</code>.</p>
<p>Si observamos la columna <code>weight</code> (peso) de los datos de
las encuestas, notamos que hay valores NaN (<strong>N</strong>ot
<strong>a</strong> <strong>N</strong>umber) (no es número). Los valores
**NaN ** son valores que no están definidos y que no se pueden
representar matemáticamente. Pandas, por ejemplo, leerá como NaN
aquellas celdas vacías de una hoja CSV o Excel. Los valores NaN tienen
algunas propiedades deseables: si tuviéramos que promediar la columna
<code>weight</code> (peso) sin reemplazar los valores NaN, Python sabría
saltarse las celdas vacías.</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>surveys_df[<span class="st">'weight'</span>].mean()</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fl">42.672428212991356</span></span></code></pre>
</div>
<p>Tratar con valores de datos faltantes siempre es un desafío. A veces
es dificil saber por qué faltan valores. ¿Fue debido a un error de
entrada de datos? ¿O son datos que alguien no pudo recoger? ¿Debe
considerarse el valor como 0? Para tomar buenas decisiones, necesitamos
saber qué representan los valores faltantes del
<strong>dataset</strong>. Si tenemos suerte, tendremos algunos metadatos
que nos dirán más acerca de cómo fueron manejados los valores nulos.</p>
<p>Por ejemplo, en algunas disciplinas, como el sensado remoto, los
valores de datos faltantes suelen definirse como -9999. Tener un montón
de valores -9999 en tus datos podría realmente alterar los cálculos
numéricos. A menudo, en las hojas de cálculo, las celdas se dejan vacías
cuando no hay datos disponibles. Por defecto, Pandas reemplazará esos
valores nulos con <strong>NaN</strong>. Sin embargo, es una buena
práctica adquirir el hábito de marcar intencionalmente aquellas celdas
que no tienen datos con un valor que represente “sin datos”! De esa
manera, en el futuro, no habrá preguntas cuando tu (o alguna otra
persona) explore los datos.</p>
<div class="section level4">
<h4 id="dónde-están-los-nans">¿Dónde están los <strong>NaN’s</strong>?<a class="anchor" aria-label="anchor" href="#d%C3%B3nde-est%C3%A1n-los-nans"></a>
</h4>
<p>Exploremos un poco más los valores <strong>NaN</strong> en nuestros
datos. Usando las herramientas que hemos aprendido en la lección 02,
podemos averiguar cuántas filas contienen valores <strong>NaN</strong>
en la columna weight (peso). También, partiendo de nuestros datos,
podemos crear un nuevo subconjunto que contenga solamente aquellas filas
con peso mayor a cero (es decir, seleccionar valores significativos de
peso):</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(surveys_df[pd.isnull(surveys_df.weight)])</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co"># How many rows have weight values?</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(surveys_df[surveys_df.weight<span class="op">&gt;</span> <span class="dv">0</span>])</span></code></pre>
</div>
<p>Usando el método <code>.fillna ()</code> podemos reemplazar todos los
valores <strong>NaN</strong> por ceros (después de hacer una copia de
los datos de modo tal de no perder nuestro trabajo):</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="op">=</span> surveys_df.copy()</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Completar todos los valores NaN con ceros</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>df1[<span class="st">'weight'</span>] <span class="op">=</span> df1[<span class="st">'weight'</span>].fillna(<span class="dv">0</span>)</span></code></pre>
</div>
<p>Sin embargo, <strong>NaN</strong> y cero arrojan diferentes
resultados en el análisis. El valor promedio resulta diferente cuando
los valores <strong>NaN</strong> se reemplazan con cero, comparando
cuando los valores de <strong>NaN</strong> son descartados o
ignorados.</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>df1[<span class="st">'weight'</span>].mean()</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fl">38.751976145601844</span></span></code></pre>
</div>
<p>Podemos completar los valores <strong>NaN</strong> con cualquier
valor que elijamos. El código de abajo completa todos los Valores
<strong>NaN</strong> con un promedio de los pesos.</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a> df1[<span class="st">'weight'</span>] <span class="op">=</span> surveys_df[<span class="st">'weight'</span>].fillna(surveys_df[<span class="st">'weight'</span>].mean())</span></code></pre>
</div>
<p>También podríamos elegir crear un subconjunto de datos, manteniendo
solamente aquellas filas que no contienen valores
<strong>NaN</strong>.</p>
<p>La clave es tomar decisiones conscientes acerca de cómo administrar
los datos faltantes. Aquí es donde pensamos cómo se utilizarán nuestros
datos y cómo estos valores afectarán las conclusiones científicas que se
obtengan de los datos.</p>
<p>Python nos brinda todas las herramientas que necesitamos para dar
cuenta de estos problemas. Solo debemos ser cautelosos acerca de cómo
nuestras decisiones impactan en los resultados científicos.</p>
<div id="desafío---contando" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="desafío---contando" class="callout-inner">
<h3 class="callout-title">Desafío - Contando<a class="anchor" aria-label="anchor" href="#desaf%C3%ADo---contando"></a>
</h3>
<div class="callout-content">
<p>Cuenta el número de valores perdidos por columna. Sugerencia: el
método <code>.count()</code> te proporciona el número de observaciones
que no son NA por columna. Examina el método <code>.isnull()</code>.</p>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="escribiendo-datos-a-csv">Escribiendo datos a CSV<a class="anchor" aria-label="anchor" href="#escribiendo-datos-a-csv"></a>
</h3>
<p>Hemos aprendido a manipular datos para obtener los resultados
deseados. Pero también hemos discutido acerca de mantener los datos que
han sido manipulados separados de los datos sin procesar. Algo que
podríamos estar interesados en hacer es trabajar solo con las columnas
que tienen datos completos. Primero, recarguemos los datos para no
mezclar todas nuestras manipulaciones anteriores.</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>surveys_df <span class="op">=</span> pd.read_csv(<span class="st">"data/surveys.csv"</span>)</span></code></pre>
</div>
<p>A continuación, vamos a eliminar todas las filas que contienen
valores nulos. Usaremos el comando <code>dropna</code>. De forma
predeterminada, <code>dropna</code> elimina las columnas que contienen
valores nulos incluso para una sola fila.</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>df_na <span class="op">=</span> surveys_df.dropna()</span></code></pre>
</div>
<p>Si ahora escribes <code>df_na</code>, deberías observar que el
<strong>DataFrame</strong> resultante tiene 30676 filas y 9 columnas,
mucho menos que las 35549 filas originales.</p>
<p>Ahora podemos usar el comando <code>to_csv</code> para exportar un
<strong>DataFrame</strong> a formato CSV. Ten en cuenta que el código
que se muestra a continuación por defector guardará los datos en el
directorio de trabajo en el que estamos parados. Podemos guardarlo en
otra carpeta agregando el nombre de la carpeta y una barra inclinada
antes del nombre del archivo:
<code>df.to_csv('foldername/out.csv')</code>. Usamos
<code>index = False</code> para que Pandas no incluya el número de
índice para cada fila.</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Escribir DataFrame a CSV</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>df_na.to_csv(<span class="st">'data_output/surveys_complete.csv'</span>, index<span class="op">=</span><span class="va">False</span>)</span></code></pre>
</div>
<p>Usaremos este archivo de datos más adelante en el taller. Revisa tu
directorio de trabajo para asegurarte de que el CSV se haya guardado
correctamente y que puedas abrirlo. Si lo deseas, intenta recuperarlo
con Python para asegurarte de que se importa correctamente.</p>
</div>
<div class="section level3">
<h3 id="resumen">Resumen<a class="anchor" aria-label="anchor" href="#resumen"></a>
</h3>
<p>Hemos aprendido:</p>
<ul>
<li>Cómo explorar los tipos de dato de las colummnas de un
<strong>DataFrame</strong>
</li>
<li>Cómo cambiar el tipo de dato</li>
<li>Qué son los valores <strong>NaN</strong>, cómo deberían
representarse, y lo que eso significa para tu trabajo</li>
<li>Cómo reemplazar los valores <strong>NaN</strong> si así lo
quisieras</li>
<li>Como usar <code>to_csv</code> para guardar en un archivo los datos
manipulados.</li>
</ul>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Keypoints<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Pandas usa otros nombres para tipos de datos que Python, por
ejemplo: <code>object</code> para datos textuales.</li>
<li>Una columna en un DataFrame sólo puede tener un tipo de datos.</li>
<li>El tipo de datos de la columna de un DataFrame puede ser comprobado
usando <code>dtype</code>.</li>
<li>Es necesario tomar decisiones conscientes sobre cómo manejar los
datos faltantes.</li>
<li>Un DataFrame puede ser guardado en un archivo CSV usando la función
<code>to_csv</code>.</li>
</ul>
</div>
</div>
</div>
</div>
</section></section><section id="aio-05-merging-data"><p>Content from <a href="05-merging-data.html">Combinando DataFrames con Pandas</a></p>
<hr>
<p> Last updated on 2023-02-07 | 
        
        <a href="https://github.com/datacarpentry/python-ecology-lesson-es/edit/main/episodes/05-merging-data.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<p>En muchas situations del “mundo real”, los datos que queremos usar
proceden de múltiples archivos. Frecuentemente necesitamos combinar
estos archivos en un uniquo <strong>DataFrame</strong> para analizar los
datos. El paquete <strong>pandas</strong> proporciona <a href="https://pandas.pydata.org/pandas-docs/stable/merging.html" class="external-link">varios
métodos de combinar <strong>DataFrames</strong></a> incluyendo
<code>merge</code> y <code>concat</code>.</p>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>¿Puedo trabajar con datos de diferentes fuentes?</li>
<li>¿Cómo puedo combinar datos de diferentes datasets?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Combinar datos de varios diferentes archivos en un único DataFrame
usando <code>merge</code> y <code>concat</code>.</li>
<li>Combinar dos DataFrames usando un ID único encontrado en ambos
DataFrames.</li>
<li>Unir DataFrames usando campos comunes (unión por claves).</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>Para trabajar en los ejemplos abajo, necesitamos primero cargar los
archivos de species y surveys dentro de <strong>pandas
DataFrames</strong>. En <strong>Python</strong>:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>surveys_df <span class="op">=</span> pd.read_csv(<span class="st">"data/surveys.csv"</span>,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>                         keep_default_na<span class="op">=</span><span class="va">False</span>, na_values<span class="op">=</span>[<span class="st">""</span>])</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>surveys_df</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>       record_id  month  day  year  plot species  sex  hindfoot_length weight</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>              <span class="dv">1</span>      <span class="dv">7</span>   <span class="dv">16</span>  <span class="dv">1977</span>     <span class="dv">2</span>      NA    M               <span class="dv">32</span>  NaN</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>              <span class="dv">2</span>      <span class="dv">7</span>   <span class="dv">16</span>  <span class="dv">1977</span>     <span class="dv">3</span>      NA    M               <span class="dv">33</span>  NaN</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>              <span class="dv">3</span>      <span class="dv">7</span>   <span class="dv">16</span>  <span class="dv">1977</span>     <span class="dv">2</span>      DM    F               <span class="dv">37</span>  NaN</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>              <span class="dv">4</span>      <span class="dv">7</span>   <span class="dv">16</span>  <span class="dv">1977</span>     <span class="dv">7</span>      DM    M               <span class="dv">36</span>  NaN</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>              <span class="dv">5</span>      <span class="dv">7</span>   <span class="dv">16</span>  <span class="dv">1977</span>     <span class="dv">3</span>      DM    M               <span class="dv">35</span>  NaN</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>...          ...    ...  ...   ...   ...     ...  ...              ...  ...</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="dv">35544</span>      <span class="dv">35545</span>     <span class="dv">12</span>   <span class="dv">31</span>  <span class="dv">2002</span>    <span class="dv">15</span>      AH  NaN              NaN  NaN</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="dv">35545</span>      <span class="dv">35546</span>     <span class="dv">12</span>   <span class="dv">31</span>  <span class="dv">2002</span>    <span class="dv">15</span>      AH  NaN              NaN  NaN</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="dv">35546</span>      <span class="dv">35547</span>     <span class="dv">12</span>   <span class="dv">31</span>  <span class="dv">2002</span>    <span class="dv">10</span>      RM    F               <span class="dv">15</span>   <span class="dv">14</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="dv">35547</span>      <span class="dv">35548</span>     <span class="dv">12</span>   <span class="dv">31</span>  <span class="dv">2002</span>     <span class="dv">7</span>      DO    M               <span class="dv">36</span>   <span class="dv">51</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="dv">35548</span>      <span class="dv">35549</span>     <span class="dv">12</span>   <span class="dv">31</span>  <span class="dv">2002</span>     <span class="dv">5</span>     NaN  NaN              NaN  NaN</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>[<span class="dv">35549</span> rows x <span class="dv">9</span> columns]</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>species_df <span class="op">=</span> pd.read_csv(<span class="st">"data/species.csv"</span>,</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>                         keep_default_na<span class="op">=</span><span class="va">False</span>, na_values<span class="op">=</span>[<span class="st">""</span>])</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>species_df</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>  species_id             genus          species     taxa</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>          AB        Amphispiza        bilineata     Bird</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>          AH  Ammospermophilus          harrisi   Rodent</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>          AS        Ammodramus       savannarum     Bird</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>          BA           Baiomys          taylori   Rodent</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>          CB   Campylorhynchus  brunneicapillus     Bird</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>..        ...               ...              ...      ...</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="dv">49</span>         UP            Pipilo              sp.     Bird</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="dv">50</span>         UR            Rodent              sp.   Rodent</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a><span class="dv">51</span>         US           Sparrow              sp.     Bird</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="dv">52</span>         ZL       Zonotrichia       leucophrys     Bird</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a><span class="dv">53</span>         ZM           Zenaida         macroura     Bird</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>[<span class="dv">54</span> rows x <span class="dv">4</span> columns]</span></code></pre>
</div>
<p>Ten en cuenta que el método <code>read_csv</code> que usamos puede
tomar opciones adicionales que no hemos usado anteriormente. Muchas
funciones en <strong>Python</strong> tienen un conjunto de opciones que
se pueden ser definidas por el usuario si es necesario. En este caso,
hemos indicado a <strong>pandas</strong> que asigne valores vacíos en
nuestro <strong>CSV</strong> como <strong>NaN</strong>
<code>keep_default_na=False, na_values=[""]</code>. <a href="https://pandas.pydata.org/pandas-docs/dev/generated/pandas.io.parsers.read_csv.html" class="external-link">Explora
sobre todas las optciones de <code>read_csv</code> a través de este
enlace.</a></p>
<section id="concatenando-dataframes"><h2 class="section-heading">Concatenando DataFrames<a class="anchor" aria-label="anchor" href="#concatenando-dataframes"></a>
</h2>
<hr class="half-width">
<p>Podemos usar la función <code>concat</code> en pandas para agregar
columnas o filas de un <strong>DataFrame</strong> a otro. Tomemos dos
subconjuntos de nuestros datos para ver cómo esto trabaja.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Lee las primeras 10 líneas de la tabla de encuestas.</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>survey_sub <span class="op">=</span> surveys_df.head(<span class="dv">10</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Agarra las últimas 10 filas</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>survey_sub_last10 <span class="op">=</span> surveys_df.tail(<span class="dv">10</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Restablecer los valores de índice a la segunda __DataFrame__ adjunta correctamente</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>survey_sub_last10<span class="op">=</span>survey_sub_last10.reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># drop=True opción evita agregar una nueva columna de índice con valores de índice antiguos</span></span></code></pre>
</div>
<p>Cuando concatenamos <strong>DataFrames</strong>, necesitamos
especificar el eje. <code>axis=0</code> dice pandas para apilar el
segundo <strong>DataFrame</strong> debajo del primero. Será
automáticamente detecta si los nombres de las columnas son iguales y se
apilarán en consecuencia. <code>axis=1</code> apilará las columnas en el
segundo <strong>DataFrame</strong> a la DERECHA del primer
<strong>DataFrame</strong>. Para apilar los datos verticalmente,
necesitamos asegurarnos de que tenemos las mismas columnas y el formato
de columna asociado en los dos datasets. Cuando apilamos
horizontalmente, queremos asegurarnos de que lo que estamos haciendo
tiene sentido (es decir, los datos son relacionados de alguna
manera).</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Apilar los __DataFrames__ uno encima del otro</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>vertical_stack <span class="op">=</span> pd.concat([survey_sub, survey_sub_last10], axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Coloque los __DataFrames__ de lado a lado</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>horizontal_stack <span class="op">=</span> pd.concat([survey_sub, survey_sub_last10], axis<span class="op">=</span><span class="dv">1</span>)</span></code></pre>
</div>
<div class="section level4">
<h4 id="valores-de-índice-de-fila-y-concat">Valores de índice de fila y Concat<a class="anchor" aria-label="anchor" href="#valores-de-%C3%ADndice-de-fila-y-concat"></a>
</h4>
<p>¿Dale una ojeada al <code>vertical_stack</code>
<strong>DataFrame</strong>? ¿Notaste algo inusual? Los índices de fila
para los dos data frames <code>survey_sub</code>
y<code>survey_sub_last10</code> se han repetido. Podemos reindexar el
nuevo data frame usando el método <code>reset_index()</code>.</p>
</div>
<div class="section level3">
<h3 id="escribiendo-datos-a-csv">Escribiendo datos a CSV<a class="anchor" aria-label="anchor" href="#escribiendo-datos-a-csv"></a>
</h3>
<p>Podemos usar el comando <code>to_csv</code> para exportar un
<strong>DataFrame</strong> en formato CSV. Nota que el código a
continuación guardará los datos por defecto en el directorio de trabajo
corriente. Podemos guárdelo en un directorio diferente agregando el
nombre de la carpeta y una barra al archivo
<code>vertical_stack.to_csv ('foldername/out.csv')</code>. Usamos el
‘índice = Falso’ para que pandas no incluye el número de índice para
cada línea.</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Escribe el __DataFrame__ a CSV</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>vertical_stack.to_csv(<span class="st">'data_output/out.csv'</span>, index<span class="op">=</span><span class="va">False</span>)</span></code></pre>
</div>
<p>Revise su directorio de trabajo para asegurarse de que el CSV se haya
escrito correctamente, y que puedas abrirlo! Si quieres, intenta subirlo
de vuelta a Python para asegurarte se importa correctamente.</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Para los memes lee nuestro archivo en Python y asegúrese de que todo se vea bien.</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>new_output <span class="op">=</span> pd.read_csv(<span class="st">'data_output/out.csv'</span>, keep_default_na<span class="op">=</span><span class="va">False</span>, na_values<span class="op">=</span>[<span class="st">""</span>])</span></code></pre>
</div>
<div id="challenge---combine-data" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge---combine-data" class="callout-inner">
<h3 class="callout-title">Challenge - Combine Data<a class="anchor" aria-label="anchor" href="#challenge---combine-data"></a>
</h3>
<div class="callout-content">
<p>En la carpeta de datos, hay dos archivos de datos de encuestas:
<code>survey2001.csv</code> y <code>survey2002.csv</code>. Lee los datos
en Python y combina los archivos para hacer un
<strong>DataFrame</strong> nuevo. Crea una gráfica del peso promedio de
la parcela, <code>plot_id</code>, por año agrupada por sexo. Exporta tus
resultados como CSV y asegúrate de que se lean correctamente en
Python.</p>
</div>
</div>
</div>
</div>
</section><section id="unión-de-los-dataframes"><h2 class="section-heading">Unión de los <strong>DataFrames</strong><a class="anchor" aria-label="anchor" href="#uni%C3%B3n-de-los-dataframes"></a>
</h2>
<hr class="half-width">
<p>Cuando concatenamos nuestros <strong>DataFrames</strong>, simplemente
los agregamos unos a otros - apilándolos verticalmente o lado a lado.
Otra forma de combinar <strong>DataFrames</strong> es usar columnas en
cada dataset que contienen valores comunes (un ID única común).
Combinando <strong>DataFrames</strong> utilizando un campo común se
llama “<strong>joining</strong>” (unión). Las columnas que contienen los
valores comunes se llaman “<strong>join key(s)</strong>” (claves de
unión). Muchas veces uniendo <strong>DataFrames</strong> de esta manera
es útil cuando un <strong>DataFrame</strong> es una “<strong>lookup
table</strong>” (tabla de búsqueda) que contiene datos adicionales que
queremos incluir en el otro <strong>DataFrame</strong>.</p>
<p>NOTA: Este proceso de unir tablas es similar a lo que hacemos con las
tablas en una base de datos SQL.</p>
<p>Por ejemplo, el archivo <code>species.csv</code> con el que hemos
estado trabajando es una tabla de búsqueda. Esta tabla contiene el
código de género, especie y taxa para 55 especies. El código de la
especie es único para cada línea. Estas especies se identifican en los
datos de nuestra encuesta y también utilizan el código único de
especies. En lugar de agregar 3 columnas más para el género, las
especies y los taxones a cada una de las 35,549 líneas de la tabla de
datos de la encuesta, podemos mantener la tabla más corta con la
información de la especie. Cuando queremos accesar esa información,
podemos crear una consulta que une las columnas adicionales de
información a los datos de la encuesta.</p>
<p>Almacenar los datos de esta manera tiene muchos beneficios, entre
ellos:</p>
<ol style="list-style-type: decimal">
<li><p>Asegura la consistencia en la ortografía de los atributos de las
especies (género, especie y taxones) dado que cada especie solo se
ingresa una vez. ¡Imagine las posibilidades de errores de ortografía al
ingresar el género y las especies miles de veces!</p></li>
<li><p>También nos facilita realizar cambios en la información de la
especie una vez sin tener que encontrar cada instancia en los datos de
la encuesta.</p></li>
<li><p>Optimiza el tamaño de nuestros datos.</p></li>
</ol>
<div class="section level3">
<h3 id="unión-de-dos-dataframes">Unión de Dos <strong>DataFrames</strong>
<a class="anchor" aria-label="anchor" href="#uni%C3%B3n-de-dos-dataframes"></a>
</h3>
<p>Para comprender mejor las uniones, tomemos las primeras 10 líneas de
nuestros datos como un subconjunto con para trabajar. Usaremos el método
<code>.head</code> para hacer esto. También vamos a importar un
subconjunto de la tabla de especies.</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Lee las primeras 10 líneas de la tabla de encuestas.</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>survey_sub <span class="op">=</span> surveys_df.head(<span class="dv">10</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Importe un penqueño subconjunto de los datos de especies diseñados para esta parte de la lección.</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Esa archivado en la carpeta de datos.</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>species_sub <span class="op">=</span> pd.read_csv(<span class="st">'data/speciesSubset.csv'</span>, keep_default_na<span class="op">=</span><span class="va">False</span>, na_values<span class="op">=</span>[<span class="st">""</span>])</span></code></pre>
</div>
<p>En este ejemplo, <code>species_sub</code> es la tabla de búsqueda que
contiene género, especie y nombres de taxa que queremos unir con los
datos en <code>survey_sub</code> para producir un nuevo
<strong>DataFrame</strong> que contiene todas las columnas de
<code>species_df</code> <em>y</em> <code>survey_df</code>.</p>
</div>
<div class="section level3">
<h3 id="identifying-join-keys">Identifying join keys<a class="anchor" aria-label="anchor" href="#identifying-join-keys"></a>
</h3>
<p>Para identificar las claves de combinación adecuadas, primero
necesitamos saber cuáles campos son compartidos entre los archivos
(<strong>DataFrames</strong>). Podríamos inspeccionar los dos
<strong>DataFrames</strong> para identificar estas columnas. Si tenemos
suerte, los dos <strong>DataFrames</strong> tendrán columnas con el
mismo nombre que también contienen los mismos datos. Si somos menos
afortunados, necesitamos identificar una columna (con nombre diferente)
en cada DataFrame que contiene la misma información.</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> species_sub.columns</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>Index([<span class="st">u'species_id'</span>, <span class="st">u'genus'</span>, <span class="st">u'species'</span>, <span class="st">u'taxa'</span>], dtype<span class="op">=</span><span class="st">'object'</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> survey_sub.columns</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>Index([<span class="st">u'record_id'</span>, <span class="st">u'month'</span>, <span class="st">u'day'</span>, <span class="st">u'year'</span>, <span class="st">u'plot_id'</span>, <span class="st">u'species_id'</span>,</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>       <span class="st">u'sex'</span>, <span class="st">u'hindfoot_length'</span>, <span class="st">u'weight'</span>], dtype<span class="op">=</span><span class="st">'object'</span>)</span></code></pre>
</div>
<p>En nuestro ejemplo, la clave de unión es la columna que contiene el
identificador de especie de dos letras, que se llama
<code>species_id</code>.</p>
<p>Ahora que conocemos los campos con los atributos de ID de especies
comunes en cada <strong>DataFrame</strong>, estamos casi listos para
unir nuestros datos. Sin embargo, porque hay <a href="https://blog.codinghorror.com/a-visual-explanation-of-sql-joins/" class="external-link">diferentes
tipos de uniones</a>, también debemos decidir qué tipo de unión tiene
sentido para nuestro análisis.</p>
</div>
<div class="section level3">
<h3 id="uniones-internas">Uniones internas<a class="anchor" aria-label="anchor" href="#uniones-internas"></a>
</h3>
<p>El tipo más común de unión se llama <strong>inner join</strong>
(unión interna). Una combinación interna combina dos
<strong>DataFrames</strong> basados en una clave de unión y devuelve un
nuevo <strong>DataFrame</strong> que contiene <strong>solo</strong>
aquellas filas que tienen valores coincidentes entre los dos
<strong>DataFrames</strong> originales.</p>
<p>Las uniones internas producen un <strong>DataFrame</strong> que
contiene solo filas donde el valor que es el subjecto de la unión existe
en las dos tablas. Un ejemplo de una unión interna, adaptado de <a href="https://blog.codinghorror.com/a-visual-explanation-of-sql-joins/" class="external-link">esta
página</a> se encuentra a continuación:</p>
<figure><img src="fig/inner-join.png" alt="Unión interna - cortesía de codinghorror.com" class="figure mx-auto d-block"></figure><p>La función en pandas para realizar uniones se llama
<code>merge</code> y una unión interna es la opción por defecto:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>merged_inner <span class="op">=</span> pd.merge(left<span class="op">=</span>survey_sub,right<span class="op">=</span>species_sub, left_on<span class="op">=</span><span class="st">'species_id'</span>, right_on<span class="op">=</span><span class="st">'species_id'</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co"># En este caso, `species_id` es el único nombre de columna en los dos __DataFrames__, entonces si omitimos</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># los argumentos `left_on` y `right_on` todavía obtendríamos el mismo resultado</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co"># ¿Cuál es el tamaño de los datos en el resultado?</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>merged_inner.shape</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>merged_inner</span></code></pre>
</div>
<p><strong>OUTPUT:</strong></p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>   record_id  month  day  year  plot_id species_id sex  hindfoot_length  \
0          1      7   16  1977        2         NL   M               32
1          2      7   16  1977        3         NL   M               33
2          3      7   16  1977        2         DM   F               37
3          4      7   16  1977        7         DM   M               36
4          5      7   16  1977        3         DM   M               35
5          8      7   16  1977        1         DM   M               37
6          9      7   16  1977        1         DM   F               34
7          7      7   16  1977        2         PE   F              NaN

   weight       genus   species    taxa
0     NaN     Neotoma  albigula  Rodent
1     NaN     Neotoma  albigula  Rodent
2     NaN   Dipodomys  merriami  Rodent
3     NaN   Dipodomys  merriami  Rodent
4     NaN   Dipodomys  merriami  Rodent
5     NaN   Dipodomys  merriami  Rodent
6     NaN   Dipodomys  merriami  Rodent
7     NaN  Peromyscus  eremicus  Rodent</code></pre>
</div>
<p>El resultado de una unión interna de <code>survey_sub</code> y
<code>species_sub</code> es un nuevo <strong>DataFrame</strong> que
contiene el conjunto combinado de columnas de <code>survey_sub</code> y
<code>species_sub</code>. <em>Solo</em> contiene filas que tienen
códigos de dos letras de especies que son iguales en el
<code>survey_sub</code> y el <code>species_sub</code>
<strong>DataFrames</strong>. En otras palabras, si una fila en
<code>survey_sub</code> tiene un valor de <code>species_id</code> que
<em>no</em> aparece en la <code>species_id</code> columna de
<code>species</code>, no será incluirá en el <strong>DataFrame</strong>
devuelto por una unión interna. Del mismo modo, si una fila en
<code>species_sub</code> tiene un valor de <code>species_id</code> que
<em>no</em> aparece en la columna <code>species_id</code> de
<code>survey_sub</code>, esa fila no será incluida en el
<strong>DataFrame</strong> devuelto por una unión interna.</p>
<p>Los dos <strong>DataFrames</strong> a los que queremos unir se pasan
a la función <code>merge</code> usando el argumento de <code>left</code>
y <code>right</code>. El argumento <code>left_on = 'species'</code> le
dice a <code>merge</code> que use la columna <code>species_id</code>
como la clave de unión de <code>survey_sub</code> (el <code>left</code>
<strong>DataFrame</strong>). De manera similar, el argumento
<code>right_on = 'species_id'</code> le dice a <code>merge</code> que
use la columna <code>species_id</code> como la clave de unión
de<code>species_sub</code> (el <code>right</code>
<strong>DataFrame</strong>). Para uniones internas, el orden de los
argumentos <code>left</code> y<code>right</code> no importa.</p>
<p>El resultado <code>merged_inner</code> <strong>DataFrame</strong>
contiene todas las columnas de<code>survey_sub</code> (ID de registro,
mes, día, etc.), así como todas las columnas de <code>species_sub</code>
(especies_id, género, especie y taxa).</p>
<p>Date cuenta que <code>merged_inner</code> tiene menos filas que
<code>survey_sub</code>. Esto es una indicación de que había filas en
<code>survey_df</code> con valor(es) para <code>species_id</code> que no
existen como valor(es) para <code>species_id</code> en
<code>species_df</code>.</p>
</div>
<div class="section level3">
<h3 id="unión-izquierda">Unión izquierda<a class="anchor" aria-label="anchor" href="#uni%C3%B3n-izquierda"></a>
</h3>
<p>¿Qué pasa si queremos agregar información de <code>species_sub</code>
a <code>survey_sub</code> sin perdiendo información de
<code>survey_sub</code>? En este caso, utilizamos un diferente tipo de
unión llamada “<strong>left outer join</strong> (unión externa
izquierda)”, or a “<strong>left join</strong> (unión izquierda)”.</p>
<p>Como una combinación interna, una unión izquierda utiliza las claves
de unión para combinar dos <strong>DataFrames</strong>. Diferente a una
unión interna, una unión izquierda devolverá <em>todas</em> las filas
del <code>left</code> <strong>DataFrame</strong>, hasta aquellas filas
cuyas claves de unión no tienen valores en el <code>right</code>
<strong>DataFrame</strong>. Filas en el <code>left</code>
<strong>DataFrame</strong> que faltan valores para las clave(s) de unión
en el <code>right</code> <strong>DataFrame</strong> simplemente tendrán
valores nulos (es decir, NaN o Ninguno) para las columnas en el
resultante <strong>DataFrame</strong> unido.</p>
<p>Nota: una unión izquierda todavía descartará las filas del
<code>right</code> <strong>DataFrame</strong> que no tienen valores para
la(s) clave(s) de unión en el <code>left</code>
<strong>DataFrame</strong>.</p>
<figure><img src="fig/left-join.png" alt="Unión izquierda" class="figure mx-auto d-block"></figure><p>Una unión izquierda se realiza en pandas llamando a la misma función
<code>merge</code> utilizada para unión interna, pero usando el
argumento <code>how = 'left'</code>:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>merged_left <span class="op">=</span> pd.merge(left<span class="op">=</span>survey_sub,right<span class="op">=</span>species_sub, how<span class="op">=</span><span class="st">'left'</span>, left_on<span class="op">=</span><span class="st">'species_id'</span>, right_on<span class="op">=</span><span class="st">'species_id'</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>merged_left</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="op">**</span>OUTPUT:<span class="op">**</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>   record_id  month  day  year  plot_id species_id sex  hindfoot_length  <span class="op">\</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>          <span class="dv">1</span>      <span class="dv">7</span>   <span class="dv">16</span>  <span class="dv">1977</span>        <span class="dv">2</span>         NL   M               <span class="dv">32</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>          <span class="dv">2</span>      <span class="dv">7</span>   <span class="dv">16</span>  <span class="dv">1977</span>        <span class="dv">3</span>         NL   M               <span class="dv">33</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>          <span class="dv">3</span>      <span class="dv">7</span>   <span class="dv">16</span>  <span class="dv">1977</span>        <span class="dv">2</span>         DM   F               <span class="dv">37</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>          <span class="dv">4</span>      <span class="dv">7</span>   <span class="dv">16</span>  <span class="dv">1977</span>        <span class="dv">7</span>         DM   M               <span class="dv">36</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>          <span class="dv">5</span>      <span class="dv">7</span>   <span class="dv">16</span>  <span class="dv">1977</span>        <span class="dv">3</span>         DM   M               <span class="dv">35</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>          <span class="dv">6</span>      <span class="dv">7</span>   <span class="dv">16</span>  <span class="dv">1977</span>        <span class="dv">1</span>         PF   M               <span class="dv">14</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span>          <span class="dv">7</span>      <span class="dv">7</span>   <span class="dv">16</span>  <span class="dv">1977</span>        <span class="dv">2</span>         PE   F              NaN</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="dv">7</span>          <span class="dv">8</span>      <span class="dv">7</span>   <span class="dv">16</span>  <span class="dv">1977</span>        <span class="dv">1</span>         DM   M               <span class="dv">37</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="dv">8</span>          <span class="dv">9</span>      <span class="dv">7</span>   <span class="dv">16</span>  <span class="dv">1977</span>        <span class="dv">1</span>         DM   F               <span class="dv">34</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="dv">9</span>         <span class="dv">10</span>      <span class="dv">7</span>   <span class="dv">16</span>  <span class="dv">1977</span>        <span class="dv">6</span>         PF   F               <span class="dv">20</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>   weight       genus   species    taxa</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>     NaN     Neotoma  albigula  Rodent</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>     NaN     Neotoma  albigula  Rodent</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>     NaN   Dipodomys  merriami  Rodent</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>     NaN   Dipodomys  merriami  Rodent</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>     NaN   Dipodomys  merriami  Rodent</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>     NaN         NaN       NaN     NaN</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span>     NaN  Peromyscus  eremicus  Rodent</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a><span class="dv">7</span>     NaN   Dipodomys  merriami  Rodent</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a><span class="dv">8</span>     NaN   Dipodomys  merriami  Rodent</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a><span class="dv">9</span>     NaN         NaN       NaN     NaN</span></code></pre>
</div>
<p>El resultado <strong>DataFrame</strong> de una unión izquierda
(<code>merged_left</code>) se parece mucho al resultado
<strong>DataFrame</strong> de una unión interna
(<code>merged_inner</code>) en términos de las columnas que contiene.
Sin embargo, a diferencia de <code>merged_inner</code>,
<code>merged_left</code> contiene el <strong>mismo número de
filas</strong> como el <strong>DataFrame</strong> original
<code>survey_sub</code>. Cuando inspeccionamos <code>merged_left</code>,
encontramos que hay filas donde la información debería haber venido de
<code>species_sub</code> (es decir,<code>species_id</code>,
<code>genus</code> y<code>taxa</code>) hace falta (contienen valores de
NaN):</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>merged_left[ pd.isnull(merged_left.genus) ]</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="op">**</span>OUTPUT:<span class="op">**</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>   record_id  month  day  year  plot_id species_id sex  hindfoot_length  <span class="op">\</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>          <span class="dv">6</span>      <span class="dv">7</span>   <span class="dv">16</span>  <span class="dv">1977</span>        <span class="dv">1</span>         PF   M               <span class="dv">14</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="dv">9</span>         <span class="dv">10</span>      <span class="dv">7</span>   <span class="dv">16</span>  <span class="dv">1977</span>        <span class="dv">6</span>         PF   F               <span class="dv">20</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>   weight genus species taxa</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>     NaN   NaN     NaN  NaN</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="dv">9</span>     NaN   NaN     NaN  NaN</span></code></pre>
</div>
<p>Estas filas son aquellas en las que el valor de
<code>species_id</code> de<code>survey_sub</code> (en este caso,
<code>PF</code>) no ocurre en<code>species_sub</code>.</p>
</div>
<div class="section level3">
<h3 id="otros-tipos-de-unión">Otros tipos de unión<a class="anchor" aria-label="anchor" href="#otros-tipos-de-uni%C3%B3n"></a>
</h3>
<p>La función <code>merge</code> de pandas admite otros dos tipos de
unión:</p>
<ul>
<li>
<strong>Right (outer) join</strong> unión derecha (exterior): se
invoca al pasar <code>how = 'right'</code> como argumento. Similar a una
unión izquierda, excepto que se guardan <em>todas</em> las filas del
<code>right</code> <strong>DataFrame</strong>, mientras que las filas
del <code>left</code> <strong>DataFrame</strong> sin coincidir con los
valores de las claves de unión son descartadas.</li>
<li>
<strong>Full (outer) join</strong> unión completa (externa): se
invoca al pasar <code>how = 'outer'</code> como argumento. Este tipo de
unión devuelve todas las combinaciones de filas de los dos
<strong>DataFrames</strong>; es decir., el <strong>DataFrame</strong>
resultante estará <code>NaN</code> donde faltan datos en uno de los
<strong>DataFrames</strong>. Este tipo de unión es muy raramente
utilizado.</li>
</ul>
</div>
<div class="section level3">
<h3 id="desafíos-finales">Desafíos Finales<a class="anchor" aria-label="anchor" href="#desaf%C3%ADos-finales"></a>
</h3>
<div id="desafío---distribuciones" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="desafío---distribuciones" class="callout-inner">
<h3 class="callout-title">Desafío - Distribuciones<a class="anchor" aria-label="anchor" href="#desaf%C3%ADo---distribuciones"></a>
</h3>
<div class="callout-content">
<p>Cree un nuevo <strong>DataFrame</strong> uniendo los contenidos de
<code>survey.csv</code> y Tablas <code>species.csv</code>. Luego calcula
y crea un gráfico de la distribución de:</p>
<ol style="list-style-type: decimal">
<li>taxa por parcela</li>
<li>taxa por sexo por parcela</li>
</ol>
</div>
</div>
</div>
<div id="desafío---índice-de-diversidad" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="desafío---índice-de-diversidad" class="callout-inner">
<h3 class="callout-title">Desafío - Índice de Diversidad<a class="anchor" aria-label="anchor" href="#desaf%C3%ADo---%C3%ADndice-de-diversidad"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>En la carpeta de datos, hay un gráfico <code>CSV</code> que contiene
información sobre el tipo asociado con cada parcela. Usa esos datos para
resumir el número de parcelas por tipo de parcela.</li>
<li>Calcula un índice de diversidad de su elección para control vs
parcelas de rodamiento de roedores El índice debe considerar tanto la
abundancia de especies como el número de especies. Puedes optar por
utilizar el simple <a href="https://www.amnh.org/explore/curriculum-collections/biodiversity-counts/plant-ecology/how-to-calculate-a-biodiversity-index" class="external-link">índice
de biodiversidad descrito aquí</a> que calcula la diversidad como:</li>
</ol>
<p>el número de especies en la parcela / el número total de individuos
en la parcela = índice de biodiversidad.</p>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Keypoints<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Podemos usar la función <code>concat</code> en pandas para agregar
columnas o filas de un DataFrame a otro.</li>
<li>Se pueden combinar DataFrames en base a columnas en cada dataset que
contienen valores comunes (un ID única común), esta combinación
utilizando un campo común se llama “joining” (unión).</li>
<li>Es posible realizar distintos tipos de uniones: interna cuyo
resultado solamente tiene las filas donde coinciden las columnas clave
en ambos DataFrame, externa hacia la izquierda o la derecha, si queremos
conservar las filas del DataFrame de origen o destino respectivamente, o
una unión externa completa, con filas para todas las combinaciones de
las columnas clave.</li>
</ul>
</div>
</div>
</div>
</div>
</section></section><section id="aio-06-loops-and-functions"><p>Content from <a href="06-loops-and-functions.html">Flujos de trabajo y automatización</a></p>
<hr>
<p> Last updated on 2023-02-07 | 
        
        <a href="https://github.com/datacarpentry/python-ecology-lesson-es/edit/main/episodes/06-loops-and-functions.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<p>Hasta este momento, hemos usado Python y la librería Pandas para
explorar y manipular <strong>datasets</strong> a mano, tal y como lo
haríamos en una planilla de cálculo. Sin embargo la belleza de usar un
lenguaje de programación como Python viene de la posibilidad de
automatizar el procesamiento de los datos a través del uso de bucles y
funciones.</p>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>¿Puedo automatizar operaciones en Python?</li>
<li>¿Qué son las función y por qué debería usarlas?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Describir por qué se usan los bucles en Python.</li>
<li>Usar bucles for para automatizar el análisis de datos.</li>
<li>Escribir nombres de archivo únicos en Python.</li>
<li>Construir código reusable en Python.</li>
<li>Escribir funciones usando condicionales (if, then, else).</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section id="bucles-for"><h2 class="section-heading">Bucles <strong>for</strong><a class="anchor" aria-label="anchor" href="#bucles-for"></a>
</h2>
<hr class="half-width">
<p>Los bucles nos permiten repetir un flujo de trabajo (o una serie de
acciones) cierto número dado de veces o mientras una condición es
cierta. Podríamos usar un bucle para procesar automáticamente la
información que está contenida en múltiples archivos (valores diarios
con un archivo por año, por ejemplo). Los bucles nos alivian nuestra
tarea al hacer tareas repetitivas sin que tengamos que involucrarnos
directamente, y hace menos probable que introduzcamos errores al
equivocarnos mientras procesamos cada archivo manualmente.</p>
<p>Escribamos un bucle <strong>for</strong> sencillo que simule lo que
un niño podría ver durante una visita al zoológico:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>animals <span class="op">=</span> [<span class="st">'lion'</span>, <span class="st">'tiger'</span>, <span class="st">'crocodile'</span>, <span class="st">'vulture'</span>, <span class="st">'hippo'</span>]</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(animals)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>['lion', 'tiger', 'crocodile', 'vulture', 'hippo']</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> creature <span class="kw">in</span> animals:</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(creature)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">lion</span></span>
<span><span class="va">tiger</span></span>
<span><span class="va">crocodile</span></span>
<span><span class="va">vulture</span></span>
<span><span class="va">hippo</span></span></code></pre>
</div>
<p>La línea que define el bucle debe comenzar con un
<strong>for</strong> y terminar con el caracter dos puntos, y el cuerpo
del bucle debe estar indentado.</p>
<p>Eh este ejemplo, <code>creature</code> es la variable del bucle que
toma el valor de la siguiente entrada en <code>animals</code> cada vez
que el bucle hace una iteración. Podemos darle a la variable del bucle
el nombre que querramos. Después que se termina el bucle, la variable
del bucle continuará existiendo y tendrá el valor de la última entrada
en la colección.</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>animals <span class="op">=</span> [<span class="st">'lion'</span>, <span class="st">'tiger'</span>, <span class="st">'crocodile'</span>, <span class="st">'vulture'</span>, <span class="st">'hippo'</span>]</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> creature <span class="kw">in</span> animals:</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">pass</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'The loop variable is now: '</span> <span class="op">+</span> creature)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>The loop variable is now: hippo</code></pre>
</div>
<p>Acá no le estamos pidiendo a Python que imprima el valor de la
variable del bucle, pero el bucle todavía corre y el valor de
<code>creature</code> cambia en cada iteración. La palabra clave
<code>pass</code> en el cuerpo del bucle significa solamente “no hagas
nada”.</p>
<div id="desafío---bucles" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="desafío---bucles" class="callout-inner">
<h3 class="callout-title">Desafío - <strong>Bucles</strong><a class="anchor" aria-label="anchor" href="#desaf%C3%ADo---bucles"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li><p>¿Qué pasa si no incluimos la palabra clave
<code>pass</code>?</p></li>
<li><p>Reescribe el bucle de tal forma que los animales estén separados
por comas y no por una línea nueva. (Pista: Puedes concatenar cadenas de
caracteres usando el signo más. Por ejemplo,
<code>print(string1 + string2)</code> resulta en
‘string1string2’).</p></li>
</ol>
</div>
</div>
</div>
</section><section id="automatizando-el-procesamiento-de-datos-usando-bucles-for"><h2 class="section-heading">Automatizando el procesamiento de datos usando bucles
<strong>For</strong><a class="anchor" aria-label="anchor" href="#automatizando-el-procesamiento-de-datos-usando-bucles-for"></a>
</h2>
<hr class="half-width">
<p>El archivo que hemos estado usando hasta este momento,
<code>surveys.csv</code>, contiene 25 años de información y es muy
grande. Nos encantaría separar esta información por años y guardar un
archivo por cada año.</p>
<p>Comencemos por crear un nuevo directorio en nuestra carpeta
<code>data</code> para guardar todos estos archivos usando el módulo
<code>os</code></p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>os.mkdir(<span class="st">'data/yearly_files'</span>)</span></code></pre>
</div>
<p>El comando <code>os.mkdir</code> es equivalente a escribir
<code>mkdir</code> en la terminal. Solo para estar seguros, podemos
verificar que nuestro nuevo directorio fue creado en la carpeta
<code>data</code>:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>os.listdir(<span class="st">'data'</span>)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>['plots.csv',
 'portal_mammals.sqlite',
 'species.csv',
 'survey2001.csv',
 'survey2002.csv',
 'surveys.csv',
 'surveys2002_temp.csv',
 'yearly_files']</code></pre>
</div>
<p>El comando <code>os.listdir</code> es equivalente a usar
<code>ls</code> en la terminal.</p>
<p>En episodios anteriores, vimos cómo usar la librería Pandas para
cargar en memoria, a través de <strong>DataFrame</strong>, información
sobre las especies; vimos cómo seleccionar un subconjunto de esos datos
usando ciertos criterios, y vimos también cómo escribir esa información
en un archivo CSV. Escribamos un <strong>script</strong> que realiza
esos tres pasos en secuencia para el año 2002:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Cargamos los datos en un DataFrame</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>surveys_df <span class="op">=</span> pd.read_csv(<span class="st">'data/surveys.csv'</span>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Seleccionamos solo los datos del año 2002</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>surveys2002 <span class="op">=</span> surveys_df[surveys_df.year <span class="op">==</span> <span class="dv">2002</span>]</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Escribimos el nuevo DataFrame en un archivo CSV</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>surveys2002.to_csv(<span class="st">'data/yearly_files/surveys2002.csv'</span>)</span></code></pre>
</div>
<p>Para crear los archivos con los datos anuales, podemos repetir estos
últimos dos comandos una y otra vez, una vez por cada año de
información. Sin embargo, repetir código no es ni elegante ni práctico,
y hace muy probable que introduzcamos errores en nuestro código.
Queremos convertir lo que acabamos de escribir en un bucle que repita
estos últimos dos comandos para cada año en nuestro
<strong>dataset</strong>.</p>
<p>Comencemos con un bucle que solamente imprima los nombres de los
archivos que queremos crear - El dataset que estamos usando va desde
1977 hasta 2002, y vamos a crear un archivo por separado para cada año.
Listar los nombres de los archivos es una buena estrategia, porque así
podemos confirmar que nuestro bucle se está comportando como
esperamos.</p>
<p>Hemos visto que podemos iterar sobre una lista de elementos, entonces
necesitamos una lista de años sobre la cual iterar. Podemos obtener los
años en nuestro <strong>DataFrame</strong> con:</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>surveys_df[<span class="st">'year'</span>]</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>0        1977
1        1977
2        1977
3        1977
         ...
35545    2002
35546    2002
35547    2002
35548    2002</code></pre>
</div>
<p>pero queremos solamente años únicos, y esto lo podemos obtener usando
el método <code>unique</code> que ya hemos visto.</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>surveys_df[<span class="st">'year'</span>].unique()</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>array([1977, 1978, 1979, 1980, 1981, 1982, 1983, 1984, 1985, 1986, 1987,
       1988, 1989, 1990, 1991, 1992, 1993, 1994, 1995, 1996, 1997, 1998,
       1999, 2000, 2001, 2002], dtype=int64)</code></pre>
</div>
<p>Escribiendo esto en un bucle <strong>for</strong> obtenemos</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> year <span class="kw">in</span> surveys_df[<span class="st">'year'</span>].unique():</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>   filename<span class="op">=</span><span class="st">'data/yearly_files/surveys'</span> <span class="op">+</span> <span class="bu">str</span>(year) <span class="op">+</span> <span class="st">'.csv'</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>   <span class="bu">print</span>(filename)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">data</span><span class="op">/</span><span class="va">yearly_files</span><span class="op">/</span><span class="va">surveys1977.csv</span></span>
<span><span class="va">data</span><span class="op">/</span><span class="va">yearly_files</span><span class="op">/</span><span class="va">surveys1978.csv</span></span>
<span><span class="va">data</span><span class="op">/</span><span class="va">yearly_files</span><span class="op">/</span><span class="va">surveys1979.csv</span></span>
<span><span class="va">data</span><span class="op">/</span><span class="va">yearly_files</span><span class="op">/</span><span class="va">surveys1980.csv</span></span>
<span><span class="va">data</span><span class="op">/</span><span class="va">yearly_files</span><span class="op">/</span><span class="va">surveys1981.csv</span></span>
<span><span class="va">data</span><span class="op">/</span><span class="va">yearly_files</span><span class="op">/</span><span class="va">surveys1982.csv</span></span>
<span><span class="va">data</span><span class="op">/</span><span class="va">yearly_files</span><span class="op">/</span><span class="va">surveys1983.csv</span></span>
<span><span class="va">data</span><span class="op">/</span><span class="va">yearly_files</span><span class="op">/</span><span class="va">surveys1984.csv</span></span>
<span><span class="va">data</span><span class="op">/</span><span class="va">yearly_files</span><span class="op">/</span><span class="va">surveys1985.csv</span></span>
<span><span class="va">data</span><span class="op">/</span><span class="va">yearly_files</span><span class="op">/</span><span class="va">surveys1986.csv</span></span>
<span><span class="va">data</span><span class="op">/</span><span class="va">yearly_files</span><span class="op">/</span><span class="va">surveys1987.csv</span></span>
<span><span class="va">data</span><span class="op">/</span><span class="va">yearly_files</span><span class="op">/</span><span class="va">surveys1988.csv</span></span>
<span><span class="va">data</span><span class="op">/</span><span class="va">yearly_files</span><span class="op">/</span><span class="va">surveys1989.csv</span></span>
<span><span class="va">data</span><span class="op">/</span><span class="va">yearly_files</span><span class="op">/</span><span class="va">surveys1990.csv</span></span>
<span><span class="va">data</span><span class="op">/</span><span class="va">yearly_files</span><span class="op">/</span><span class="va">surveys1991.csv</span></span>
<span><span class="va">data</span><span class="op">/</span><span class="va">yearly_files</span><span class="op">/</span><span class="va">surveys1992.csv</span></span>
<span><span class="va">data</span><span class="op">/</span><span class="va">yearly_files</span><span class="op">/</span><span class="va">surveys1993.csv</span></span>
<span><span class="va">data</span><span class="op">/</span><span class="va">yearly_files</span><span class="op">/</span><span class="va">surveys1994.csv</span></span>
<span><span class="va">data</span><span class="op">/</span><span class="va">yearly_files</span><span class="op">/</span><span class="va">surveys1995.csv</span></span>
<span><span class="va">data</span><span class="op">/</span><span class="va">yearly_files</span><span class="op">/</span><span class="va">surveys1996.csv</span></span>
<span><span class="va">data</span><span class="op">/</span><span class="va">yearly_files</span><span class="op">/</span><span class="va">surveys1997.csv</span></span>
<span><span class="va">data</span><span class="op">/</span><span class="va">yearly_files</span><span class="op">/</span><span class="va">surveys1998.csv</span></span>
<span><span class="va">data</span><span class="op">/</span><span class="va">yearly_files</span><span class="op">/</span><span class="va">surveys1999.csv</span></span>
<span><span class="va">data</span><span class="op">/</span><span class="va">yearly_files</span><span class="op">/</span><span class="va">surveys2000.csv</span></span>
<span><span class="va">data</span><span class="op">/</span><span class="va">yearly_files</span><span class="op">/</span><span class="va">surveys2001.csv</span></span>
<span><span class="va">data</span><span class="op">/</span><span class="va">yearly_files</span><span class="op">/</span><span class="va">surveys2002.csv</span></span></code></pre>
</div>
<p>Ahora podemos agregar el resto de pasos que necesitamos para crear
archivos separados:</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the data into a DataFrame</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>surveys_df <span class="op">=</span> pd.read_csv(<span class="st">'data/surveys.csv'</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> year <span class="kw">in</span> surveys_df[<span class="st">'year'</span>].unique():</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Select data for the year</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    surveys_year <span class="op">=</span> surveys_df[surveys_df.year <span class="op">==</span> year]</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Write the new DataFrame to a CSV file</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>    filename <span class="op">=</span> <span class="st">'data/yearly_files/surveys'</span> <span class="op">+</span> <span class="bu">str</span>(year) <span class="op">+</span> <span class="st">'.csv'</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>    surveys_year.to_csv(filename)</span></code></pre>
</div>
<p>Mira dentro del directorio <code>yearly_files</code> y verifica un
par de los archivos que acabaste de crear para confirmar que todo
funcionó como esperabas.</p>
</section><section id="escribiendo-nombres-de-archivo-únicos"><h2 class="section-heading">Escribiendo nombres de archivo únicos<a class="anchor" aria-label="anchor" href="#escribiendo-nombres-de-archivo-%C3%BAnicos"></a>
</h2>
<hr class="half-width">
<p>Nota que en el código anterior creamos un nombre de archivo único
para cada año.</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>filename <span class="op">=</span> <span class="st">'data/yearly_files/surveys'</span> <span class="op">+</span> <span class="bu">str</span>(year) <span class="op">+</span> <span class="st">'.csv'</span></span></code></pre>
</div>
<p>Descompongamos las partes de este nombre:</p>
<ul>
<li>La primera parte es simplemente un texto que especifica el
directorio en el que vamos a guardar nuestro archivo
(data/yearly_files/) y la primera parte del nombre del archivo
(surveys): <code>'data/yearly_files/surveys'</code>
</li>
<li>Podemos concatenar esto con el valor de una variable, en este caso
<code>year</code>, al usar el signo más y la variable que le queremos
añadir al nombre del archivo: <code>+ str(year)</code>
</li>
<li>Por último añadimos la extensión del archivo usando otra cadena de
caracteres: <code>+ '.csv'</code>
</li>
</ul>
<p>Nota que usamos comillas sencillas para añadir las cadenas de
caracteres y que la variable no está entre comillas. Este código produce
la cadena de caracteres <code>data/yearly_files/surveys2002.csv</code>
que contiene tanto el <strong>path</strong> como el nombre del
archivo.</p>
<div id="desafío---modificando-bucles" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="desafío---modificando-bucles" class="callout-inner">
<h3 class="callout-title">Desafío - Modificando bucles<a class="anchor" aria-label="anchor" href="#desaf%C3%ADo---modificando-bucles"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li><p>Algunas de las encuestas que guardaste tienen datos faltantes
(tienen valores nulos que salen como <code>NaN</code> - No es un número
(en inglés) - en los DataFrames y no salen en los archivos de texto).
Modifica el bucle <strong>for</strong> para que las entradas que tengan
valores nulos no sean incluidas en los archivos anuales.</p></li>
<li><p>Supongamos que solo quieres revisar los datos cada cierto
múltiplo de años. ¿Cómo modificarías el bucle para generar un archivo de
datos cada cinco años comenzando desde 1977?</p></li>
<li><p>En vez de separar la información por años, un colega tuyo quiere
hacer el análisis separando por especies. ¿Cómo escribirías un único
archivo CSV por cada especie?</p></li>
</ol>
</div>
</div>
</div>
</section><section id="construyendo-código-modular-y-reusable-usando-funciones"><h2 class="section-heading">Construyendo código modular y reusable usando funciones<a class="anchor" aria-label="anchor" href="#construyendo-c%C3%B3digo-modular-y-reusable-usando-funciones"></a>
</h2>
<hr class="half-width">
<p>Supón que separar archivos enormes en archivos anuales individuales
es una tarea que tenemos que realizar frecuentemente. Podríamos escribir
un bucle <strong>for</strong> como el que hicimos arriba cada vez que lo
necesitemos, pero esto tomaría mucho tiempo y podría introducir errores
en el código. Una solución más elegante sería crear una herramienta
reusable que realice esta tarea con el mínimo esfuerzo del usuario. Para
hacerlo, vamos a convertir el código que ya escribimos en una
función.</p>
<p>Las funciones son piezas de código reusable y autónomo que pueden ser
llamadas mediante un solo comando. Están diseñadas para aceptar
argumentos como entrada y retornar valores, pero no necesitan hacerlo
necesariamente. Las variables declaradas adentro de las funciones solo
existen mientras la función se está ejecutando, y si una variable
adentro de una función (una variable local) tiene el mismo nombre de
otra variable en alguna parte del código, la variable local no
sobrescribe a la otra.</p>
<p>Todo método usado en Python (como por ejemplo <code>print</code>) es
una función, y las librerías que importamos (<code>pandas</code>, por
ejemplo) son una colección de funciones. Solo usaremos las funciones que
están contenidas en el mismo código que las usan, pero es sencillo
también escribir funciones que puedan ser usadas por programas
diferentes.</p>
<p>Las funciones se declaran usando la siguiente estructura general:</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> this_is_the_function_name(input_argument1, input_argument2):</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># El cuerpo de la función está indentado</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Esta función imprime los dos argumentos en pantalla</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'The function arguments are:'</span>, input_argument1, input_argument2, <span class="st">'(this is done inside the function!)'</span>)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># And returns their product</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> input_argument1 <span class="op">*</span> input_argument2</span></code></pre>
</div>
<p>La declaración de la función comienza con la palabra clave
<code>def</code>, seguida del nombre de la función y los argumentos
entre paréntesis, y termina con un dos puntos. El cuerpo de la función
está indentado justo como ocurría con los bucles. Si la función retorna
algo al ser llamada, entonces incluimos la palabra clave
<code>return</code> al final.</p>
<p>Así es como llamamos a la función:</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>product_of_inputs <span class="op">=</span> this_is_the_function_name(<span class="dv">2</span>,<span class="dv">5</span>)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>The function arguments are: 2 5 (this is done inside the function!)</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Their product is:'</span>, product_of_inputs, <span class="st">'(this is done outside the function!)'</span>)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Their product is: 10 (this is done outside the function!)</code></pre>
</div>
<div id="desafío---funciones" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="desafío---funciones" class="callout-inner">
<h3 class="callout-title">Desafío - Funciones<a class="anchor" aria-label="anchor" href="#desaf%C3%ADo---funciones"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>Cambia los valores de los argumentos en la función y mira su
salida.</li>
<li>Intenta llamar a la función usando la cantidad equivocada de
argumentos (es decir, diferente de 2) o sin asignar la llamada de la
función a una variable (sin poner
<code>product_of_inputs =</code>).</li>
<li>Declara una variable dentro de una función y prueba a encontrar en
dónde existe (Pista: ¿puedes imprimirla desde fuera de la función?)</li>
<li>Explora qué sucede cuando una variable tiene el mismo nombre adentro
y afuera de la función. ¿Qué le ocurre a la variable global cuando
cambias el valor de la variable local?</li>
</ol>
</div>
</div>
</div>
<p>Ahora podemos convertir el código para guardar archivos con datos
anuales en una función. Hay muchas “partes” de este código que podemos
convertir en funciones, y podríamos inclusive crear funciones que llaman
a otras funciones adentro de ellas. Comencemos escribiendo una función
que separa los datos para un año y los guarda en un archivo:</p>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> one_year_csv_writer(this_year, all_data):</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Escribe un archivo csv con los datos para un año dado.</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="co">    this_year --- el año del que vamos a extraer los datos</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="co">    all_data --- DataFrame con datos de múltiples años</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Seleccionamos los datos para el año</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>    surveys_year <span class="op">=</span> all_data[all_data.year <span class="op">==</span> this_year]</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Escribimos el nuevo DataFrame a un archivo csv</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>    filename <span class="op">=</span> <span class="st">'data/yearly_files/function_surveys'</span> <span class="op">+</span> <span class="bu">str</span>(this_year) <span class="op">+</span> <span class="st">'.csv'</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>    surveys_year.to_csv(filename)</span></code></pre>
</div>
<p>El texto que está entre los dos grupos de tres comillas dobles se
llama el <strong>docstring</strong> y contiene la documentación de la
función. No hace nada al ejecutar la función y por tanto no es
necesario, pero es una excelente práctica incluir docstrings para
recordar y explicar qué hace el código. Los docstrings en las funciones
también se vuelven parte de la documentación “oficial”:</p>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>one_year_csv_writer?</span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>one_year_csv_writer(<span class="dv">2002</span>, surveys_df)</span></code></pre>
</div>
<p>Cambiamos el nombre del archivo CSV para diferenciarlo del que
escribimos anteriormente. Busca en el directorio
<code>yearly_files</code> el archivo que creamos. ¿Hizo la función lo
que esperabas que hiciera?</p>
<p>Sin embargo, lo que nos encantaría hacer es crear archivos para
múltiples años sin tener que pedirlos uno a uno. Escribamos otra función
que reemplace el bucle <strong>for</strong> simplemente iterando a
través de la secuencia de años y llamando repetidamente a la función que
acabamos de escribir, <code>one_year_csv_writer</code>:</p>
<div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> yearly_data_csv_writer(start_year, end_year, all_data):</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Escribe archivos CSV separados para cada año de datos.</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="co">    start_year --- el primer año de datos que queremos</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="co">    end_year --- el último año de datos que queremos</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="co">    all_data --- DataFrame con datos de varios años</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># "end_year" es el último año que queremos extraer, entonces iteramos hasta end_year+1</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> year <span class="kw">in</span> <span class="bu">range</span>(start_year, end_year<span class="op">+</span><span class="dv">1</span>):</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>        one_year_csv_writer(year, all_data)</span></code></pre>
</div>
<p>Como la gente esperará naturalmente que el año final
(<code>end_year</code>) sea el último, el bucle <strong>for</strong>
adentro de la función termina en <code>end_year + 1</code>. Al escribir
el bucle entero en la función, hemos hecho una herramienta reusable para
cuando necesitemos partir un archivo de datos grande en archivos
anuales. Como podemos especificar el primer y el último año para los
cuales queremos crear archivos, podemos inclusive usar esta función para
crear archivos para un subconjunto de los años disponibles. Así
llamaríamos la función:</p>
<div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cargamos los datos en un DataFrame</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>surveys_df <span class="op">=</span> pd.read_csv(<span class="st">'data/surveys.csv'</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Creamos los archivos CSV</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>yearly_data_csv_writer(<span class="dv">1977</span>, <span class="dv">2002</span>, surveys_df)</span></code></pre>
</div>
<p>¡TEN CUIDADO! Si estás usando Jupyter Notebooks y estás modicando la
función, DEBES volver a ejecutar la celda para que la función cambiada
esté disponible para el resto del código. Nada cambiará visualmente
cuando hagas esto, porque definir una función sin <em>ejecutarla</em> no
produce ninguna salida. Toda otra celda que use la función (ahora
cambiada) también tendrá que ser re-ejecutada para cambiar su
salida.</p>
<div id="challenge--más-funciones" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge--más-funciones" class="callout-inner">
<h3 class="callout-title">Challenge- Más funciones<a class="anchor" aria-label="anchor" href="#challenge--m%C3%A1s-funciones"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>Añade dos argumentos a las funciones que escribimos que tomen el
<strong>path</strong> del directorio donde los archivos serán escritos y
el root del nombre del archivo. Crea un nuevo conjunto de archivos con
un nombre diferente en un directorio diferente.</li>
<li>¿Cómo podrías usar la función <code>yearly_data_csv_writer</code>
para crear un archivo CSV para solo un año? (Pista: piensa sobre la
sintaxis para <code>range</code>)</li>
<li>Haz que las funciones retornen una lista de los archivos que
escribieron. Hay muchas formas en las que puedes hacer esto (¡y deberías
intentarlas todas!): cualquiera de las dos funciones podría imprimir
algo en pantalla, cualquiera podría usar <code>return</code> para
retornar números o cadenas de caracteres cada vez que se llaman, o
podrías hacer una combinación de estas dos estrategias. Podrías también
intentar usar la librería <code>os</code> para listar los contenidos de
directorios.</li>
<li>Explora qué sucede cuando las variables son declaradas dentro de
cada una de las funciones versus en el cuerpo principal de tu código (lo
que está sin indentar). ¿Cuál es el alcance de las variables (es decir,
dónde son visibles)?, ¿qué ocurre si tienen el mismo nombre pero valores
diferentes?</li>
</ol>
</div>
</div>
</div>
<p>Las funciones que escribimos exigen que les demos un valor para cada
argumento. Idealmente, nos gustaría que estas funciones fuesen tan
flexibles e independientes como fuera posible. Modifiquemos la función
<code>yearly_data_csv_writer</code> para que <code>start_year</code> y
<code>end_year</code> sean por defecto el rango completo de los datos si
no son dados por el usuario. Se le pueden asignar a los argumentos
valores por defecto usando el signo igual a la hora de declarar la
función. Todos los argumentos en la función que no tengan un valor por
defecto (como aquí <code>all_data</code>) serán argumentos requeridos y
DEBERÁN ir antes de los argumentos que tengan valores por defecto (y que
son opcionales al llamar la función).</p>
<div class="codewrapper sourceCode" id="cb31">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> yearly_data_arg_test(all_data, start_year <span class="op">=</span> <span class="dv">1977</span>, end_year <span class="op">=</span> <span class="dv">2002</span>):</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Modificación de yearly_data_csv_writer para probar argumentos con valores</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="co">    por defecto!</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="co">    start_year --- el primer año de datos que queremos --- por defecto: 1977</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="co">    end_year --- el último año de datos que queremos --- por defecto: 2002</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="co">    all_data --- DataFrame con datos de varios años</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> start_year, end_year</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>start,end <span class="op">=</span> yearly_data_arg_test (surveys_df, <span class="dv">1988</span>, <span class="dv">1993</span>)</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Both optional arguments:</span><span class="ch">\t</span><span class="st">'</span>, start, end)</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>start,end <span class="op">=</span> yearly_data_arg_test (surveys_df)</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Default values:</span><span class="ch">\t\t\t</span><span class="st">'</span>, start, end)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Both optional arguments:	1988 1993
Default values:		1977 2002</code></pre>
</div>
<p>Los “\t” en <code>print</code> son tabulaciones, y son usadas para
alinear el texto y facilitar la lectura.</p>
<p>Pero ¿qué sucede si nuestro <strong>dataset</strong> no comienza en
1977 ni termina en 2002? Podemos modificar la función de tal forma que
ella misma mire cuál es el primer y cuál es el último año si estos
argumentos no son provistos por el usuario:</p>
<div class="codewrapper sourceCode" id="cb33">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> yearly_data_arg_test(all_data, start_year <span class="op">=</span> <span class="va">None</span>, end_year <span class="op">=</span> <span class="va">None</span>):</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Modificación de yearly_data_csv_writer para probar argumentos con valores</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="co">    por defecto!</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="co">    start_year --- el primer año de datos que queremos --- por defecto: None - revisar all_data</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="co">    end_year --- el último año de datos que queremos --- por defecto: None - revisar all_data</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a><span class="co">    all_data --- DataFrame con datos de varios años</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> start_year <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>        start_year <span class="op">=</span> <span class="bu">min</span>(all_data.year)</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> end_year <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>        end_year <span class="op">=</span> <span class="bu">max</span>(all_data.year)</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> start_year, end_year</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>start,end <span class="op">=</span> yearly_data_arg_test (surveys_df, <span class="dv">1988</span>, <span class="dv">1993</span>)</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Both optional arguments:</span><span class="ch">\t</span><span class="st">'</span>, start, end)</span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>start,end <span class="op">=</span> yearly_data_arg_test (surveys_df)</span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Default values:</span><span class="ch">\t\t\t</span><span class="st">'</span>, start, end)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Both optional arguments:	1988 1993
Default values:		1977 2002</code></pre>
</div>
<p>Ahora los valores por defecto de los argumentos
<code>start_year</code> y <code>end_year</code> en la función
<code>yearly_data_arg_test</code> son <code>None</code>. Esta es una
constante incorporada en Python que indica la ausencia de un valor -
esencialmente indica que la variable existe en el directorio de nombres
de variables (el <strong>namespace</strong>) de la función pero que no
corresponde a ningún objeto existente.</p>
<div id="challenge---variables" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge---variables" class="callout-inner">
<h3 class="callout-title">Challenge - Variables<a class="anchor" aria-label="anchor" href="#challenge---variables"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li><p>¿Qué tipo de objeto corresponde a una variable declarada como
<code>None</code>? (Pista: crea una variable con el valor
<code>None</code> y usa la función <code>type()</code>)</p></li>
<li><p>Compara el comportamiento de la función
<code>yearly_data_arg_test</code> cuando los argumentos tienen
<code>None</code> como valor por defecto y cuando no tienen valores por
defecto.</p></li>
<li><p>¿Qué ocurre si solo incluimos un valor para
<code>start_year</code> al llamar a la función?, ¿puedes escribir una
llamada a la función con solo un valor para <code>end_year</code>?
(Pista: piensa en cómo la función debe estar asignándole valores a cada
uno de sus argumentos - ¡esto está relacionado con la necesidad de poner
los argumentos que no tienen valores por defecto antes de los que sí
tienen valores por defecto en la definición de la función!)</p></li>
</ol>
</div>
</div>
</div>
</section><section id="sentencias-if"><h2 class="section-heading">Sentencias <strong>if</strong><a class="anchor" aria-label="anchor" href="#sentencias-if"></a>
</h2>
<hr class="half-width">
<p>El cuerpo de la función anterior ahora tiene dos condicionales
<strong>if</strong> que revisan los valores de <code>start_year</code> y
<code>end_year</code>. Los condicionales if ejecutan un segmento de
código si una condición dada es cierta. Usualmente lucen así:</p>
<div class="codewrapper sourceCode" id="cb35">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> a<span class="op">&lt;</span><span class="dv">0</span>:  <span class="co"># ¿es cierta esta primera condición?</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># si a ES menor que cero</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'a is a negative number'</span>)</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a><span class="cf">elif</span> a<span class="op">&gt;</span><span class="dv">0</span>:  <span class="co"># La primera condición no es cierta, ¿la segunda?</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># si a NO ES menor que cero y ES mayor que cero</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'a is a positive number'</span>)</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:  <span class="co"># No se cumplieron las dos condiciones</span></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># si a NO ES menor que cero y NO ES mayor que cero</span></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'a must be zero!'</span>)</span></code></pre>
</div>
<p>lo cual retornaría:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>a is a positive number</code></pre>
</div>
<p>Cambia los valores de <code>a</code> para ver cómo funciona este
código. La palabra clave <code>elif</code> significa “sino” (en inglés,
“else if”), y todos los condicionales deben terminar con un dos
puntos.</p>
<p>Los condicionales if en la función <code>yearly_data_arg_test</code>
verifican si hay algún objeto asociado a los nombres
<code>start_year</code> y <code>end_year</code>. Si estas variables son
<code>None</code>, los condicionales if retornan el booleano
<code>True</code> y ejecutan cualquier cosa que esté en su cuerpo. Por
otra parte, si los nombres están asociados a algún valor (es decir,
recibieron un número al ser llamada la función), los condicionales if
retornarán <code>False</code> y no ejecutan su cuerpo. El condicional
opuesto, que retornaría <code>True</code> si las variables estuvieran
asociadas con objetos (es decir, si hubieran recibido valores al
llamarse la función), sería <code>if start_year</code> y
<code>if end_year</code>.</p>
<p>Tal y como la hemos escrito hasta este momento, la función
<code>yearly_data_arg_test</code> asocia los valores que le pasamos
cuando la llamamos con los argumentos en la definición de la función
solo basados en su orden. Si la función recibe solo dos valores al ser
llamada, el primero será asociado con <code>all_data</code> y el segundo
con <code>start_year</code>, sin importar cuál era nuestra intención.
Podemos solucionar este problema al llamar la función usando argumentos
<strong>keyword</strong>, en donde cada uno de los argumentos en la
definición de la función está asociado con una <strong>keyword</strong>
y al llamar la función pasamos valores a los parámetros usando estas
keywords:</p>
<div class="codewrapper sourceCode" id="cb37">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>start,end <span class="op">=</span> yearly_data_arg_test (surveys_df)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Default values:</span><span class="ch">\t\t\t</span><span class="st">'</span>, start, end)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>start,end <span class="op">=</span> yearly_data_arg_test (surveys_df, <span class="dv">1988</span>, <span class="dv">1993</span>)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'No keywords:</span><span class="ch">\t\t\t</span><span class="st">'</span>, start, end)</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>start,end <span class="op">=</span> yearly_data_arg_test (surveys_df, start_year <span class="op">=</span> <span class="dv">1988</span>, end_year <span class="op">=</span> <span class="dv">1993</span>)</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Both keywords, in order:</span><span class="ch">\t</span><span class="st">'</span>, start, end)</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>start,end <span class="op">=</span> yearly_data_arg_test (surveys_df, end_year <span class="op">=</span> <span class="dv">1993</span>, start_year <span class="op">=</span> <span class="dv">1988</span>)</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Both keywords, flipped:</span><span class="ch">\t\t</span><span class="st">'</span>, start, end)</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>start,end <span class="op">=</span> yearly_data_arg_test (surveys_df, start_year <span class="op">=</span> <span class="dv">1988</span>)</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'One keyword, default end:</span><span class="ch">\t</span><span class="st">'</span>, start, end)</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>start,end <span class="op">=</span> yearly_data_arg_test (surveys_df, end_year <span class="op">=</span> <span class="dv">1993</span>)</span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'One keyword, default start:</span><span class="ch">\t</span><span class="st">'</span>, start, end)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Default values:		1977 2002
No keywords:		1988 1993
Both keywords, in order:	1988 1993
Both keywords, flipped:	1988 1993
One keyword, default end:	1988 2002
One keyword, default start:	1977 1993</code></pre>
</div>
<div id="desafío---modificando-funciones" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="desafío---modificando-funciones" class="callout-inner">
<h3 class="callout-title">Desafío - Modificando funciones<a class="anchor" aria-label="anchor" href="#desaf%C3%ADo---modificando-funciones"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li><p>Reescribe las funciones <code>one_year_csv_writer</code> y
<code>yearly_data_csv_writer</code> para que tengan argumentos keyword
con valores por defecto.</p></li>
<li><p>Modifica las funciones de tal forma que no creen archivos para un
año si éste no está en los datos y que muestre una alerta al usuario
(Pista: usa condicionales para esto. Si quieres un reto más, ¡usa
<code>try</code>!)</p></li>
<li><p>Este código verifica si un directorio existe, sino lo crea. Añade
un poco de código a la función que escribe los archivos CSV para
verificar si existe el directorio al que piensas escribir.</p></li>
</ol>
<div class="codewrapper sourceCode" id="cb39">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="st">'dir_name_here'</span> <span class="kw">in</span> os.listdir(<span class="st">'.'</span>):</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>   <span class="bu">print</span>(<span class="st">'Processed directory exists'</span>)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>   os.mkdir(<span class="st">'dir_name_here'</span>)</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>   <span class="bu">print</span>(<span class="st">'Processed directory created'</span>)</span></code></pre>
</div>
<ol start="4" style="list-style-type: decimal">
<li>El código que has escrito hasta este momento usando el bucle
<strong>for</strong> está bastante bien, pero no necesariamente es
reproducible con <strong>datasets</strong> diferentes. Por ejemplo, ¿qué
pasa con el código si tenemos datos para más años? Usando las
herramientas que aprendiste en las actividades anteriores, crea una
lista de todos los años representados en los datos. Después crea un
bucle para procesar tu información, comenzando desde el primer año y
terminando en el último usando la lista. (Pista: puedes crear un bucle
con la lista así: <code>for years in year_list:</code>)</li>
</ol>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Keypoints<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Los bucles nos permiten repetir una serie de acciones un número dado
de veces o mientras una condición es cierta.</li>
<li>Podemos automatizar tareas que se deben repetir un número
predefinido de veces utilizando bucles <code>for</code>.</li>
<li>Una tarea de automatización típica en programación es generar
secuencias de archivos con nombres distinos que siguen un patrón, esto
se puede realizar fácilmente manipulando cadenas de caracteres con el
nombre de los archivos dentro de bucles de repetición a medida que se
van creando.</li>
<li>Es conveniente definir funciones para establecer bloques de código
reutilizables. Las funciones se pueden diseñar para que acepten
argumentos de entradas para generalizar su funcionalidad y devolver
distintos tipos de resultados.</li>
<li>Las sentencias <code>if</code> permiten elegir cuales bloques de
código ejecutar según según se cumplan o no distintas condiciones.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-07-visualization-ggplot-python"><p>Content from <a href="07-visualization-ggplot-python.html">Creando gráficos con plotnine</a></p>
<hr>
<p> Last updated on 2023-02-07 | 
        
        <a href="https://github.com/datacarpentry/python-ecology-lesson-es/edit/main/episodes/07-visualization-ggplot-python.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="section level3">
<h3 id="nota">Nota<a class="anchor" aria-label="anchor" href="#nota"></a>
</h3>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>¿Cómo puedo visualizar datos en Python?</li>
<li>¿Qué es la ‘gramática de gráficos’?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Crear un objeto <code>plotnine</code>.</li>
<li>Establecer configuraciones para gráficos.</li>
<li>Modificar un objeto <code>plotnine</code> existente.</li>
<li>Cambiar la estética de un gráfico, como el color.</li>
<li>Editar las etiquetas de los ejes.</li>
<li>Construir gráficos complejos paso a paso.</li>
<li>Crear gráficos de dispersión, gráficos de caja y gráficos de
series.</li>
<li>Usar los comandos <code>facet_wrap</code> y <code>facet_grid</code>
para crear una colección de gráficos que dividen los datos por una
variable categórica.</li>
<li>Crear estilos personalizados para tus gráficos.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>Python tiene muy buenos recursos para crear gráficos incorporados en
el paquete <code>matplotlib</code>, pero para éste episodio,
utilizaremos el paquete [<code>plotnine</code>] (<a href="https://plotnine.readthedocs.io/en/stable/" class="external-link">https://plotnine.readthedocs.io/en/stable/</a>),
que facilita la creación de gráficos informativos usando datos
estructurados. El paquete <code>plotnine</code> está basado en la
implementación R de <a href="https://ggplot2.org/" class="external-link"><code>ggplot2</code></a> y <a href="https://link.springer.com/book/10.1007%2F0-387-28695-0" class="external-link">La
gramática de gráficos</a> por Leland Wilkinson. Además el paquete <a href="https://plotnine.readthedocs.io/en/stable/" class="external-link"><code>plotnine</code></a>
está construido sobre <code>matplotlib</code> e interactúa bien con
<code>Pandas</code>.</p>
<p>Al igual que con los otros paquetes, <code>plotnine</code> necesita
ser importado. Es bueno practicar usando una abreviatura como usamos
<code>pd</code> para <code>Pandas</code>:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>matplotlib inline</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotnine <span class="im">as</span> p9</span></code></pre>
</div>
<p>Desde ahora todas las funciones de <code>plotnine</code> se pueden
acceder usando <code>p9.</code> por delante.</p>
<p>Para los ejercicios usaremos los datos de <code>surveys.csv</code>
descartando los valores <code>NA</code>.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>surveys_complete <span class="op">=</span> pd.read_csv(<span class="st">'data/surveys.csv'</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>surveys_complete <span class="op">=</span> surveys_complete.dropna()</span></code></pre>
</div>
</div>
<section id="creando-gráficos-con-plotnine"><h2 class="section-heading">Creando gráficos con plotnine<a class="anchor" aria-label="anchor" href="#creando-gr%C3%A1ficos-con-plotnine"></a>
</h2>
<hr class="half-width">
<p>El paquete <code>plotnine</code> (es parte de <a href="https://link.springer.com/book/10.1007%2F0-387-28695-0" class="external-link">La
gramática de gráficos</a>) se usa para la creación de gráficos complejos
a partir de los datos en un <code>DataFrame</code>. Utiliza
configuraciones por defecto que ayudan a crear gráficos con calidad de
publicación con unos pocos ajustes.</p>
<p>Los gráficos <code>plotnine</code> se construyen paso a paso
agregando nuevos elementos uno encima del otro usando el operador
<code>+</code>. Poniendo cada paso entre paréntesis <code>()</code>
proporciona una sintaxis compatible con Python.</p>
<p>Para construir un gráfico <code>plotnine</code> necesitamos:</p>
<ul>
<li>Conectar el gráfico a un <code>DataFrame</code> específico usando el
argumento <code>data</code>:</li>
</ul>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>(p9.ggplot(data<span class="op">=</span>surveys_complete))</span></code></pre>
</div>
<p>Como no hemos definido nada más, sólo se presenta un marco vacío para
el gráfico.</p>
<ul>
<li>Define las opciones del gráfico usando <code>mapping</code> y
estéticas <code>aes</code>, para <strong>seleccionar las
variables</strong> que quieres mostrar en el gráfico, y definir la
presentación de estas variables, como tamaño, color, forma, etc. Las
ésteticas más importantes son: <code>x</code>,<code>y</code>,
<code>alpha</code>,<code>color</code> o <code>colour</code>,
<code>fill</code>,<code>linetype</code>,
<code>shape</code>,<code>size</code> y <code>stroke</code>.</li>
</ul>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>(p9.ggplot(data<span class="op">=</span>surveys_complete,</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>           mapping<span class="op">=</span>p9.aes(x<span class="op">=</span><span class="st">'weight'</span>, y<span class="op">=</span><span class="st">'hindfoot_length'</span>)))</span></code></pre>
</div>
<ul>
<li>Todavía no tenemos un gráfico, primero tenemos que definir qué tipo
de geometría utilizar. Puedes interpretar ésto como: las variables que
se usan en el gráfico son las que serán modificadas por objetos o
geometrías. Lo más sencillo es probablemente usar puntos.
<code>geom_point</code> es una de las opciones de geometría
<code>geoms</code>, que define la representación gráfica de los datos.
Otras geometrías son <code>geom_line</code>, <code>geom_bar</code>, etc.
Para agregar un <code>geom</code> al gráfico usa el símbolo
<code>+</code>:</li>
</ul>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>(p9.ggplot(data<span class="op">=</span>surveys_complete,</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>           mapping<span class="op">=</span>p9.aes(x<span class="op">=</span><span class="st">'weight'</span>, y<span class="op">=</span><span class="st">'hindfoot_length'</span>))</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.geom_point()</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>)</span></code></pre>
</div>
<p>El símbolo <code>+</code> en el paquete <code>plotnine</code> es
particularmente útil porque te permite modificar los objetos
<code>plotnine</code> existentes. Esto significa que puedes configurar
fácilmente el gráfico con <em>plantillas</em> y explorar
convenientemente diferentes tipos de gráficos. El gráfico anterior
también se puede generar con código como este:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Crea un marco para el gráfico definiendo las variables</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>surveys_plot <span class="op">=</span> p9.ggplot(data<span class="op">=</span>surveys_complete,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>                         mapping<span class="op">=</span>p9.aes(x<span class="op">=</span><span class="st">'weight'</span>, y<span class="op">=</span><span class="st">'hindfoot_length'</span>))</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Dibuja los puntos en el marco</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>surveys_plot <span class="op">+</span> p9.geom_point()</span></code></pre>
</div>
<figure><img src="fig/06_first_plot.png" alt="Gráfica de distribución de la longitud de las patas de animales contra su peso donde los puntos están aglomerados en el cuadrante inferior izquierdo" class="figure mx-auto d-block"></figure><div id="desafío---gráfico-de-barras" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="desafío---gráfico-de-barras" class="callout-inner">
<h3 class="callout-title">Desafío - gráfico de barras<a class="anchor" aria-label="anchor" href="#desaf%C3%ADo---gr%C3%A1fico-de-barras"></a>
</h3>
<div class="callout-content">
<p>Trabajando con los datos de <code>survey_complete</code>, usa la
columna <code>plot-id</code> para crear un gráfico de barras
<code>geom_bar</code> que cuente el número de registros para cada
parcela. (Mira la documentación de la geometría de barras para manejar
los conteos).</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">
  Respuestas
  </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>(p9.ggplot(data<span class="op">=</span>surveys_complete,</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>           mapping<span class="op">=</span>p9.aes(x<span class="op">=</span><span class="st">'plot_id'</span>))</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.geom_bar()</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>)</span></code></pre>
</div>
<figure><img src="fig/06_challenge_bar.png" alt="png" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
<p>Notas:</p>
<ul>
<li>Cualquier ajuste en la función <code>ggplot()</code> se visualiza en
las capas del gráfico (por ejemplo, las configuraciones universales).
Esto incluye los ejes <code>x</code> y <code>y</code> que configuraste
en las capa de estéticas <code>aes()</code>.</li>
<li>También puedes especificar estéticas individuales para cada
<code>geom</code> independientemente de las estéticas definidas
globalmente en la función <code>ggplot()</code>.</li>
</ul></section><section id="construyendo-tus-gráficos-de-forma-iterativa"><h2 class="section-heading">Construyendo tus gráficos de forma iterativa<a class="anchor" aria-label="anchor" href="#construyendo-tus-gr%C3%A1ficos-de-forma-iterativa"></a>
</h2>
<hr class="half-width">
<p>La construcción de gráficos con <code>plotnine</code> es típicamente
un proceso iterativo. Empezamos definiendo el conjunto de datos que
usaremos, colocaremos los ejes y elegiremos una geometría. Por lo tanto,
los elementos mínimos de cualquier gráfico son
<code>data</code>,<code>aes</code> y <code>geom-*</code>:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>(p9.ggplot(data<span class="op">=</span>surveys_complete,</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>           mapping<span class="op">=</span>p9.aes(x<span class="op">=</span><span class="st">'weight'</span>, y<span class="op">=</span><span class="st">'hindfoot_length'</span>))</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.geom_point()</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>)</span></code></pre>
</div>
<p>Luego, comenzamos a modificar este gráfico para extraer más
información. Por ejemplo, podemos agregar transparencia
(<code>alfa</code>) para evitar la obstrucción visual por aglomeración
de puntos:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>(p9.ggplot(data<span class="op">=</span>surveys_complete,</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>           mapping<span class="op">=</span>p9.aes(x<span class="op">=</span><span class="st">'weight'</span>, y<span class="op">=</span><span class="st">'hindfoot_length'</span>))</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.geom_point(alpha<span class="op">=</span><span class="fl">0.1</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>)</span></code></pre>
</div>
<figure><img src="fig/06_alpha_plot.png" alt="Gráfica de distribución de la longitud de las patas de animales contra su peso donde los puntos tienen transparencia para evitar la aglomeración" class="figure mx-auto d-block"></figure><p>¡También puedes agregar color a los puntos!</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>(p9.ggplot(data<span class="op">=</span>surveys_complete,</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>           mapping<span class="op">=</span>p9.aes(x<span class="op">=</span><span class="st">'weight'</span>, y<span class="op">=</span><span class="st">'hindfoot_length'</span>))</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.geom_point(alpha<span class="op">=</span><span class="fl">0.1</span>, color<span class="op">=</span><span class="st">'blue'</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>)</span></code></pre>
</div>
<figure><img src="fig/06_blue_plot.png" alt="Gráfica de distribución de la longitud de las patas de animales contra su peso donde los puntos son azules" class="figure mx-auto d-block"></figure><p>Si quieres usar un color diferente para cada especie, tienes que
conectar la columna <code>species_id</code> con la estética del
color:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>(p9.ggplot(data<span class="op">=</span>surveys_complete,</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>           mapping<span class="op">=</span>p9.aes(x<span class="op">=</span><span class="st">'weight'</span>,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>                          y<span class="op">=</span><span class="st">'hindfoot_length'</span>,</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>                          color<span class="op">=</span><span class="st">'species_id'</span>))</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.geom_point(alpha<span class="op">=</span><span class="fl">0.1</span>)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre>
</div>
<figure><img src="fig/06_color_plot.png" alt="png" class="figure mx-auto d-block"></figure><p>Aparte de las configuraciones en los argumentos <code>data</code>,
<code>aes</code> y los elementos <code>geom-*</code>, también se pueden
agregar elementos adicionales, usando el signo <code>+</code>:</p>
<ul>
<li>Cambiando las etiquetas:</li>
</ul>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>(p9.ggplot(data<span class="op">=</span>surveys_complete,</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>           mapping<span class="op">=</span>p9.aes(x<span class="op">=</span><span class="st">'weight'</span>, y<span class="op">=</span><span class="st">'hindfoot_length'</span>, color<span class="op">=</span><span class="st">'species_id'</span>))</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.geom_point(alpha<span class="op">=</span><span class="fl">0.1</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.xlab(<span class="st">"Weight (g)"</span>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre>
</div>
<figure><img src="fig/06_color_label_plot.png" alt="png" class="figure mx-auto d-block"></figure><ul>
<li>Puedes también cambiar las escalas para colores, ejes…. Por ejemplo,
una versión del gráfico anterior usando el logarítmo de los números en
el eje x podría ayudar a una mejor interpretación de los números más
pequeños:</li>
</ul>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>(p9.ggplot(data<span class="op">=</span>surveys_complete,</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>           mapping<span class="op">=</span>p9.aes(x<span class="op">=</span><span class="st">'weight'</span>, y<span class="op">=</span><span class="st">'hindfoot_length'</span>, color<span class="op">=</span><span class="st">'species_id'</span>))</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.geom_point(alpha<span class="op">=</span><span class="fl">0.1</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.xlab(<span class="st">"Weight (g)"</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.scale_x_log10()</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre>
</div>
<figure><img src="fig/06_log_plot.png" alt="png" class="figure mx-auto d-block"></figure><ul>
<li>También puedes escoger un tema (<code>theme_*</code>) o algunos
elementos específicos del tema (<code>theme</code>). Por lo general, los
gráficos con fondo blanco parecen más legibles cuando se imprimen.
Entonces, podemos configurar el fondo a blanco usando la función
<code>theme_bw()</code> y cambiar el tamaño del texto con
<code>theme()</code>.</li>
</ul>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>(p9.ggplot(data<span class="op">=</span>surveys_complete,</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>           mapping<span class="op">=</span>p9.aes(x<span class="op">=</span><span class="st">'weight'</span>, y<span class="op">=</span><span class="st">'hindfoot_length'</span>, color<span class="op">=</span><span class="st">'species_id'</span>))</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.geom_point(alpha<span class="op">=</span><span class="fl">0.1</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.xlab(<span class="st">"Weight (g)"</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.scale_x_log10()</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.theme_bw()</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.theme(text<span class="op">=</span>p9.element_text(size<span class="op">=</span><span class="dv">16</span>))</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>)</span></code></pre>
</div>
<figure><img src="fig/06_white_plot.png" alt="png" class="figure mx-auto d-block"></figure><div id="desafío---retocando-un-gráfico-de-barras" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="desafío---retocando-un-gráfico-de-barras" class="callout-inner">
<h3 class="callout-title">Desafío - retocando un gráfico de barras<a class="anchor" aria-label="anchor" href="#desaf%C3%ADo---retocando-un-gr%C3%A1fico-de-barras"></a>
</h3>
<div class="callout-content">
<p>Usa el código del ejercicio anterior y cambia la estética de color
por la variable <code>sex</code>, también cambia la geometría para tener
un gráfico de barras, finalmente, cambia la escala <code>scale</code>
del color de relleno para que tengas una barra azul y una naranja usando
<code>blue</code> y <code>orange</code> (mira este link en inglés de la
referencia <a href="https://plotnine.readthedocs.io/en/stable/api.html#Color-and-fill-scales" class="external-link">API
reference plotnine</a> para encontrar la función que necesitas).</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">
  Respuestas
  </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>(p9.ggplot(data<span class="op">=</span>surveys_complete,</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>           mapping<span class="op">=</span>p9.aes(x<span class="op">=</span><span class="st">'plot_id'</span>,</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>                          fill<span class="op">=</span><span class="st">'sex'</span>))</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.geom_bar()</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.scale_fill_manual([<span class="st">"blue"</span>, <span class="st">"orange"</span>])</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre>
</div>
<figure><img src="fig/06_challenge_color_bar.png" alt="png" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
</section><section id="gráficos-de-distribuciones"><h2 class="section-heading">Gráficos de distribuciones<a class="anchor" aria-label="anchor" href="#gr%C3%A1ficos-de-distribuciones"></a>
</h2>
<hr class="half-width">
<p>Visualizar una distribución de datos es una tarea común en el
análisis y exploración de datos. Por ejemplo, para visualizar la
distribución de datos de la columna <code>weight</code> por cada especie
<code>species_id</code>, puedes usar una gráfica de caja:</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>(p9.ggplot(data<span class="op">=</span>surveys_complete,</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>           mapping<span class="op">=</span>p9.aes(x<span class="op">=</span><span class="st">'species_id'</span>,</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>                          y<span class="op">=</span><span class="st">'weight'</span>))</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.geom_boxplot()</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre>
</div>
<figure><img src="fig/06_boxplot.png" alt="png" class="figure mx-auto d-block"></figure><p>Agregando los puntos a la gráfica de caja nos dá una mejor idea de la
distribución de las observaciones:</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>(p9.ggplot(data<span class="op">=</span>surveys_complete,</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>           mapping<span class="op">=</span>p9.aes(x<span class="op">=</span><span class="st">'species_id'</span>,</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>                          y<span class="op">=</span><span class="st">'weight'</span>))</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.geom_jitter(alpha<span class="op">=</span><span class="fl">0.2</span>)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.geom_boxplot(alpha<span class="op">=</span><span class="fl">0.</span>)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre>
</div>
<figure><img src="fig/06_point_boxplot.png" alt="png" class="figure mx-auto d-block"></figure><div id="desafío---distribuciones" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="desafío---distribuciones" class="callout-inner">
<h3 class="callout-title">Desafío - distribuciones<a class="anchor" aria-label="anchor" href="#desaf%C3%ADo---distribuciones"></a>
</h3>
<div class="callout-content">
<p>Los gráficos de caja son resúmenes útiles, pero ocultan la
<em>forma</em> de la distribución. Por ejemplo, si hay una distribución
bimodal, esto no se observaría con un gráfico de caja. Una alternativa
al gráfico de caja es el gráfico de violín, donde se dibuja la forma (de
la densidad de los puntos).</p>
<p>Al visualizar datos, es importante considerar la <em>escala</em> de
la observaciones. Por ejemplo, puede valer la pena cambiar la escala del
eje para distribuir mejor las observaciones en el espacio.</p>
<ul>
<li>Reemplaza el gráfico de caja con uno de violín, mira
<code>geom_violin()</code>
</li>
<li>Transforma la columna <code>weight</code> a la escala log10, mira
<code>scale_y_log10()</code>
</li>
<li>Agrega color a los puntos en tu gráfico de acuerdo a la parcela
donde la muestra fue tomada (<code>plot_id</code>).</li>
</ul>
<p>Sugerencia: Primero comprueba la clase de <code>plot_id</code>. Si
usas <code>factor()</code> dentro de la estética <code>aes</code>,
<code>plotnine</code> manejará los valores como categorías.</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3">
  Respuestas
  </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>(p9.ggplot(data<span class="op">=</span>surveys_complete,</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>           mapping<span class="op">=</span>p9.aes(x<span class="op">=</span><span class="st">'species_id'</span>,</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>                          y<span class="op">=</span><span class="st">'weight'</span>,</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>                          color<span class="op">=</span><span class="st">'factor(plot_id)'</span>))</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.geom_jitter(alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.geom_violin(alpha<span class="op">=</span><span class="dv">0</span>, color<span class="op">=</span><span class="st">"0.7"</span>)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.scale_y_log10()</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>)</span></code></pre>
</div>
<figure><img src="fig/06_challenge_boxplot.png" alt="png" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
</section><section id="gráficos-de-series"><h2 class="section-heading">Gráficos de series<a class="anchor" aria-label="anchor" href="#gr%C3%A1ficos-de-series"></a>
</h2>
<hr class="half-width">
<p>Calculemos el número de cada tipo de especie por año. Para esto
primero tenemos que agrupar las especies (<code>species_id</code>) por
cada año <code>year</code>.</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>yearly_counts <span class="op">=</span> surveys_complete.groupby([<span class="st">'year'</span>, <span class="st">'species_id'</span>])[<span class="st">'species_id'</span>].count()</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>yearly_counts</span></code></pre>
</div>
<p>Cuando revisamos los resultados del cálculo anterior, vemos que
<code>year</code> y <code>species_id</code> son índices de filas.
Podemos cambiar este indice para que sean usados como una variable de
columnas:</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>yearly_counts <span class="op">=</span> yearly_counts.reset_index(name<span class="op">=</span><span class="st">'counts'</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>yearly_counts</span></code></pre>
</div>
<p>Los gráficos de series se pueden visualizar usando líneas
(<code>geom_line</code>) con años en el eje <code>x</code> y el conteo
en el eje <code>y</code>.</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>(p9.ggplot(data<span class="op">=</span>yearly_counts,</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>           mapping<span class="op">=</span>p9.aes(x<span class="op">=</span><span class="st">'year'</span>,</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>                          y<span class="op">=</span><span class="st">'counts'</span>))</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.geom_line()</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre>
</div>
<p>Desafortunadamente eso no funciona, porque nos muestra todas las
especies juntas. Tenemos que especificar que queremos una línea para
cada especie. Esto se modifica en la función de estética conectando el
color con la variable <code>species_id</code>:</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>(p9.ggplot(data<span class="op">=</span>yearly_counts,</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>           mapping<span class="op">=</span>p9.aes(x<span class="op">=</span><span class="st">'year'</span>,</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>                          y<span class="op">=</span><span class="st">'counts'</span>,</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>                          color<span class="op">=</span><span class="st">'species_id'</span>))</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.geom_line()</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre>
</div>
<figure><img src="fig/06_time_plot.png" alt="png" class="figure mx-auto d-block"></figure></section><section id="facetas"><h2 class="section-heading">Facetas<a class="anchor" aria-label="anchor" href="#facetas"></a>
</h2>
<hr class="half-width">
<p>Como cualquier biblioteca que maneje la gramática de gráficos,
<code>plotnine</code> tiene una técnica especial denominada
<em>faceting</em> que permite dividir el gráfico en múltiples gráficos
en función de una categoría incluida en el conjunto de datos.</p>
<p>¿Recuerdas el gráfico de puntos que creaste antes, usando
<code>weight</code> y <code>hindfoot_length</code>?</p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>(p9.ggplot(data<span class="op">=</span>surveys_complete,</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>           mapping<span class="op">=</span>p9.aes(x<span class="op">=</span><span class="st">'weight'</span>,</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>                          y<span class="op">=</span><span class="st">'hindfoot_length'</span>,</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>                          color<span class="op">=</span><span class="st">'species_id'</span>))</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.geom_point(alpha<span class="op">=</span><span class="fl">0.1</span>)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre>
</div>
<p>Podemos reusar este mismo código y agregar una faceta con
<code>facet_wrap</code> en base a una categoría para dividir el gráfico
para cada uno de los grupos, por ejemplo, usando la variable
<code>sex</code>:</p>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>(p9.ggplot(data<span class="op">=</span>surveys_complete,</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>           mapping<span class="op">=</span>p9.aes(x<span class="op">=</span><span class="st">'weight'</span>,</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>                          y<span class="op">=</span><span class="st">'hindfoot_length'</span>,</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>                          color<span class="op">=</span><span class="st">'species_id'</span>))</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.geom_point(alpha<span class="op">=</span><span class="fl">0.1</span>)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.facet_wrap(<span class="st">"sex"</span>)</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>)</span></code></pre>
</div>
<figure><img src="fig/06_facet_plot.png" alt="png" class="figure mx-auto d-block"></figure><p>Ahora podemos aplicar el mismo concepto con cualquier categoría:</p>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>(p9.ggplot(data<span class="op">=</span>surveys_complete,</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>           mapping<span class="op">=</span>p9.aes(x<span class="op">=</span><span class="st">'weight'</span>,</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>                          y<span class="op">=</span><span class="st">'hindfoot_length'</span>,</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>                          color<span class="op">=</span><span class="st">'species_id'</span>))</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.geom_point(alpha<span class="op">=</span><span class="fl">0.1</span>)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.facet_wrap(<span class="st">"plot_id"</span>)</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>)</span></code></pre>
</div>
<figure><img src="fig/06_facet_all_plot.png" alt="png" class="figure mx-auto d-block"></figure><p>La capa de facetas <code>facet_wrap</code> divide los gráficos
arbitrariamente para que entren sin problemas en una hoja. Por otro lado
si quieres definir explícitamente la distribución de los gráficos usa
<code>facet_grid</code> con una fórmula (<code>rows ~ columns</code>) un
punto <code>.</code> indica que es sólo una fila o una columna.</p>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Selecciona unos años que te interesen</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>survey_2000 <span class="op">=</span> surveys_complete[surveys_complete[<span class="st">"year"</span>].isin([<span class="dv">2000</span>, <span class="dv">2001</span>])]</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>(p9.ggplot(data<span class="op">=</span>survey_2000,</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>           mapping<span class="op">=</span>p9.aes(x<span class="op">=</span><span class="st">'weight'</span>,</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>                          y<span class="op">=</span><span class="st">'hindfoot_length'</span>,</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>                          color<span class="op">=</span><span class="st">'species_id'</span>))</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.geom_point(alpha<span class="op">=</span><span class="fl">0.1</span>)</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.facet_grid(<span class="st">"year ~ sex"</span>)</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>)</span></code></pre>
</div>
<figure><img src="fig/06_select_plot.png" alt="png" class="figure mx-auto d-block"></figure><div id="desafío---facetas-1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="desafío---facetas-1" class="callout-inner">
<h3 class="callout-title">Desafío - facetas 1<a class="anchor" aria-label="anchor" href="#desaf%C3%ADo---facetas-1"></a>
</h3>
<div class="callout-content">
<p>Crea un gráfico separado por cada especie, que muestre como el peso
medio de las especies cambia por año.</p>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4">
  Respuestas
  </h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" aria-labelledby="headingSolution4" data-bs-parent="#accordionSolution4">
<div class="accordion-body">
<p>yearly_weight = surveys_complete.groupby([‘year’,
‘species_id’])[‘weight’].mean().reset_index()</p>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>(p9.ggplot(data<span class="op">=</span>yearly_weight,</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>           mapping<span class="op">=</span>p9.aes(x<span class="op">=</span><span class="st">'year'</span>,</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>                          y<span class="op">=</span><span class="st">'weight'</span>))</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.geom_line()</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.facet_wrap(<span class="st">"species_id"</span>)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="desafío---facetas-2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="desafío---facetas-2" class="callout-inner">
<h3 class="callout-title">Desafío - facetas 2<a class="anchor" aria-label="anchor" href="#desaf%C3%ADo---facetas-2"></a>
</h3>
<div class="callout-content">
<p>Usando el código del ejercicio anterior, compara visualmente como los
pesos de machos y hembras van cambiando en el tiempo. Crea un gráfico
separado por cada <code>sex</code> que use un color diferente por cada
especie <code>species_id</code>.</p>
</div>
</div>
</div>
<div id="accordionSolution5" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution5" aria-expanded="false" aria-controls="collapseSolution5">
  <h4 class="accordion-header" id="headingSolution5">
  Respuestas
  </h4>
</button>
<div id="collapseSolution5" class="accordion-collapse collapse" aria-labelledby="headingSolution5" data-bs-parent="#accordionSolution5">
<div class="accordion-body">
<p>yearly_weight = surveys_complete.groupby([‘year’, ‘species_id’,
‘sex’])[‘weight’].mean().reset_index()</p>
<p>(p9.ggplot(data=yearly_weight, mapping=p9.aes(x=‘year’, y=‘weight’,
color=‘species_id’)) + p9.geom_line() + p9.facet_wrap(“sex”) ) {:
.language-python}</p>
</div>
</div>
</div>
</div>
</section><section id="más-retoques"><h2 class="section-heading">Más retoques<a class="anchor" aria-label="anchor" href="#m%C3%A1s-retoques"></a>
</h2>
<hr class="half-width">
<p>Como la sintaxis de <code>plotnine</code> sigue la versión original
del paquete de R <code>ggplot2</code>, la documentación de
<code>ggplot2</code> te dá mas información e inspiración para retocar
tus gráficos. Mira la hoja resumen de <code>ggplot2</code> <a href="https://www.rstudio.com/wp-content/uploads/2015/08/ggplot2-cheatsheet.pdf" class="external-link">cheat
sheet</a>, y piensa de que maneras puedes mejorar el gráfico. Puedes
escribir tus ideas y comentarios en el Etherpad.</p>
<p>Las opciones temáticas nos proveen una gran variedad de adaptaciones
visuales. Usa el siguiente ejemplo de un gráfico de barras que presenta
las observaciones por año.</p>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>(p9.ggplot(data<span class="op">=</span>surveys_complete,</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>           mapping<span class="op">=</span>p9.aes(x<span class="op">=</span><span class="st">'factor(year)'</span>))</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.geom_bar()</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>)</span></code></pre>
</div>
<figure><img src="fig/06_overlap_bars.png" alt="png" class="figure mx-auto d-block"></figure><p>Aquí hemos usado el año <code>year</code> como una categoría usando
la función <code>factor</code>. Pero al hacer esto, las etiquetas de los
años se sobreponen. Usando una opción <code>theme</code> podemos rotar
las etiquetas en el eje x:</p>
<div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>(p9.ggplot(data<span class="op">=</span>surveys_complete,</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>           mapping<span class="op">=</span>p9.aes(x<span class="op">=</span><span class="st">'factor(year)'</span>))</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.geom_bar()</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.theme_bw()</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.theme(axis_text_x <span class="op">=</span> p9.element_text(angle<span class="op">=</span><span class="dv">90</span>))</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre>
</div>
<figure><img src="fig/06_good_bars.png" alt="png" class="figure mx-auto d-block"></figure><p>Cuando encuentres las opciones de visualización que te agraden y
forman parte del tema, puedes guardar estas opciones en un objeto para
luego reusarlo en los próximos gráficos que vayas a crear.</p>
<div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>my_custom_theme <span class="op">=</span> p9.theme(axis_text_x <span class="op">=</span> p9.element_text(color<span class="op">=</span><span class="st">'grey'</span>, size<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>                                                         angle<span class="op">=</span><span class="dv">90</span>, hjust<span class="op">=</span><span class="fl">.5</span>),</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>                           axis_text_y <span class="op">=</span> p9.element_text(color<span class="op">=</span><span class="st">'grey'</span>, size<span class="op">=</span><span class="dv">10</span>))</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>(p9.ggplot(data<span class="op">=</span>surveys_complete,</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>           mapping<span class="op">=</span>p9.aes(x<span class="op">=</span><span class="st">'factor(year)'</span>))</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.geom_bar()</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> my_custom_theme</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>)</span></code></pre>
</div>
<figure><img src="fig/06_theme_plot.png" alt="png" class="figure mx-auto d-block"></figure><blockquote>
<h3 id="desafío---hecho-a-medida">Desafío - hecho a medida</h3>
</blockquote>
<p>Tómate otros cinco minutos para mejorar uno de los gráficos
anteriores, o crea un nuevo gráfico hecho a medida, con los retoques que
quieras.</p>
<div id="discussion1" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge<a class="anchor" aria-label="anchor" href="#discussion1"></a>
</h3>
<div class="callout-content">
<p>Aquí hay algunas ideas:</p>
<ul>
<li>Intenta cambiar el grosor de las lineas en el gráfico de línea.</li>
<li>¿Podrías cambiar la leyenda y sus etiquetas?</li>
<li>Usa una paleta de colores nueva (mira las opciones aquí <a href="https://www.cookbook-r.com/Graphs/Colors_(ggplot2)/" class="external-link">http://www.cookbook-r.com/Graphs/Colors_(ggplot2)/</a>)</li>
</ul>
</div>
</div>
</div>
<p>Después de crear tu nuevo gráfico, puedes guardarlo en diferentes
formatos. También puedes cambiar las dimensiones, la resolución usando
<code>width</code>, <code>height</code> and <code>dpi</code>:</p>
<div class="codewrapper sourceCode" id="cb31">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>my_plot <span class="op">=</span> (p9.ggplot(data<span class="op">=</span>surveys_complete,</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>           mapping<span class="op">=</span>p9.aes(x<span class="op">=</span><span class="st">'weight'</span>, y<span class="op">=</span><span class="st">'hindfoot_length'</span>))</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.geom_point()</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>my_plot.save(<span class="st">"scatterplot.png"</span>, width<span class="op">=</span><span class="dv">10</span>, height<span class="op">=</span><span class="dv">10</span>, dpi<span class="op">=</span><span class="dv">300</span>)</span></code></pre>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Keypoints<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Las variables <code>data</code>, <code>aes</code> y
<code>geometry</code> son los elementos principales de un gráfico de
<code>plotnine</code>.</li>
<li>Con el operador <code>+</code>, se agregan elementos adicionales al
gráfico, por ejemplo <code>scale_*</code>, <code>theme_*</code>,
<code>xlab</code>, <code>ylab</code> y <code>facet_*</code>.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-08-putting-it-all-together"><p>Content from <a href="08-putting-it-all-together.html">Entrada de datos y visualización - Matplotlib y Pandas</a></p>
<hr>
<p> Last updated on 2023-02-07 | 
        
        <a href="https://github.com/datacarpentry/python-ecology-lesson-es/edit/main/episodes/08-putting-it-all-together.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<section id="resumiendo"><h2 class="section-heading">Resumiendo<a class="anchor" aria-label="anchor" href="#resumiendo"></a>
</h2>
<hr class="half-width">
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>¿Qué otras herramientas aparte de ggplot puedo usar para crear
gráficos?</li>
<li>¿Por qué usar Python para crear gráficos?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Importar herramientas de pyplot para crear figuras en Python.</li>
<li>Usar matplotlib para ajustar objetos de Pandas o plotnine.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>Hasta aquí, hemos repasado las tareas que se suelen llevar a cabo en
el manejo y procesamiento de datos utilizando los archivos limpios que
hemos proporcionado en el taller. En este ejercicio de repaso final,
realizaremos muchas de las tareas que hemos visto pero con
<strong>datasets</strong> reales. Esta lección también incluye
visualización de datos.</p>
<p>A diferencia de las anteriores, en esta lección no se dan
instrucciones paso a paso para realizar cada una de las tareas. Usa los
materiales de las lecciones que ya has estudiado, así como la
documentación de Python.</p>
</section><section id="obtener-datos"><h2 class="section-heading">Obtener datos<a class="anchor" aria-label="anchor" href="#obtener-datos"></a>
</h2>
<hr class="half-width">
<p>Hay muchos repositorios en línea desde los cuales puedes obtener
datos. Te proporcionamos un archivo de datos para usar con estos
ejercicios, pero no dudes en utilizar cualquier conjunto de datos que
encuentres relevante para tu investigación. El archivo [<a href="data/bouldercreek_09_2013.txt">bouldercreek_09_2013.txt</a>
contiene datos sobre vertidos de agua, resumidos en 15 intervalos de 15
minutos (en pies cúbicos por segundo de una estación hidrométrica en
Boulder Creek en North 75th Street (USGS gage06730200 durante el periodo
1-30 de Septiembre de 2013. Si deseas usar este
<strong>dataset</strong>, lo encontrarás en la carpeta de datos.</p>
</section><section id="limpia-tus-datos-y-ábrelos-con-python-y-pandas"><h2 class="section-heading">Limpia tus datos y ábrelos con Python y Pandas<a class="anchor" aria-label="anchor" href="#limpia-tus-datos-y-%C3%A1brelos-con-python-y-pandas"></a>
</h2>
<hr class="half-width">
<p>Para empezar, importa tu archivo de datos a Python usando Pandas. ¿No
te funcionó? Puede que tu archivo de datos tenga un encabezado que
Pandas no reconozca como parte de la tabla. Elimina este encabezado,
¡pero no lo hagas borrándolo en un editor de texto! Usa la terminal o
Python para hacerlo; no quisieras tener que hacer esto a mano si
tuvieras muchos archivos por procesar.</p>
<p>Si aún tienes problemas para importar los datos como una tabla con
Pandas, consulta la documentación. Prueba a abrir la
<strong>docstring</strong> en un ipython notebook utilizando un signo de
interrogación. Por ejemplo:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>pd.read_csv?</span></code></pre>
</div>
<p>Fíjate en los argumentos de la función para ver si hay un valor
predeterminado que sea diferente al que requiere tu archivo (Sugerencia:
probablemente el problema sea el delimitador o separador. Los
delimitadores más comunes son <code>','</code> comas, <code>' '</code>
espacios, y <code>'\t'</code> tabulaciones).</p>
<p>Crea un <strong>DataFrame</strong> que incluya sólo los valores de
los datos que te sean útiles. En nuestro archivo de ejemplo de la
estación hidrométrica, esos valores podrían ser la fecha, la hora y las
mediciones de descarga o vertido. Convierte cualquier medida de unidades
imperiales a unidades SI. También puedes cambiar el nombre de las
columnas en el <strong>DataFrame</strong> del siguiente modo:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame({<span class="st">'1stcolumn'</span>:[<span class="dv">100</span>,<span class="dv">200</span>], <span class="st">'2ndcolumn'</span>:[<span class="dv">10</span>,<span class="dv">20</span>]}) <span class="co"># esto crea un __DataFrame__ para el ejemplo!</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'With the old column names:</span><span class="ch">\n</span><span class="st">'</span>) <span class="co"># El \n crea una nueva línea, para que sea más fácil de ver</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>df.columns <span class="op">=</span> [<span class="st">'FirstColumn'</span>,<span class="st">'SecondColumn'</span>] <span class="co"># renombra las columna!</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'</span><span class="ch">\n\n</span><span class="st">With the new column names:</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Con los nombres antiguos de las columnas:

   1stcolumn  2ndcolumn
0        100         10
1        200         20


Con los nuevos nombres de columna:

   FirstColumn  SecondColumn
0          100            10
1          200            20</code></pre>
</div>
</section><section id="el-paquete-matplotlib"><h2 class="section-heading">El paquete Matplotlib<a class="anchor" aria-label="anchor" href="#el-paquete-matplotlib"></a>
</h2>
<hr class="half-width">
<p><a href="https://matplotlib.org/" class="external-link">Matplotlib</a> es un paquete de
Python usado ampliamente por la comunidad científica de Python para
crear gráficos de alta calidad, listos para publicar. Admite una amplia
gama de formatos de gráficos rasterizados y vectoriales, tales como PNG,
PostScript, EPS, PDF y SVG.</p>
<p>Además, Matplotlib es el motor que hay detrás de las capacidades
gráficas de los paquetes Pandas y plotnine. Por ejemplo, cuando
invocamos el método <code>.plot</code> en objetos de datos Pandas, de
hecho estamos usando el paquete matplotlib.</p>
<p>Primero, importamos la caja de herramientas pyplot:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span></code></pre>
</div>
<p>¡Ahora leemos los datos y los representarlos en un gráfico!</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>surveys <span class="op">=</span> pd.read_csv(<span class="st">"data/surveys.csv"</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>my_plot <span class="op">=</span> surveys.plot(<span class="st">"hindfoot_length"</span>, <span class="st">"weight"</span>, kind<span class="op">=</span><span class="st">"scatter"</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>plt.show() <span class="co"># no necesariamente en Jupyter Notebooks</span></span></code></pre>
</div>
<figure><img src="fig/08_scatter_surveys.png" alt="Diagrama de dispersión del conjunto de datos de una encuesta" class="figure mx-auto d-block"></figure><div id="sugerencia" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="sugerencia" class="callout-inner">
<h3 class="callout-title">Sugerencia<a class="anchor" aria-label="anchor" href="#sugerencia"></a>
</h3>
<div class="callout-content">
<p>Por defecto, matplotlib crea una figura en una ventana separada.
Cuando usamos Jupyter notebooks, podemos hacer que las figuras aparezcan
en línea dentro del cuaderno; lo hacemos ejecutando:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>matplotlib inline</span></code></pre>
</div>
</div>
</div>
</div>
<p>El objeto que obtenemos es un objeto matplotlib (puedes verificarlo
tu mismo con <code>type(my_plot)</code>), al que podemos ajustarle y
realizarle mejoras adicionales utilizando otros métodos de
matplotlib.</p>
<div id="sugerencia-1" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="sugerencia-1" class="callout-inner">
<h3 class="callout-title">Sugerencia<a class="anchor" aria-label="anchor" href="#sugerencia-1"></a>
</h3>
<div class="callout-content">
<p>Matplotlib en sí mismo puede resultar algo abrumador, por lo que una
estrategia útil de entrada es hacer todo lo posible en capas de
conveniencia, <em>p.e.</em> empezar creando los gráficos en Pandas o
plotnine y luego usar matplotlib para el resto.</p>
</div>
</div>
</div>
<p>En esta lección cubriremos algunos comandos básicos para crear y
formatear gráficos con matplotlib. Un gran recurso para ayudarnos a
crear y agregar estilo a nuestras figuras es la galería matplotlib (<a href="https://matplotlib.org/gallery.html" class="external-link">http://matplotlib.org/gallery.html</a>),
la cual incluye gráficos en todo tipo de estilos junto con el código
fuente para crearlos.</p>
<div class="section level3">
<h3 id="plt-pyplot-vs-matplotlib-basado-en-objetos">
<code>plt</code> pyplot vs matplotlib basado en objetos<a class="anchor" aria-label="anchor" href="#plt-pyplot-vs-matplotlib-basado-en-objetos"></a>
</h3>
<p>Matplotlib se integra bien con el paquete NumPy y permite usar
<strong>arrays</strong> de NumPy como entrada para las funciones para
crear gráficos disponibles. Considera los siguientes datos de ejemplo,
creados con NumPy extrayendo 1000 muestras de una distribución normal
con un valor medio de 0 y una desviación estándar de 0.1:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>sample_data <span class="op">=</span> numpy.random.normal(<span class="dv">0</span>, <span class="fl">0.1</span>, <span class="dv">1000</span>)</span></code></pre>
</div>
<p>Para representar un histograma de la distribución normal, podemos
usar la función <code>hist</code> directamente:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>plt.hist(sample_data)</span></code></pre>
</div>
<figure><img src="fig/08-normal-distribution.png" alt="Histograma de 1000 muestras de una distribución normal" class="figure mx-auto d-block"></figure><div id="sugerencia-visualization-multiplataforma-de-figuras" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="sugerencia-visualization-multiplataforma-de-figuras" class="callout-inner">
<h3 class="callout-title">Sugerencia: Visualization multiplataforma de
Figuras<a class="anchor" aria-label="anchor" href="#sugerencia-visualization-multiplataforma-de-figuras"></a>
</h3>
<div class="callout-content">
<p>Los <strong>Jupyter Notebooks</strong> nos simplifican muchos
aspectos de nuestro análisis y de las visualizaciones. Por ejemplo,
hacen buena parte del trabajo de visualización por nosotros. Pero quizás
no todos tus colaboradores trabajan con <strong>Jupyter
Notebooks</strong>. El comando <code>.show()</code> te permite
visualizar los gráficos tanto si trabajas en la línea de comandos, con
un <strong>script</strong> o en el intérprete de IPython. En el ejemplo
anterior, si añades <code>plt.show()</code> después de crear el gráfico,
eso permitirá que tus colegas que no estén usando <strong>Jupyter
notebooks</strong> puedan reproducir igualmente tu trabajo en su
plataforma.</p>
</div>
</div>
</div>
<p>o creas primero los objetos <code>figure</code> y <code>axis</code>
de matplotlib y luego agregas un histograma con 30 contenedores de
datos:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()  <span class="co"># initiate an empty figure and axis matplotlib object</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>ax.hist(sample_data, <span class="dv">30</span>)</span></code></pre>
</div>
<p>Aunque el último enfoque requiere un poco más de código para crear la
misma trama, la ventaja es que nos da control total sobre el gráfico y
podemos agregarle nuevos elementos tales como etiquetas, una cuadrícula,
títulos u otros elementos visuales. Por ejemplo, podemos agregar ejes
adicionales a la figura y personalizar sus etiquetas:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>fig, ax1 <span class="op">=</span> plt.subplots() <span class="co"># preparar un gráfico con matplotlib</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>ax1.hist(sample_data, <span class="dv">30</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear el gráfico de una distribución Beta</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>beta_draws <span class="op">=</span> np.random.beta(a, b)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co"># editar las etiquetas</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>ax1.set_ylabel(<span class="st">'density'</span>)</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">'value'</span>)</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="co"># añadir ejes adicionales a la figura</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>ax2 <span class="op">=</span> fig.add_axes([<span class="fl">0.125</span>, <span class="fl">0.575</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span>])</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="co">#ax2 = fig.add_axes([left, bottom, right, top])</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>ax2.hist(beta_draws)</span></code></pre>
</div>
<figure><img src="fig/08-dualdistribution.png" alt="Gráfico con ejes adicionales" class="figure mx-auto d-block"></figure><div id="reto---dibujo-a-partir-de-distribuciones" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="reto---dibujo-a-partir-de-distribuciones" class="callout-inner">
<h3 class="callout-title">Reto - Dibujo a partir de distribuciones<a class="anchor" aria-label="anchor" href="#reto---dibujo-a-partir-de-distribuciones"></a>
</h3>
<div class="callout-content">
<p>Echa un vistazo a la documentación aleatoria deNumPy <a href="https://docs.scipy.org/doc/numpy-1.14.0/reference/routines.random.html" class="external-link">https://docs.scipy.org/doc/numpy-1.14.0/reference/routines.random.html</a>.
Toma una distribución con la que no tengas ninguna familiaridad e
intenta muestrearla y visualizarla.</p>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="enlaza-matplotlib-pandas-y-plotnine">Enlaza matplotlib, Pandas y plotnine<a class="anchor" aria-label="anchor" href="#enlaza-matplotlib-pandas-y-plotnine"></a>
</h3>
<p>Cuando creamos un gráfico usando pandas o plotnine, ambas bibliotecas
usan matplotlib para crear esas. The plots created in pandas or plotnine
are matplotlib objects, which enables us to use some of the advanced
plotting options available in the matplotlib library. Because the
objects output by pandas and plotnine can be read by matplotlib, we have
many more options than any one library can provide, offering a
consistent environment to make publication-quality visualizations.</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>fig, ax1 <span class="op">=</span> plt.subplots() <span class="co"># prepara un gráfico de matplotlib</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>surveys.plot(<span class="st">"hindfoot_length"</span>, <span class="st">"weight"</span>, kind<span class="op">=</span><span class="st">"scatter"</span>, ax<span class="op">=</span>ax1)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co"># realiza ajustes al gráfico con matplotlib:</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">"Hindfoot length"</span>)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>ax1.tick_params(labelsize<span class="op">=</span><span class="dv">16</span>, pad<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>fig.suptitle(<span class="st">'Scatter plot of weight versus hindfoot length'</span>, fontsize<span class="op">=</span><span class="dv">15</span>)</span></code></pre>
</div>
<figure><img src="fig/08_scatter_surveys_extended.png" alt="Versión extendida de diagramas de dispersión" class="figure mx-auto d-block"></figure><p>Para recuperar una figura de matplotlib de plotnine para luego
ajustarla, usa la función <code>draw()</code> en plotnine:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotnine <span class="im">as</span> p9</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>myplot <span class="op">=</span> (p9.ggplot(data<span class="op">=</span>surveys,</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>                    mapping<span class="op">=</span>p9.aes(x<span class="op">=</span><span class="st">'hindfoot_length'</span>, y<span class="op">=</span><span class="st">'weight'</span>)) <span class="op">+</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>              p9.geom_point())</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co"># convierte el output de plotnine a un objeto de matplotlib</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>my_plt_version <span class="op">=</span> myplot.draw()</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Realiza más ajustes al gráfico con matplotlib:</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>p9_ax <span class="op">=</span> my_plt_version.axes[<span class="dv">0</span>] <span class="co"># cada subgráfico es un ítem en una lista</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>p9_ax.set_xlabel(<span class="st">"Hindfoot length"</span>)</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>p9_ax.tick_params(labelsize<span class="op">=</span><span class="dv">16</span>, pad<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>p9_ax.set_title(<span class="st">'Scatter plot of weight versus hindfoot length'</span>, fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>plt.show() <span class="co"># esto no es necesario en Jupyter Notebooks</span></span></code></pre>
</div>
<figure><img src="fig/08_scatter_surveys_plotnine.png" alt="Versión extendida de diagramas de dispersión de plotnine" class="figure mx-auto d-block"></figure><blockquote>
<h2 id="reto---pandas-y-matplotlib">Reto - Pandas y matplotlib</h2>
<p>Carga el conjunto de datos de streamgage con Pandas, haz un
subconjunto filtrando la semana de la inundación de Front Range en 2013
(del 11 al 15 de septiembre) y crea un hidrograma (gráfico de líneas)
usando Pandas, vinculándolo a un objeto de maptlotlib <code>ax</code>
vacío . Crea un segundo eje que muestre el conjunto de datos entero.
Adapta el título y las etiquetas de los ejes usando matplotlib.</p>
<blockquote>
<h2 id="respuestas">Respuestas</h2>
<pre><code>discharge = pd.read_csv("data/bouldercreek_09_2013.txt",
                        skiprows=27, delimiter="\t",
                        names=["agency", "site_id", "datetime",
                               "timezone", "discharge", "discharge_cd"])
discharge["datetime"] = pd.to_datetime(discharge["datetime"])
front_range = discharge[(discharge["datetime"] &gt;= "2013-09-09") &amp;
                        (discharge["datetime"] &lt; "2013-09-15")]

fig, ax = plt.subplots()
front_range.plot(x ="datetime", y="discharge", ax=ax)
ax.set_xlabel("") # no label
ax.set_ylabel("Discharge, cubic feet per second")
ax.set_title(" Front Range flood event 2013")
discharge = pd.read_csv("../data/bouldercreek_09_2013.txt",
                      skiprows=27, delimiter="\t",
                      names=["agency", "site_id", "datetime",
                             "timezone", "flow_rate", "height"])
fig, ax = plt.subplots()
flood = discharge[(discharge["datetime"] &gt;= "2013-09-11") &amp;</code></pre>
</blockquote>
</blockquote>
<pre><code>                    (discharge["datetime"] &lt; "2013-09-15")]</code></pre>
<blockquote>
<blockquote>
<p>ax2 = fig.add_axes([0.65, 0.575, 0.25, 0.3]) flood.plot(x
=“datetime”, y=“flow_rate”, ax=ax) discharge.plot(x =“datetime”,
y=“flow_rate”, ax=ax2) ax2.legend().set_visible(False)</p>
</blockquote>
</blockquote>
<div id="challenge1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge<a class="anchor" aria-label="anchor" href="#challenge1"></a>
</h3>
<div class="callout-content">

</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<p>ax.set_xlabel(““) # no label ax.set_ylabel(”Discharge, cubic feet per
second”) ax.legend().set_visible(False) ax.set_title(” Front Range flood
event 2013”)</p>
<pre><code>{: .language-python}

![Flood event plot](../fig/08_flood_event.png)</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="guardar-figuras-de-matplotlib">Guardar figuras de matplotlib<a class="anchor" aria-label="anchor" href="#guardar-figuras-de-matplotlib"></a>
</h3>
<p>Una vez que estés satisfecho con el gráfico resultante, puedes
guardar el gráfico con el método <code>.savefig(*args)</code> de
matplotlib:</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>fig.savefig(<span class="st">"my_plot_name.png"</span>)</span></code></pre>
</div>
<p>Lo cual guardará la <code>fig</code> creada usando Pandas /
matplotlib como un archivo png con nombre <code>my_plot_name</code></p>
<div id="callout4" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Callout<a class="anchor" aria-label="anchor" href="#callout4"></a>
</h3>
<div class="callout-content">
<pre><code>    Matplotlib reconoce la extensión usada en el nombre del archivo y soporta (en la mayoría de computadoras) los formatos png, pdf, ps, eps y svg.</code></pre>
</div>
</div>
</div>
<div id="reto---guardar-figuras-a-un-archivo" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="reto---guardar-figuras-a-un-archivo" class="callout-inner">
<h3 class="callout-title">Reto - Guardar figuras a un archivo<a class="anchor" aria-label="anchor" href="#reto---guardar-figuras-a-un-archivo"></a>
</h3>
<div class="callout-content">
<p>Repasa la documentación del método <code>savefig</code> y comprueba
cómo cumplir con los requerimientos de las revistas que aceptan archivos
en <code>pdf</code> con dpi &gt;= 300.</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">
  Respuestas
  </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>fig.savefig(<span class="st">"my_plot_name.pdf"</span>, dpi<span class="op">=</span><span class="dv">300</span>)</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section id="crea-otros-tipos-de-gráficos"><h2 class="section-heading">Crea otros tipos de gráficos:<a class="anchor" aria-label="anchor" href="#crea-otros-tipos-de-gr%C3%A1ficos"></a>
</h2>
<hr class="half-width">
<p>Matplotlib permite crear muchos otros tipos de gráficos del mismo
modo como hace gráficos de líneas bidimensionales. Mira los ejemplos en
<a href="https://matplotlib.org/users/screenshots.html" class="external-link">http://matplotlib.org/users/screenshots.html</a>
e intenta realizar alguno de ellos (Haz click en el enlace “Source code”
y haz copy y paste en una nueva celda en ipython notebook o bien
guárdalo como un archivo de texto con extensión <code>.py</code> y
ejecútalo en la línea de comandos).</p>
<div id="reto---gráfico-final" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="reto---gráfico-final" class="callout-inner">
<h3 class="callout-title">Reto - Gráfico final<a class="anchor" aria-label="anchor" href="#reto---gr%C3%A1fico-final"></a>
</h3>
<div class="callout-content">
<p>Muestra tus datos usando uno o más gráficos de entre los mostrados en
la galería de ejemplos. Las que elijas dependerán del contenido de tu
propio archivo de datos. Si está usando el archivo [<a href="data/bouldercreek_09_2013.txt">bouldercreek_09_2013.txt</a>,
podrías por ejemplo, hacer un histograma de la cantidad de días con un
vertido medio determinado, usar gráficos de barras para mostrar
estadísticas de vertido diarias o explorar las diferentes formas en que
matplotlib puede manejar fechas y horas.</p>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Keypoints<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Matplotlib es el motor detrás de los gráficos creados con plotnine y
Pandas.</li>
<li>La filosofía de los gráficos de matplotlib, basada en objetos,
permite la personalización detallada de los gráficos una vez
creados.</li>
<li>Es posible exportar gráficos a un archivo usando el método
<code>savefig</code>.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-09-working-with-sql"><p>Content from <a href="09-working-with-sql.html">Acceso a base de datos SQLite usando Python y Pandas</a></p>
<hr>
<p> Last updated on 2023-02-07 | 
        
        <a href="https://github.com/datacarpentry/python-ecology-lesson-es/edit/main/episodes/09-working-with-sql.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<section id="python-y-sql"><h2 class="section-heading">Python y SQL<a class="anchor" aria-label="anchor" href="#python-y-sql"></a>
</h2>
<hr class="half-width">
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>¿Cómo conectarse a una base de datos SQLite desde Python?</li>
<li>¿Cómo extraer datos de una base de datos SQLite a un DataFrame de
Python?</li>
<li>¿Cuáles son los beneficios de usar una base de datos en vez de un
archivo CSV?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Usa el módulo sqlite3 para interactuar con una base de datos
SQL.</li>
<li>Accede a los datos almacenados en SQLite usando Python.</li>
<li>Describe las diferencias de interactuar con datos almacenados en un
archivo CSV y datos almacenados en SQLite.</li>
<li>Describe los beneficios de acceso a datos usando una base de datos
en comparación con un archivo CSV.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>Cuando lees un archivo de datos en Python y lo asignas a una
variable, estás usando la memoria de tu computadora para guardar esta
variable. Acceder a datos almacenados en una base de datos como SQL no
solo es más eficiente, sino que también te permite extraer e importar
todo o partes del <code>dataset</code> que necesites.</p>
<p>En la siguiente lección, veremos algunos enfoques que se pueden tomar
para conectarte a una base de datos, por ejemplo SQLite.</p>
<div class="section level3">
<h3 id="el-módulo-sqlite3">El módulo <code>sqlite3</code>
<a class="anchor" aria-label="anchor" href="#el-m%C3%B3dulo-sqlite3"></a>
</h3>
<p>El módulo <a href="https://docs.python.org/3/library/sqlite3.html" class="external-link">sqlite3</a>
proporciona una interfaz sencilla para interactuar con bases de datos
SQLite. Primeramente, se crea un objeto de conexión usando
<code>sqlite3.connect()</code>, esto abre la puerta a la base de datos.
Mientras la conexión esté abierta cualquier interacción con la base de
datos requiere que crees un objeto cursor, con el comando
<code>.cursor()</code>. Luego el cursor estará listo para realizar todo
tipo de operaciones con el comando <code>.execute()</code>. Al final, no
olvides cerrar la puerta de la conexión usando el comando
<code>.close()</code>.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Importa el módulo sqlite3</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sqlite3</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Crea un objeto de conexión a la base de datos SQLite</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>con <span class="op">=</span> sqlite3.<span class="ex">connect</span>(<span class="st">"data/portal_mammals.sqlite"</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Con la conexión, crea un objeto cursor</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>cur <span class="op">=</span> con.cursor()</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># El resultado de "cursor.execute" puede ser iterado por fila</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> row <span class="kw">in</span> cur.execute(<span class="st">'SELECT * FROM species;'</span>):</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(row)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co"># No te olvides de cerrar la conexión</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>con.close()</span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="consultas">Consultas<a class="anchor" aria-label="anchor" href="#consultas"></a>
</h3>
<p>Una de las formas más comunes de interactuar con una base de datos es
haciendo consultas para extraer datos: Para seleccionar columnas del
<code>DataFrame</code> o tabla, usa la palabra de declaración
<strong>SELECT</strong>. Una consulta nos devuelve o retorna datos que
pueden ser una o varias filas y columnas, a este resultado también se
llama tupla. Para filtrar las tuplas basado en algún parametro, usa la
palabra <strong>WHERE</strong>. El filtro <strong>WHERE</strong> recibe
una o más condiciones.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Importa el módulo sqlite3</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sqlite3</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Crea una conexión a la base de datos SQLite</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>con <span class="op">=</span> sqlite3.<span class="ex">connect</span>(<span class="st">"data/portal_mammals.sqlite"</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Con la conexión, crea un objeto cursor</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>cur <span class="op">=</span> con.cursor()</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Ejecuta la consulta 1</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>cur.execute(<span class="st">'SELECT plot_id FROM plots WHERE plot_type="Control"'</span>)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Extrae todos los datos</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>cur.fetchall()</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Ejecuta la consulta 2</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>cur.execute(<span class="st">'SELECT species FROM species WHERE taxa="Bird"'</span>)</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Extrae sólo el primer resultado</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>cur.fetchone()</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="co"># No te olvides de cerrar la conexión</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>con.close()</span></code></pre>
</div>
</div>
</section><section id="accesando-datos-almacenados-en-sqlite-usando-python-y-pandas"><h2 class="section-heading">Accesando datos almacenados en SQLite usando Python y Pandas<a class="anchor" aria-label="anchor" href="#accesando-datos-almacenados-en-sqlite-usando-python-y-pandas"></a>
</h2>
<hr class="half-width">
<p>Usando Pandas, podemos importar los resultados de una consulta en
SQLite a un <em>DataFrame</em>. Nota que puedes usar los mismos comandos
o sintaxis que usamos en la lección SQLite.</p>
<p>Por ejemplo para usar Pandas y SQLite:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Importa pandas y sqlite3</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sqlite3</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Crea una conexión a la base de datos SQLite</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>con <span class="op">=</span> sqlite3.<span class="ex">connect</span>(<span class="st">"data/portal_mammals.sqlite"</span>)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Usa read_sql_query de pandas para extraer el resultado</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co"># de la consulta a un DataFrame</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_sql_query(<span class="st">"SELECT * from surveys"</span>, con)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Verifica que el resultado de la consulta SQL está</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co"># almacenado en el DataFrame</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.head())</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="co"># No te olvides de cerrar la conexión</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>con.close()</span></code></pre>
</div>
</section><section id="almacenando-datos-csv-vs-sqlite"><h2 class="section-heading">Almacenando datos: CSV vs SQLite<a class="anchor" aria-label="anchor" href="#almacenando-datos-csv-vs-sqlite"></a>
</h2>
<hr class="half-width">
<p>Almacenar datos en una base de datos SQLite incrementa
sustancialmente el rendimiento de lectura / escritura, en comparación
con archivos CSV. La diferencia en el rendimiento se hace más notable a
medida que crece el tamaño del conjunto de datos (ver por ejemplo <a href="https://sebastianraschka.com/Articles/2013_sqlite_database.html#results-and-conclusions" class="external-link">estos
benchmarks</a>).</p>
<div id="desafío---sql" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="desafío---sql" class="callout-inner">
<h3 class="callout-title">Desafío - SQL<a class="anchor" aria-label="anchor" href="#desaf%C3%ADo---sql"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li><p>Crea una consulta que contenga datos de encuestas recopiladas
entre 1998 y 2001 para observaciones de sexo “masculino” o “femenino”
que incluyan el género y la especie de la observación, y el tipo de
sitio de la muestra. ¿Cuántos registros regresa la consulta?</p></li>
<li><p>Crea un DataFrame (usando <strong>count</strong>) que contenga el
número total de observaciones de todos los años y la suma de los pesos
de observaciones de cada sitio, ordenados por el ID del sitio.</p></li>
</ol>
</div>
</div>
</div>
</section><section id="almacenando-datos-crea-nuevas-tablas-usando-pandas"><h2 class="section-heading">Almacenando datos: Crea nuevas tablas usando Pandas<a class="anchor" aria-label="anchor" href="#almacenando-datos-crea-nuevas-tablas-usando-pandas"></a>
</h2>
<hr class="half-width">
<p>También podemos usar pandas para crear nuevas tablas dentro de una
base de datos SQLite. Aquí, volveremos a hacer un ejercicio que hicimos
antes con archivos CSV usando nuestra base de datos SQLite. Primero
leemos los datos de nuestra encuesta, luego seleccionamos solo los
resultados de la encuesta en el año 2002 y luego los guardamos en su
propia tabla para que podamos trabajar solo con ellos más adelante.</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Importa pandas y sqlite3</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sqlite3</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Crea una conexión a la base de datos SQLite</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>con <span class="op">=</span> sqlite3.<span class="ex">connect</span>(<span class="st">"data/portal_mammals.sqlite"</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Extrae los datos de la consulta directamente a un DataFrame</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>surveys_df <span class="op">=</span> pd.read_sql_query(<span class="st">"SELECT * from surveys"</span>, con)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Selecciona sólo datos en el año 2002</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>surveys2002 <span class="op">=</span> surveys_df[surveys_df.year <span class="op">==</span> <span class="dv">2002</span>]</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Escribe los datos del nuevo DataFrame en una nueva tabla en SQLite</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>surveys2002.to_sql(<span class="st">"surveys2002"</span>, con, if_exists<span class="op">=</span><span class="st">"replace"</span>)</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="co"># No te olvides de cerrar la conexión</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>con.close()</span></code></pre>
</div>
<div id="desafío---guardando-tus-datos" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="desafío---guardando-tus-datos" class="callout-inner">
<h3 class="callout-title">Desafío - Guardando tus datos<a class="anchor" aria-label="anchor" href="#desaf%C3%ADo---guardando-tus-datos"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li><p>Para cada uno de los desafíos del bloque anterior, modifica tu
codigo para guardar los resultados en sus propias tablas en el portal de
base de datos.</p></li>
<li><p>¿Por qué razones tú preferirías guardar los resultados de tus
consultas nuevamente en la base de datos? ¿Por qué razones preferirías
evitar hacer esto?</p></li>
</ol>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Keypoints<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Se puede crear una conexión con <code>sqlite3.connect()</code>, y
luego establecer un cursor para consultas con
<code>.cursor()</code>.</li>
<li>Es posible ejecutar consultas usando <code>.execute()</code>.</li>
<li>Puedes usar la función <code>.read_sql_query()</code> de Pandas para
extraer datos directamente de un DataFrame.</li>
<li>Se pueden escribir los datos de un DataFrame a una nueva tabla en
SQLite usando <code>.to_sql()</code>.</li>
<li>Al final, no olvides cerrar la puerta de la conexión usando el
comando <code>.close()</code>.</li>
</ul>
</div>
</div>
</div>
</section></section>
</div>
    </main>
</div>
<!-- END  : inst/pkgdown/templates/content-extra.html -->

      </div>
<!--/div.row-->
      		<footer class="row footer mx-md-3"><hr>
<div class="col-md-6">
				<p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>
        
        <a href="https://github.com/datacarpentry/python-ecology-lesson-es/edit/main/README.md" class="external-link">Edit on GitHub</a>
        
	
        | <a href="https://github.com/datacarpentry/python-ecology-lesson-es/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a> 
        | <a href="https://github.com/datacarpentry/python-ecology-lesson-es/" class="external-link">Source</a></p>
				<p><a href="https://github.com/datacarpentry/python-ecology-lesson-es/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:team@carpentries.org">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">
        
        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>
        
        <p><a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">Template licensed under CC-BY 4.0</a> by <a href="https://carpentries.org" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.14.0" class="external-link">sandpaper (0.14.0)</a>,
        <a href="https://github.com/carpentries/pegboard/tree/0.7.1" class="external-link">pegboard (0.7.1)</a>,
      and <a href="https://github.com/carpentries/varnish/tree/0.3.1" class="external-link">varnish (0.3.1)</a>.</p>
			</div>
		</footer>
</div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
			<i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back to top"></i><br><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://datacarpentry.org/python-ecology-lesson-es/aio.html",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson, The Carpentries",
  "name": "All in One View",
  "creativeWorkStatus": "active",
  "url": "https://datacarpentry.org/python-ecology-lesson-es/aio.html",
  "identifier": "https://datacarpentry.org/python-ecology-lesson-es/aio.html",
  "dateCreated": "2018-11-09",
  "dateModified": "2023-10-10",
  "datePublished": "2023-10-10"
}

  </script><script>
		feather.replace();
	</script><!-- Matomo
    2022-11-07: we have gotten a notification that we have an overage for our
    tracking and I'm pretty sure this has to do with Workbench usage.
    Considering that I am not _currently_ using this tracking because I do not
    yet know how to access the data, I am turning this off for now.
  <script>
    var _paq = window._paq = window._paq || [];
    /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
    _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
    _paq.push(["setDomains", ["*.preview.carpentries.org","*.datacarpentry.github.io","*.datacarpentry.org","*.librarycarpentry.github.io","*.librarycarpentry.org","*.swcarpentry.github.io", "*.carpentries.github.io"]]);
    _paq.push(["setDoNotTrack", true]);
    _paq.push(["disableCookies"]);
    _paq.push(['trackPageView']);
    _paq.push(['enableLinkTracking']);
    (function() {
          var u="https://carpentries.matomo.cloud/";
          _paq.push(['setTrackerUrl', u+'matomo.php']);
          _paq.push(['setSiteId', '1']);
          var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
          g.async=true; g.src='https://cdn.matomo.cloud/carpentries.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s);
        })();
  </script>
  End Matomo Code -->
</body>
</html><!-- END:   inst/pkgdown/templates/layout.html-->

